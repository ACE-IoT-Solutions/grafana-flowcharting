{"version":3,"sources":["../../../../../../src/mxgraph/javascript/dist/js/view/mxPrintPreview.js"],"names":["mxPrintPreview","graph","scale","pageFormat","border","x0","y0","borderColor","title","pageSelector","pageScale","mxRectangle","fromRectangle","prototype","marginTop","marginBottom","autoOrigin","printOverlays","printControls","printBackgroundImage","backgroundColor","wnd","targetWindow","pageCount","clipping","getWindow","getDoctype","dt","document","documentMode","appendGraph","forcePageBreaks","keepOpen","open","css","previousInitializeOverlay","cellRenderer","initializeOverlay","div","state","overlay","init","view","getDrawPane","initControl","control","handleEvents","clickHandler","dialect","isNewWindow","window","doc","length","writeln","mxClient","IS_VML","compatMode","writeHead","bounds","getGraphBounds","clone","currentScale","getView","getScale","sc","tr","getTranslate","x","y","width","height","availableWidth","availableHeight","hpages","Math","max","ceil","vpages","writePageSelector","mxUtils","bind","table","createPageSelector","body","appendChild","IS_IE","style","position","update","top","scrollTop","documentElement","mxEvent","addListener","evt","addPage","addBreak","borderStyle","borderWidth","background","pageBreakAfter","IS_EDGE","outerHTML","parentNode","removeChild","createElement","innerHTML","getElementsByTagName","addPageBreak","cov","getCoverPages","i","apx","getAppendices","dy","j","dx","pageNum","clip","renderPage","addGraphFragment","insertBackgroundImage","setAttribute","closeDocument","focus","e","hr","className","writePostfix","close","release","link","basePath","tbody","row","cell","a","IS_NS","IS_SF","IS_GC","js","write","w","h","content","pageNumber","arg","pageBreakInside","innerDiv","left","overflow","viewport","marginLeft","mxConstants","DIALECT_VML","getRoot","root","currentRoot","getModel","previousContainer","container","canvas","getCanvas","backgroundPane","getBackgroundPane","drawPane","overlayPane","getOverlayPane","DIALECT_SVG","createSvg","NO_FO","g","prev","getAttribute","createVml","createHtml","eventsEnabled","isEventsEnabled","setEventsEnabled","graphEnabled","isEnabled","setEnabled","translate","mxPoint","redraw","states","s","tempClip","force","rendering","orig","get","bbox","getBoundingBox","intersects","apply","arguments","temp","cells","mxTemporaryCellStates","getLinkForCellState","tmp","firstChild","next","nextSibling","name","nodeName","toLowerCase","cursor","svgs","destroy","getLinkForCell","bg","backgroundImage","img","round","src","insertBefore","print","__mxOutput","undefined"],"mappings":"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","file":"mxPrintPreview.js","sourcesContent":["/**\n * Copyright (c) 2006-2017, JGraph Ltd\n * Copyright (c) 2006-2017, Gaudenz Alder\n */\n/**\n * Class: mxPrintPreview\n * \n * Implements printing of a diagram across multiple pages. The following opens\n * a print preview for an existing graph:\n * \n * (code)\n * var preview = new mxPrintPreview(graph);\n * preview.open();\n * (end)\n * \n * Use <mxUtils.getScaleForPageCount> as follows in order to print the graph\n * across a given number of pages:\n * \n * (code)\n * var pageCount = mxUtils.prompt('Enter page count', '1');\n * \n * if (pageCount != null)\n * {\n *   var scale = mxUtils.getScaleForPageCount(pageCount, graph);\n *   var preview = new mxPrintPreview(graph, scale);\n *   preview.open();\n * }\n * (end)\n * \n * Additional pages:\n * \n * To add additional pages before and after the output, <getCoverPages> and\n * <getAppendices> can be used, respectively.\n * \n * (code)\n * var preview = new mxPrintPreview(graph, 1);\n * \n * preview.getCoverPages = function(w, h)\n * {\n *   return [this.renderPage(w, h, 0, 0, mxUtils.bind(this, function(div)\n *   {\n *     div.innerHTML = '<div style=\"position:relative;margin:4px;\">Cover Page</p>'\n *   }))];\n * };\n * \n * preview.getAppendices = function(w, h)\n * {\n *   return [this.renderPage(w, h, 0, 0, mxUtils.bind(this, function(div)\n *   {\n *     div.innerHTML = '<div style=\"position:relative;margin:4px;\">Appendix</p>'\n *   }))];\n * };\n * \n * preview.open();\n * (end)\n * \n * CSS:\n * \n * The CSS from the original page is not carried over to the print preview.\n * To add CSS to the page, use the css argument in the <open> function or\n * override <writeHead> to add the respective link tags as follows:\n * \n * (code)\n * var writeHead = preview.writeHead;\n * preview.writeHead = function(doc, css)\n * {\n *   writeHead.apply(this, arguments);\n *   doc.writeln('<link rel=\"stylesheet\" type=\"text/css\" href=\"style.css\">');\n * };\n * (end)\n * \n * Padding:\n * \n * To add a padding to the page in the preview (but not the print output), use\n * the following code:\n * \n * (code)\n * preview.writeHead = function(doc)\n * {\n *   writeHead.apply(this, arguments);\n *   \n *   doc.writeln('<style type=\"text/css\">');\n *   doc.writeln('@media screen {');\n *   doc.writeln('  body > div { padding-top:30px;padding-left:40px;box-sizing:content-box; }');\n *   doc.writeln('}');\n *   doc.writeln('</style>');\n * };\n * (end)\n * \n * Headers:\n * \n * Apart from setting the title argument in the mxPrintPreview constructor you\n * can override <renderPage> as follows to add a header to any page:\n * \n * (code)\n * var oldRenderPage = mxPrintPreview.prototype.renderPage;\n * mxPrintPreview.prototype.renderPage = function(w, h, x, y, content, pageNumber)\n * {\n *   var div = oldRenderPage.apply(this, arguments);\n *   \n *   var header = document.createElement('div');\n *   header.style.position = 'absolute';\n *   header.style.top = '0px';\n *   header.style.width = '100%';\n *   header.style.textAlign = 'right';\n *   mxUtils.write(header, 'Your header here');\n *   div.firstChild.appendChild(header);\n *   \n *   return div;\n * };\n * (end)\n * \n * The pageNumber argument contains the number of the current page, starting at\n * 1. To display a header on the first page only, check pageNumber and add a\n * vertical offset in the constructor call for the height of the header.\n * \n * Page Format:\n * \n * For landscape printing, use <mxConstants.PAGE_FORMAT_A4_LANDSCAPE> as\n * the pageFormat in <mxUtils.getScaleForPageCount> and <mxPrintPreview>.\n * Keep in mind that one can not set the defaults for the print dialog\n * of the operating system from JavaScript so the user must manually choose\n * a page format that matches this setting.\n * \n * You can try passing the following CSS directive to <open> to set the\n * page format in the print dialog to landscape. However, this CSS\n * directive seems to be ignored in most major browsers, including IE.\n * \n * (code)\n * @page {\n *   size: landscape;\n * }\n * (end)\n * \n * Note that the print preview behaves differently in IE when used from the\n * filesystem or via HTTP so printing should always be tested via HTTP.\n * \n * If you are using a DOCTYPE in the source page you can override <getDoctype>\n * and provide the same DOCTYPE for the print preview if required. Here is\n * an example for IE8 standards mode.\n * \n * (code)\n * var preview = new mxPrintPreview(graph);\n * preview.getDoctype = function()\n * {\n *   return '<!--[if IE]><meta http-equiv=\"X-UA-Compatible\" content=\"IE=5,IE=8\" ><![endif]-->';\n * };\n * preview.open();\n * (end)\n * \n * Constructor: mxPrintPreview\n *\n * Constructs a new print preview for the given parameters.\n * \n * Parameters:\n * \n * graph - <mxGraph> to be previewed.\n * scale - Optional scale of the output. Default is 1 / <mxGraph.pageScale>.\n * border - Border in pixels along each side of every page. Note that the\n * actual print function in the browser will add another border for\n * printing.\n * pageFormat - <mxRectangle> that specifies the page format (in pixels).\n * This should match the page format of the printer. Default uses the\n * <mxGraph.pageFormat> of the given graph.\n * x0 - Optional left offset of the output. Default is 0.\n * y0 - Optional top offset of the output. Default is 0.\n * borderColor - Optional color of the page border. Default is no border.\n * Note that a border is sometimes useful to highlight the printed page\n * border in the print preview of the browser.\n * title - Optional string that is used for the window title. Default\n * is 'Printer-friendly version'.\n * pageSelector - Optional boolean that specifies if the page selector\n * should appear in the window with the print preview. Default is true.\n */\nfunction mxPrintPreview(graph, scale, pageFormat, border, x0, y0, borderColor, title, pageSelector)\n{\n\tthis.graph = graph;\n\tthis.scale = (scale != null) ? scale : 1 / graph.pageScale;\n\tthis.border = (border != null) ? border : 0;\n\tthis.pageFormat = mxRectangle.fromRectangle((pageFormat != null) ? pageFormat : graph.pageFormat);\n\tthis.title = (title != null) ? title : 'Printer-friendly version';\n\tthis.x0 = (x0 != null) ? x0 : 0;\n\tthis.y0 = (y0 != null) ? y0 : 0;\n\tthis.borderColor = borderColor;\n\tthis.pageSelector = (pageSelector != null) ? pageSelector : true;\n};\n\n/**\n * Variable: graph\n * \n * Reference to the <mxGraph> that should be previewed.\n */\nmxPrintPreview.prototype.graph = null;\n\n/**\n * Variable: pageFormat\n *\n * Holds the <mxRectangle> that defines the page format.\n */\nmxPrintPreview.prototype.pageFormat = null;\n\n/**\n * Variable: scale\n * \n * Holds the scale of the print preview.\n */\nmxPrintPreview.prototype.scale = null;\n\n/**\n * Variable: border\n * \n * The border inset around each side of every page in the preview. This is set\n * to 0 if autoOrigin is false.\n */\nmxPrintPreview.prototype.border = 0;\n\n/**\n * Variable: marginTop\n * \n * The margin at the top of the page (number). Default is 0.\n */\nmxPrintPreview.prototype.marginTop = 0;\n\n/**\n * Variable: marginBottom\n * \n * The margin at the bottom of the page (number). Default is 0.\n */\nmxPrintPreview.prototype.marginBottom = 0;\n\n/**\n * Variable: x0\n * \n * Holds the horizontal offset of the output.\n */\nmxPrintPreview.prototype.x0 = 0;\n\n/**\n * Variable: y0\n *\n * Holds the vertical offset of the output.\n */\nmxPrintPreview.prototype.y0 = 0;\n\n/**\n * Variable: autoOrigin\n * \n * Specifies if the origin should be automatically computed based on the top,\n * left corner of the actual diagram contents. The required offset will be added\n * to <x0> and <y0> in <open>. Default is true.\n */\nmxPrintPreview.prototype.autoOrigin = true;\n\n/**\n * Variable: printOverlays\n * \n * Specifies if overlays should be printed. Default is false.\n */\nmxPrintPreview.prototype.printOverlays = false;\n\n/**\n * Variable: printControls\n * \n * Specifies if controls (such as folding icons) should be printed. Default is\n * false.\n */\nmxPrintPreview.prototype.printControls = false;\n\n/**\n * Variable: printBackgroundImage\n * \n * Specifies if the background image should be printed. Default is false.\n */\nmxPrintPreview.prototype.printBackgroundImage = false;\n\n/**\n * Variable: backgroundColor\n * \n * Holds the color value for the page background color. Default is #ffffff.\n */\nmxPrintPreview.prototype.backgroundColor = '#ffffff';\n\n/**\n * Variable: borderColor\n * \n * Holds the color value for the page border.\n */\nmxPrintPreview.prototype.borderColor = null;\n\n/**\n * Variable: title\n * \n * Holds the title of the preview window.\n */\nmxPrintPreview.prototype.title = null;\n\n/**\n * Variable: pageSelector\n * \n * Boolean that specifies if the page selector should be\n * displayed. Default is true.\n */\nmxPrintPreview.prototype.pageSelector = null;\n\n/**\n * Variable: wnd\n * \n * Reference to the preview window.\n */\nmxPrintPreview.prototype.wnd = null;\n\n/**\n * Variable: targetWindow\n * \n * Assign any window here to redirect the rendering in <open>.\n */\nmxPrintPreview.prototype.targetWindow = null;\n\n/**\n * Variable: pageCount\n * \n * Holds the actual number of pages in the preview.\n */\nmxPrintPreview.prototype.pageCount = 0;\n\n/**\n * Variable: clipping\n * \n * Specifies is clipping should be used to avoid creating too many cell states\n * in large diagrams. The bounding box of the cells in the original diagram is\n * used if this is enabled. Default is true.\n */\nmxPrintPreview.prototype.clipping = true;\n\n/**\n * Function: getWindow\n * \n * Returns <wnd>.\n */\nmxPrintPreview.prototype.getWindow = function()\n{\n\treturn this.wnd;\n};\n\n/**\n * Function: getDocType\n * \n * Returns the string that should go before the HTML tag in the print preview\n * page. This implementation returns an X-UA meta tag for IE5 in quirks mode,\n * IE8 in IE8 standards mode and edge in IE9 standards mode.\n */\nmxPrintPreview.prototype.getDoctype = function()\n{\n\tvar dt = '';\n\t\n\tif (document.documentMode == 5)\n\t{\n\t\tdt = '<meta http-equiv=\"X-UA-Compatible\" content=\"IE=5\">';\n\t}\n\telse if (document.documentMode == 8)\n\t{\n\t\tdt = '<meta http-equiv=\"X-UA-Compatible\" content=\"IE=8\">';\n\t}\n\telse if (document.documentMode > 8)\n\t{\n\t\t// Comment needed to make standards doctype apply in IE\n\t\tdt = '<!--[if IE]><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"><![endif]-->';\n\t}\n\t\n\treturn dt;\n};\n\n/**\n * Function: appendGraph\n * \n * Adds the given graph to the existing print preview.\n * \n * Parameters:\n * \n * css - Optional CSS string to be used in the head section.\n * targetWindow - Optional window that should be used for rendering. If\n * this is specified then no HEAD tag, CSS and BODY tag will be written.\n */\nmxPrintPreview.prototype.appendGraph = function(graph, scale, x0, y0, forcePageBreaks, keepOpen)\n{\n\tthis.graph = graph;\n\tthis.scale = (scale != null) ? scale : 1 / graph.pageScale;\n\tthis.x0 = x0;\n\tthis.y0 = y0;\n\tthis.open(null, null, forcePageBreaks, keepOpen);\n};\n\n/**\n * Function: open\n * \n * Shows the print preview window. The window is created here if it does\n * not exist.\n * \n * Parameters:\n * \n * css - Optional CSS string to be used in the head section.\n * targetWindow - Optional window that should be used for rendering. If\n * this is specified then no HEAD tag, CSS and BODY tag will be written.\n */\nmxPrintPreview.prototype.open = function(css, targetWindow, forcePageBreaks, keepOpen)\n{\n\t// Closing the window while the page is being rendered may cause an\n\t// exception in IE. This and any other exceptions are simply ignored.\n\tvar previousInitializeOverlay = this.graph.cellRenderer.initializeOverlay;\n\tvar div = null;\n\t\n\ttry\n\t{\n\t\t// Temporarily overrides the method to redirect rendering of overlays\n\t\t// to the draw pane so that they are visible in the printout\n\t\tif (this.printOverlays)\n\t\t{\n\t\t\tthis.graph.cellRenderer.initializeOverlay = function(state, overlay)\n\t\t\t{\n\t\t\t\toverlay.init(state.view.getDrawPane());\n\t\t\t};\n\t\t}\n\t\t\n\t\tif (this.printControls)\n\t\t{\n\t\t\tthis.graph.cellRenderer.initControl = function(state, control, handleEvents, clickHandler)\n\t\t\t{\n\t\t\t\tcontrol.dialect = state.view.graph.dialect;\n\t\t\t\tcontrol.init(state.view.getDrawPane());\n\t\t\t};\n\t\t}\n\t\t\n\t\tthis.wnd = (targetWindow != null) ? targetWindow : this.wnd;\n\t\tvar isNewWindow = false;\n\t\t\n\t\tif (this.wnd == null)\n\t\t{\n\t\t\tisNewWindow = true;\n\t\t\tthis.wnd = window.open();\n\t\t}\n\t\t\n\t\tvar doc = this.wnd.document;\n\t\t\n\t\tif (isNewWindow)\n\t\t{\n\t\t\tvar dt = this.getDoctype();\n\t\t\t\n\t\t\tif (dt != null && dt.length > 0)\n\t\t\t{\n\t\t\t\tdoc.writeln(dt);\n\t\t\t}\n\t\t\t\n\t\t\tif (mxClient.IS_VML)\n\t\t\t{\n\t\t\t\tdoc.writeln('<html xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\">');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.compatMode === 'CSS1Compat')\n\t\t\t\t{\n\t\t\t\t\tdoc.writeln('<!DOCTYPE html>');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdoc.writeln('<html>');\n\t\t\t}\n\t\t\t\n\t\t\tdoc.writeln('<head>');\n\t\t\tthis.writeHead(doc, css);\n\t\t\tdoc.writeln('</head>');\n\t\t\tdoc.writeln('<body class=\"mxPage\">');\n\t\t}\n\n\t\t// Computes the horizontal and vertical page count\n\t\tvar bounds = this.graph.getGraphBounds().clone();\n\t\tvar currentScale = this.graph.getView().getScale();\n\t\tvar sc = currentScale / this.scale;\n\t\tvar tr = this.graph.getView().getTranslate();\n\t\t\n\t\t// Uses the absolute origin with no offset for all printing\n\t\tif (!this.autoOrigin)\n\t\t{\n\t\t\tthis.x0 -= tr.x * this.scale;\n\t\t\tthis.y0 -= tr.y * this.scale;\n\t\t\tbounds.width += bounds.x;\n\t\t\tbounds.height += bounds.y;\n\t\t\tbounds.x = 0;\n\t\t\tbounds.y = 0;\n\t\t\tthis.border = 0;\n\t\t}\n\t\t\n\t\t// Store the available page area\n\t\tvar availableWidth = this.pageFormat.width - (this.border * 2);\n\t\tvar availableHeight = this.pageFormat.height - (this.border * 2);\n\t\n\t\t// Adds margins to page format\n\t\tthis.pageFormat.height += this.marginTop + this.marginBottom;\n\n\t\t// Compute the unscaled, untranslated bounds to find\n\t\t// the number of vertical and horizontal pages\n\t\tbounds.width /= sc;\n\t\tbounds.height /= sc;\n\n\t\tvar hpages = Math.max(1, Math.ceil((bounds.width + this.x0) / availableWidth));\n\t\tvar vpages = Math.max(1, Math.ceil((bounds.height + this.y0) / availableHeight));\n\t\tthis.pageCount = hpages * vpages;\n\t\t\n\t\tvar writePageSelector = mxUtils.bind(this, function()\n\t\t{\n\t\t\tif (this.pageSelector && (vpages > 1 || hpages > 1))\n\t\t\t{\n\t\t\t\tvar table = this.createPageSelector(vpages, hpages);\n\t\t\t\tdoc.body.appendChild(table);\n\t\t\t\t\n\t\t\t\t// Implements position: fixed in IE quirks mode\n\t\t\t\tif (mxClient.IS_IE && doc.documentMode == null || doc.documentMode == 5 || doc.documentMode == 8 || doc.documentMode == 7)\n\t\t\t\t{\n\t\t\t\t\ttable.style.position = 'absolute';\n\t\t\t\t\t\n\t\t\t\t\tvar update = function()\n\t\t\t\t\t{\n\t\t\t\t\t\ttable.style.top = ((doc.body.scrollTop || doc.documentElement.scrollTop) + 10) + 'px';\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\tmxEvent.addListener(this.wnd, 'scroll', function(evt)\n\t\t\t\t\t{\n\t\t\t\t\t\tupdate();\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tmxEvent.addListener(this.wnd, 'resize', function(evt)\n\t\t\t\t\t{\n\t\t\t\t\t\tupdate();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tvar addPage = mxUtils.bind(this, function(div, addBreak)\n\t\t{\n\t\t\t// Border of the DIV (aka page) inside the document\n\t\t\tif (this.borderColor != null)\n\t\t\t{\n\t\t\t\tdiv.style.borderColor = this.borderColor;\n\t\t\t\tdiv.style.borderStyle = 'solid';\n\t\t\t\tdiv.style.borderWidth = '1px';\n\t\t\t}\n\t\t\t\n\t\t\t// Needs to be assigned directly because IE doesn't support\n\t\t\t// child selectors, eg. body > div { background: white; }\n\t\t\tdiv.style.background = this.backgroundColor;\n\t\t\t\n\t\t\tif (forcePageBreaks || addBreak)\n\t\t\t{\n\t\t\t\tdiv.style.pageBreakAfter = 'always';\n\t\t\t}\n\n\t\t\t// NOTE: We are dealing with cross-window DOM here, which\n\t\t\t// is a problem in IE, so we copy the HTML markup instead.\n\t\t\t// The underlying problem is that the graph display markup\n\t\t\t// creation (in mxShape, mxGraphView) is hardwired to using\n\t\t\t// document.createElement and hence we must use this document\n\t\t\t// to create the complete page and then copy it over to the\n\t\t\t// new window.document. This can be fixed later by using the\n\t\t\t// ownerDocument of the container in mxShape and mxGraphView.\n\t\t\tif (isNewWindow && (mxClient.IS_IE || document.documentMode >= 11 || mxClient.IS_EDGE))\n\t\t\t{\n\t\t\t\t// For some obscure reason, removing the DIV from the\n\t\t\t\t// parent before fetching its outerHTML has missing\n\t\t\t\t// fillcolor properties and fill children, so the div\n\t\t\t\t// must be removed afterwards to keep the fillcolors.\n\t\t\t\tdoc.writeln(div.outerHTML);\n\t\t\t\tdiv.parentNode.removeChild(div);\n\t\t\t}\n\t\t\telse if (mxClient.IS_IE || document.documentMode >= 11 || mxClient.IS_EDGE)\n\t\t\t{\n\t\t\t\tvar clone = doc.createElement('div');\n\t\t\t\tclone.innerHTML = div.outerHTML;\n\t\t\t\tclone = clone.getElementsByTagName('div')[0];\n\t\t\t\tdoc.body.appendChild(clone);\n\t\t\t\tdiv.parentNode.removeChild(div);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdiv.parentNode.removeChild(div);\n\t\t\t\tdoc.body.appendChild(div);\n\t\t\t}\n\n\t\t\tif (forcePageBreaks || addBreak)\n\t\t\t{\n\t\t\t\tthis.addPageBreak(doc);\n\t\t\t}\n\t\t});\n\t\t\n\t\tvar cov = this.getCoverPages(this.pageFormat.width, this.pageFormat.height);\n\t\t\n\t\tif (cov != null)\n\t\t{\n\t\t\tfor (var i = 0; i < cov.length; i++)\n\t\t\t{\n\t\t\t\taddPage(cov[i], true);\n\t\t\t}\n\t\t}\n\t\t\n\t\tvar apx = this.getAppendices(this.pageFormat.width, this.pageFormat.height);\n\t\t\n\t\t// Appends each page to the page output for printing, making\n\t\t// sure there will be a page break after each page (ie. div)\n\t\tfor (var i = 0; i < vpages; i++)\n\t\t{\n\t\t\tvar dy = i * availableHeight / this.scale - this.y0 / this.scale +\n\t\t\t\t\t(bounds.y - tr.y * currentScale) / currentScale;\n\t\t\t\n\t\t\tfor (var j = 0; j < hpages; j++)\n\t\t\t{\n\t\t\t\tif (this.wnd == null)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar dx = j * availableWidth / this.scale - this.x0 / this.scale +\n\t\t\t\t\t\t(bounds.x - tr.x * currentScale) / currentScale;\n\t\t\t\tvar pageNum = i * hpages + j + 1;\n\t\t\t\tvar clip = new mxRectangle(dx, dy, availableWidth, availableHeight);\n\t\t\t\tdiv = this.renderPage(this.pageFormat.width, this.pageFormat.height, 0, 0, mxUtils.bind(this, function(div)\n\t\t\t\t{\n\t\t\t\t\tthis.addGraphFragment(-dx, -dy, this.scale, pageNum, div, clip);\n\t\t\t\t\t\n\t\t\t\t\tif (this.printBackgroundImage)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.insertBackgroundImage(div, -dx, -dy);\n\t\t\t\t\t}\n\t\t\t\t}), pageNum);\n\n\t\t\t\t// Gives the page a unique ID for later accessing the page\n\t\t\t\tdiv.setAttribute('id', 'mxPage-'+pageNum);\n\n\t\t\t\taddPage(div, apx != null || i < vpages - 1 || j < hpages - 1);\n\t\t\t}\n\t\t}\n\n\t\tif (apx != null)\n\t\t{\n\t\t\tfor (var i = 0; i < apx.length; i++)\n\t\t\t{\n\t\t\t\taddPage(apx[i], i < apx.length - 1);\n\t\t\t}\n\t\t}\n\n\t\tif (isNewWindow && !keepOpen)\n\t\t{\n\t\t\tthis.closeDocument();\n\t\t\twritePageSelector();\n\t\t}\n\t\t\n\t\tthis.wnd.focus();\n\t}\n\tcatch (e)\n\t{\n\t\t// Removes the DIV from the document in case of an error\n\t\tif (div != null && div.parentNode != null)\n\t\t{\n\t\t\tdiv.parentNode.removeChild(div);\n\t\t}\n\t}\n\tfinally\n\t{\n\t\tthis.graph.cellRenderer.initializeOverlay = previousInitializeOverlay;\n\t}\n\n\treturn this.wnd;\n};\n\n/**\n * Function: addPageBreak\n * \n * Adds a page break to the given document.\n */\nmxPrintPreview.prototype.addPageBreak = function(doc)\n{\n\tvar hr = doc.createElement('hr');\n\thr.className = 'mxPageBreak';\n\tdoc.body.appendChild(hr);\n};\n\n/**\n * Function: closeDocument\n * \n * Writes the closing tags for body and page after calling <writePostfix>.\n */\nmxPrintPreview.prototype.closeDocument = function()\n{\n\ttry\n\t{\n\t\tif (this.wnd != null && this.wnd.document != null)\n\t\t{\n\t\t\tvar doc = this.wnd.document;\n\t\t\t\n\t\t\tthis.writePostfix(doc);\n\t\t\tdoc.writeln('</body>');\n\t\t\tdoc.writeln('</html>');\n\t\t\tdoc.close();\n\t\t\t\n\t\t\t// Removes all event handlers in the print output\n\t\t\tmxEvent.release(doc.body);\n\t\t}\n\t}\n\tcatch (e)\n\t{\n\t\t// ignore any errors resulting from wnd no longer being available\n\t}\n};\n\n/**\n * Function: writeHead\n * \n * Writes the HEAD section into the given document, without the opening\n * and closing HEAD tags.\n */\nmxPrintPreview.prototype.writeHead = function(doc, css)\n{\n\tif (this.title != null)\n\t{\n\t\tdoc.writeln('<title>' + this.title + '</title>');\n\t}\n\t\n\t// Adds required namespaces\n\tif (mxClient.IS_VML)\n\t{\n\t\tdoc.writeln('<style type=\"text/css\">v\\\\:*{behavior:url(#default#VML)}o\\\\:*{behavior:url(#default#VML)}</style>');\n\t}\n\n\t// Adds all required stylesheets\n\tmxClient.link('stylesheet', mxClient.basePath + '/css/common.css', doc);\n\n\t// Removes horizontal rules and page selector from print output\n\tdoc.writeln('<style type=\"text/css\">');\n\tdoc.writeln('@media print {');\n\tdoc.writeln('  * { -webkit-print-color-adjust: exact; }');\n\tdoc.writeln('  table.mxPageSelector { display: none; }');\n\tdoc.writeln('  hr.mxPageBreak { display: none; }');\n\tdoc.writeln('}');\n\tdoc.writeln('@media screen {');\n\t\n\t// NOTE: position: fixed is not supported in IE, so the page selector\n\t// position (absolute) needs to be updated in IE (see below)\n\tdoc.writeln('  table.mxPageSelector { position: fixed; right: 10px; top: 10px;' +\n\t\t\t'font-family: Arial; font-size:10pt; border: solid 1px darkgray;' +\n\t\t\t'background: white; border-collapse:collapse; }');\n\tdoc.writeln('  table.mxPageSelector td { border: solid 1px gray; padding:4px; }');\n\tdoc.writeln('  body.mxPage { background: gray; }');\n\tdoc.writeln('}');\n\t\n\tif (css != null)\n\t{\n\t\tdoc.writeln(css);\n\t}\n\t\n\tdoc.writeln('</style>');\n};\n\n/**\n * Function: writePostfix\n * \n * Called before closing the body of the page. This implementation is empty.\n */\nmxPrintPreview.prototype.writePostfix = function(doc)\n{\n\t// empty\n};\n\n/**\n * Function: createPageSelector\n * \n * Creates the page selector table.\n */\nmxPrintPreview.prototype.createPageSelector = function(vpages, hpages)\n{\n\tvar doc = this.wnd.document;\n\tvar table = doc.createElement('table');\n\ttable.className = 'mxPageSelector';\n\ttable.setAttribute('border', '0');\n\n\tvar tbody = doc.createElement('tbody');\n\t\n\tfor (var i = 0; i < vpages; i++)\n\t{\n\t\tvar row = doc.createElement('tr');\n\t\t\n\t\tfor (var j = 0; j < hpages; j++)\n\t\t{\n\t\t\tvar pageNum = i * hpages + j + 1;\n\t\t\tvar cell = doc.createElement('td');\n\t\t\tvar a = doc.createElement('a');\n\t\t\ta.setAttribute('href', '#mxPage-' + pageNum);\n\n\t\t\t// Workaround for FF where the anchor is appended to the URL of the original document\n\t\t\tif (mxClient.IS_NS && !mxClient.IS_SF && !mxClient.IS_GC)\n\t\t\t{\n\t\t\t\tvar js = 'var page = document.getElementById(\\'mxPage-' + pageNum + '\\');page.scrollIntoView(true);event.preventDefault();';\n\t\t\t\ta.setAttribute('onclick', js);\n\t\t\t}\n\t\t\t\n\t\t\tmxUtils.write(a, pageNum, doc);\n\t\t\tcell.appendChild(a);\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\t\n\t\ttbody.appendChild(row);\n\t}\n\t\n\ttable.appendChild(tbody);\n\t\n\treturn table;\n};\n\n/**\n * Function: renderPage\n * \n * Creates a DIV that prints a single page of the given\n * graph using the given scale and returns the DIV that\n * represents the page.\n * \n * Parameters:\n * \n * w - Width of the page in pixels.\n * h - Height of the page in pixels.\n * dx - Optional horizontal page offset in pixels (used internally).\n * dy - Optional vertical page offset in pixels (used internally).\n * content - Callback that adds the HTML content to the inner div of a page.\n * Takes the inner div as the argument.\n * pageNumber - Integer representing the page number.\n */\nmxPrintPreview.prototype.renderPage = function(w, h, dx, dy, content, pageNumber)\n{\n\tvar doc = this.wnd.document;\n\tvar div = document.createElement('div');\n\tvar arg = null;\n\n\ttry\n\t{\n\t\t// Workaround for ignored clipping in IE 9 standards\n\t\t// when printing with page breaks and HTML labels.\n\t\tif (dx != 0 || dy != 0)\n\t\t{\n\t\t\tdiv.style.position = 'relative';\n\t\t\tdiv.style.width = w + 'px';\n\t\t\tdiv.style.height = h + 'px';\n\t\t\tdiv.style.pageBreakInside = 'avoid';\n\t\t\t\n\t\t\tvar innerDiv = document.createElement('div');\n\t\t\tinnerDiv.style.position = 'relative';\n\t\t\tinnerDiv.style.top = this.border + 'px';\n\t\t\tinnerDiv.style.left = this.border + 'px';\n\t\t\tinnerDiv.style.width = (w - 2 * this.border) + 'px';\n\t\t\tinnerDiv.style.height = (h - 2 * this.border) + 'px';\n\t\t\tinnerDiv.style.overflow = 'hidden';\n\t\t\t\n\t\t\tvar viewport = document.createElement('div');\n\t\t\tviewport.style.position = 'relative';\n\t\t\tviewport.style.marginLeft = dx + 'px';\n\t\t\tviewport.style.marginTop = dy + 'px';\n\n\t\t\t// FIXME: IE8 standards output problems\n\t\t\tif (doc.documentMode == 8)\n\t\t\t{\n\t\t\t\tinnerDiv.style.position = 'absolute';\n\t\t\t\tviewport.style.position = 'absolute';\n\t\t\t}\n\t\t\n\t\t\tif (doc.documentMode == 10)\n\t\t\t{\n\t\t\t\tviewport.style.width = '100%';\n\t\t\t\tviewport.style.height = '100%';\n\t\t\t}\n\t\t\t\n\t\t\tinnerDiv.appendChild(viewport);\n\t\t\tdiv.appendChild(innerDiv);\n\t\t\tdocument.body.appendChild(div);\n\t\t\targ = viewport;\n\t\t}\n\t\t// FIXME: IE10/11 too many pages\n\t\telse\n\t\t{\n\t\t\tdiv.style.width = w + 'px';\n\t\t\tdiv.style.height = h + 'px';\n\t\t\tdiv.style.overflow = 'hidden';\n\t\t\tdiv.style.pageBreakInside = 'avoid';\n\t\t\t\n\t\t\t// IE8 uses above branch currently\n\t\t\tif (doc.documentMode == 8)\n\t\t\t{\n\t\t\t\tdiv.style.position = 'relative';\n\t\t\t}\n\t\t\t\n\t\t\tvar innerDiv = document.createElement('div');\n\t\t\tinnerDiv.style.width = (w - 2 * this.border) + 'px';\n\t\t\tinnerDiv.style.height = (h - 2 * this.border) + 'px';\n\t\t\tinnerDiv.style.overflow = 'hidden';\n\n\t\t\tif (mxClient.IS_IE && (doc.documentMode == null || doc.documentMode == 5 || doc.documentMode == 8 || doc.documentMode == 7))\n\t\t\t{\n\t\t\t\tinnerDiv.style.marginTop = this.border + 'px';\n\t\t\t\tinnerDiv.style.marginLeft = this.border + 'px';\t\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tinnerDiv.style.top = this.border + 'px';\n\t\t\t\tinnerDiv.style.left = this.border + 'px';\n\t\t\t}\n\t\n\t\t\tif (this.graph.dialect == mxConstants.DIALECT_VML)\n\t\t\t{\n\t\t\t\tinnerDiv.style.position = 'absolute';\n\t\t\t}\n\n\t\t\tdiv.appendChild(innerDiv);\n\t\t\tdocument.body.appendChild(div);\n\t\t\targ = innerDiv;\n\t\t}\n\t}\n\tcatch (e)\n\t{\n\t\tdiv.parentNode.removeChild(div);\n\t\tdiv = null;\n\t\t\n\t\tthrow e;\n\t}\n\n\tcontent(arg);\n\t \n\treturn div;\n};\n\n/**\n * Function: getRoot\n * \n * Returns the root cell for painting the graph.\n */\nmxPrintPreview.prototype.getRoot = function()\n{\n\tvar root = this.graph.view.currentRoot;\n\t\n\tif (root == null)\n\t{\n\t\troot = this.graph.getModel().getRoot();\n\t}\n\t\n\treturn root;\n};\n\n/**\n * Function: addGraphFragment\n * \n * Adds a graph fragment to the given div.\n * \n * Parameters:\n * \n * dx - Horizontal translation for the diagram.\n * dy - Vertical translation for the diagram.\n * scale - Scale for the diagram.\n * pageNumber - Number of the page to be rendered.\n * div - Div that contains the output.\n * clip - Contains the clipping rectangle as an <mxRectangle>.\n */\nmxPrintPreview.prototype.addGraphFragment = function(dx, dy, scale, pageNumber, div, clip)\n{\n\tvar view = this.graph.getView();\n\tvar previousContainer = this.graph.container;\n\tthis.graph.container = div;\n\t\n\tvar canvas = view.getCanvas();\n\tvar backgroundPane = view.getBackgroundPane();\n\tvar drawPane = view.getDrawPane();\n\tvar overlayPane = view.getOverlayPane();\n\n\tif (this.graph.dialect == mxConstants.DIALECT_SVG)\n\t{\n\t\tview.createSvg();\n\t\t\n\t\t// Uses CSS transform for scaling\n\t\tif (!mxClient.NO_FO)\n\t\t{\n\t\t\tvar g = view.getDrawPane().parentNode;\n\t\t\tvar prev = g.getAttribute('transform');\n\t\t\tg.setAttribute('transformOrigin', '0 0');\n\t\t\tg.setAttribute('transform', 'scale(' + scale + ',' + scale + ')' +\n\t\t\t\t'translate(' + dx + ',' + dy + ')');\n\t\t\t\n\t\t\tscale = 1;\n\t\t\tdx = 0;\n\t\t\tdy = 0;\n\t\t}\n\t}\n\telse if (this.graph.dialect == mxConstants.DIALECT_VML)\n\t{\n\t\tview.createVml();\n\t}\n\telse\n\t{\n\t\tview.createHtml();\n\t}\n\t\n\t// Disables events on the view\n\tvar eventsEnabled = view.isEventsEnabled();\n\tview.setEventsEnabled(false);\n\t\n\t// Disables the graph to avoid cursors\n\tvar graphEnabled = this.graph.isEnabled();\n\tthis.graph.setEnabled(false);\n\n\t// Resets the translation\n\tvar translate = view.getTranslate();\n\tview.translate = new mxPoint(dx, dy);\n\t\n\t// Redraws only states that intersect the clip\n\tvar redraw = this.graph.cellRenderer.redraw;\n\tvar states = view.states;\n\tvar s = view.scale;\n\n\t// Gets the transformed clip for intersection check below\n\tif (this.clipping)\n\t{\n\t\tvar tempClip = new mxRectangle((clip.x + translate.x) * s, (clip.y + translate.y) * s,\n\t\t\t\tclip.width * s / scale, clip.height * s / scale);\n\t\t\n\t\t// Checks clipping rectangle for speedup\n\t\t// Must create terminal states for edge clipping even if terminal outside of clip\n\t\tthis.graph.cellRenderer.redraw = function(state, force, rendering)\n\t\t{\n\t\t\tif (state != null)\n\t\t\t{\n\t\t\t\t// Gets original state from graph to find bounding box\n\t\t\t\tvar orig = states.get(state.cell);\n\t\t\t\t\n\t\t\t\tif (orig != null)\n\t\t\t\t{\n\t\t\t\t\tvar bbox = view.getBoundingBox(orig, false);\n\t\t\t\t\t\n\t\t\t\t\t// Stops rendering if outside clip for speedup\n\t\t\t\t\tif (bbox != null && !mxUtils.intersects(tempClip, bbox))\n\t\t\t\t\t{\n\t\t\t\t\t\t//return;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tredraw.apply(this, arguments);\n\t\t};\n\t}\n\t\n\tvar temp = null;\n\t\n\ttry\n\t{\n\t\t// Creates the temporary cell states in the view and\n\t\t// draws them onto the temporary DOM nodes in the view\n\t\tvar cells = [this.getRoot()];\n\t\ttemp = new mxTemporaryCellStates(view, scale, cells, null, mxUtils.bind(this, function(state)\n\t\t{\n\t\t\treturn this.getLinkForCellState(state);\n\t\t}));\n\t}\n\tfinally\n\t{\n\t\t// Removes overlay pane with selection handles\n\t\t// controls and icons from the print output\n\t\tif (mxClient.IS_IE)\n\t\t{\n\t\t\tview.overlayPane.innerHTML = '';\n\t\t\tview.canvas.style.overflow = 'hidden';\n\t\t\tview.canvas.style.position = 'relative';\n\t\t\tview.canvas.style.top = this.marginTop + 'px';\n\t\t\tview.canvas.style.width = clip.width + 'px';\n\t\t\tview.canvas.style.height = clip.height + 'px';\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// Removes everything but the SVG node\n\t\t\tvar tmp = div.firstChild;\n\n\t\t\twhile (tmp != null)\n\t\t\t{\n\t\t\t\tvar next = tmp.nextSibling;\n\t\t\t\tvar name = tmp.nodeName.toLowerCase();\n\n\t\t\t\t// Note: Width and height are required in FF 11\n\t\t\t\tif (name == 'svg')\n\t\t\t\t{\n\t\t\t\t\ttmp.style.overflow = 'hidden';\n\t\t\t\t\ttmp.style.position = 'relative';\n\t\t\t\t\ttmp.style.top = this.marginTop + 'px';\n\t\t\t\t\ttmp.setAttribute('width', clip.width);\n\t\t\t\t\ttmp.setAttribute('height', clip.height);\n\t\t\t\t\ttmp.style.width = '';\n\t\t\t\t\ttmp.style.height = '';\n\t\t\t\t}\n\t\t\t\t// Tries to fetch all text labels and only text labels\n\t\t\t\telse if (tmp.style.cursor != 'default' && name != 'div')\n\t\t\t\t{\n\t\t\t\t\ttmp.parentNode.removeChild(tmp);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ttmp = next;\n\t\t\t}\n\t\t}\n\t\t\n\t\t// Puts background image behind SVG output\n\t\tif (this.printBackgroundImage)\n\t\t{\n\t\t\tvar svgs = div.getElementsByTagName('svg');\n\t\t\t\n\t\t\tif (svgs.length > 0)\n\t\t\t{\n\t\t\t\tsvgs[0].style.position = 'absolute';\n\t\t\t}\n\t\t}\n\t\t\n\t\t// Completely removes the overlay pane to remove more handles\n\t\tview.overlayPane.parentNode.removeChild(view.overlayPane);\n\n\t\t// Restores the state of the view\n\t\tthis.graph.setEnabled(graphEnabled);\n\t\tthis.graph.container = previousContainer;\n\t\tthis.graph.cellRenderer.redraw = redraw;\n\t\tview.canvas = canvas;\n\t\tview.backgroundPane = backgroundPane;\n\t\tview.drawPane = drawPane;\n\t\tview.overlayPane = overlayPane;\n\t\tview.translate = translate;\n\t\ttemp.destroy();\n\t\tview.setEventsEnabled(eventsEnabled);\n\t}\n};\n\n/**\n * Function: getLinkForCellState\n * \n * Returns the link for the given cell state. This returns null.\n */\nmxPrintPreview.prototype.getLinkForCellState = function(state)\n{\n\treturn this.graph.getLinkForCell(state.cell);\n};\n\n/**\n * Function: insertBackgroundImage\n * \n * Inserts the background image into the given div.\n */\nmxPrintPreview.prototype.insertBackgroundImage = function(div, dx, dy)\n{\n\tvar bg = this.graph.backgroundImage;\n\t\n\tif (bg != null)\n\t{\n\t\tvar img = document.createElement('img');\n\t\timg.style.position = 'absolute';\n\t\timg.style.marginLeft = Math.round(dx * this.scale) + 'px';\n\t\timg.style.marginTop = Math.round(dy * this.scale) + 'px';\n\t\timg.setAttribute('width', Math.round(this.scale * bg.width));\n\t\timg.setAttribute('height', Math.round(this.scale * bg.height));\n\t\timg.src = bg.src;\n\t\t\n\t\tdiv.insertBefore(img, div.firstChild);\n\t}\n};\n\n/**\n * Function: getCoverPages\n * \n * Returns the pages to be added before the print output. This returns null.\n */\nmxPrintPreview.prototype.getCoverPages = function()\n{\n\treturn null;\n};\n\n/**\n * Function: getAppendices\n * \n * Returns the pages to be added after the print output. This returns null.\n */\nmxPrintPreview.prototype.getAppendices = function()\n{\n\treturn null;\n};\n\n/**\n * Function: print\n * \n * Opens the print preview and shows the print dialog.\n * \n * Parameters:\n * \n * css - Optional CSS string to be used in the head section.\n */\nmxPrintPreview.prototype.print = function(css)\n{\n\tvar wnd = this.open(css);\n\t\n\tif (wnd != null)\n\t{\n\t\twnd.print();\n\t}\n};\n\n/**\n * Function: close\n * \n * Closes the print preview window.\n */\nmxPrintPreview.prototype.close = function()\n{\n\tif (this.wnd != null)\n\t{\n\t\tthis.wnd.close();\n\t\tthis.wnd = null;\n\t}\n};\n\n__mxOutput.mxPrintPreview = typeof mxPrintPreview !== 'undefined' ? mxPrintPreview : undefined;\n"]}