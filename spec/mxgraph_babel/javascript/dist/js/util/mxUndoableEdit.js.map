{"version":3,"sources":["../../../../../../src/mxgraph/javascript/dist/js/util/mxUndoableEdit.js"],"names":["mxUndoableEdit","source","significant","changes","prototype","undone","redone","isEmpty","length","isSignificant","add","change","push","notify","die","undo","fireEvent","mxEventObject","mxEvent","START_EDIT","count","i","execute","EXECUTED","END_EDIT","redo","__mxOutput","undefined"],"mappings":"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","file":"mxUndoableEdit.js","sourcesContent":["/**\n * Copyright (c) 2006-2015, JGraph Ltd\n * Copyright (c) 2006-2015, Gaudenz Alder\n */\n/**\n * Class: mxUndoableEdit\n * \n * Implements a composite undoable edit. Here is an example for a custom change\n * which gets executed via the model:\n * \n * (code)\n * function CustomChange(model, name)\n * {\n *   this.model = model;\n *   this.name = name;\n *   this.previous = name;\n * };\n * \n * CustomChange.prototype.execute = function()\n * {\n *   var tmp = this.model.name;\n *   this.model.name = this.previous;\n *   this.previous = tmp;\n * };\n * \n * var name = prompt('Enter name');\n * graph.model.execute(new CustomChange(graph.model, name));\n * (end)\n * \n * Event: mxEvent.EXECUTED\n * \n * Fires between START_EDIT and END_EDIT after an atomic change was executed.\n * The <code>change</code> property contains the change that was executed.\n * \n * Event: mxEvent.START_EDIT\n * \n * Fires before a set of changes will be executed in <undo> or <redo>.\n * This event contains no properties.\n * \n * Event: mxEvent.END_EDIT\n *\n * Fires after a set of changeswas executed in <undo> or <redo>.\n * This event contains no properties.\n * \n * Constructor: mxUndoableEdit\n * \n * Constructs a new undoable edit for the given source.\n */\nfunction mxUndoableEdit(source, significant)\n{\n\tthis.source = source;\n\tthis.changes = [];\n\tthis.significant = (significant != null) ? significant : true;\n};\n\n/**\n * Variable: source\n * \n * Specifies the source of the edit.\n */\nmxUndoableEdit.prototype.source = null;\n\n/**\n * Variable: changes\n * \n * Array that contains the changes that make up this edit. The changes are\n * expected to either have an undo and redo function, or an execute\n * function. Default is an empty array.\n */\nmxUndoableEdit.prototype.changes = null;\n\n/**\n * Variable: significant\n * \n * Specifies if the undoable change is significant.\n * Default is true.\n */\nmxUndoableEdit.prototype.significant = null;\n\n/**\n * Variable: undone\n * \n * Specifies if this edit has been undone. Default is false.\n */\nmxUndoableEdit.prototype.undone = false;\n\n/**\n * Variable: redone\n * \n * Specifies if this edit has been redone. Default is false.\n */\nmxUndoableEdit.prototype.redone = false;\n\n/**\n * Function: isEmpty\n * \n * Returns true if the this edit contains no changes.\n */\nmxUndoableEdit.prototype.isEmpty = function()\n{\n\treturn this.changes.length == 0;\n};\n\n/**\n * Function: isSignificant\n * \n * Returns <significant>.\n */\nmxUndoableEdit.prototype.isSignificant = function()\n{\n\treturn this.significant;\n};\n\n/**\n * Function: add\n * \n * Adds the specified change to this edit. The change is an object that is\n * expected to either have an undo and redo, or an execute function.\n */\nmxUndoableEdit.prototype.add = function(change)\n{\n\tthis.changes.push(change);\n};\n\n/**\n * Function: notify\n * \n * Hook to notify any listeners of the changes after an <undo> or <redo>\n * has been carried out. This implementation is empty.\n */\nmxUndoableEdit.prototype.notify = function() { };\n\n/**\n * Function: die\n * \n * Hook to free resources after the edit has been removed from the command\n * history. This implementation is empty.\n */\nmxUndoableEdit.prototype.die = function() { };\n\n/**\n * Function: undo\n * \n * Undoes all changes in this edit.\n */\nmxUndoableEdit.prototype.undo = function()\n{\n\tif (!this.undone)\n\t{\n\t\tthis.source.fireEvent(new mxEventObject(mxEvent.START_EDIT));\n\t\tvar count = this.changes.length;\n\t\t\n\t\tfor (var i = count - 1; i >= 0; i--)\n\t\t{\n\t\t\tvar change = this.changes[i];\n\t\t\t\n\t\t\tif (change.execute != null)\n\t\t\t{\n\t\t\t\tchange.execute();\n\t\t\t}\n\t\t\telse if (change.undo != null)\n\t\t\t{\n\t\t\t\tchange.undo();\n\t\t\t}\n\t\t\t\n\t\t\t// New global executed event\n\t\t\tthis.source.fireEvent(new mxEventObject(mxEvent.EXECUTED, 'change', change));\n\t\t}\n\t\t\n\t\tthis.undone = true;\n\t\tthis.redone = false;\n\t\tthis.source.fireEvent(new mxEventObject(mxEvent.END_EDIT));\n\t}\n\t\n\tthis.notify();\n};\n\n/**\n * Function: redo\n * \n * Redoes all changes in this edit.\n */\nmxUndoableEdit.prototype.redo = function()\n{\n\tif (!this.redone)\n\t{\n\t\tthis.source.fireEvent(new mxEventObject(mxEvent.START_EDIT));\n\t\tvar count = this.changes.length;\n\t\t\n\t\tfor (var i = 0; i < count; i++)\n\t\t{\n\t\t\tvar change = this.changes[i];\n\t\t\t\n\t\t\tif (change.execute != null)\n\t\t\t{\n\t\t\t\tchange.execute();\n\t\t\t}\n\t\t\telse if (change.redo != null)\n\t\t\t{\n\t\t\t\tchange.redo();\n\t\t\t}\n\t\t\t\n\t\t\t// New global executed event\n\t\t\tthis.source.fireEvent(new mxEventObject(mxEvent.EXECUTED, 'change', change));\n\t\t}\n\t\t\n\t\tthis.undone = false;\n\t\tthis.redone = true;\n\t\tthis.source.fireEvent(new mxEventObject(mxEvent.END_EDIT));\n\t}\n\t\n\tthis.notify();\n};\n\n__mxOutput.mxUndoableEdit = typeof mxUndoableEdit !== 'undefined' ? mxUndoableEdit : undefined;\n"]}