{"version":3,"sources":["../../../../../../src/mxgraph/javascript/dist/js/util/mxVmlCanvas2D.js"],"names":["mxVmlCanvas2D","root","mxAbstractCanvas2D","call","mxUtils","extend","prototype","node","textEnabled","moveOp","lineOp","curveOp","closeOp","rotatedHtmlBackground","vmlScale","createElement","name","document","createVmlElement","mxClient","VML_PREFIX","addNode","filled","stroked","s","state","nodeName","path","length","join","style","width","height","coordsize","parseInt","strokeweight","format","Math","max","strokeWidth","scale","shadow","appendChild","createShadow","fillColor","strokeColor","strokecolor","createStroke","createFill","pointerEvents","createTransparentFill","fill","src","imageBasePath","type","color","gradientColor","method","color2","angle","rotation","gradientDirection","mxConstants","DIRECTION_WEST","flip","DIRECTION_EAST","DIRECTION_NORTH","mod","opacity","alpha","gradientFillAlpha","setAttribute","OFFICE_PREFIX","gradientAlpha","fillAlpha","stroke","endcap","lineCap","joinstyle","lineJoin","miterlimit","miterLimit","strokeAlpha","dashed","dashstyle","getVmlDashStyle","result","dashPattern","tok","split","rad","PI","cos","sin","dx","shadowDx","dy","shadowDy","cloneNode","marginLeft","round","marginTop","documentMode","shadowColor","createShadowStroke","createShadowFill","shadowAlpha","rotate","theta","flipH","flipV","cx","cy","rotationCx","rotationCy","begin","apply","arguments","position","quadTo","x1","y1","x2","y2","cpx0","lastX","cpy0","lastY","qpx1","qpy1","cpx3","cpy3","cpx1","cpy1","cpx2","cpy2","push","createRect","x","y","w","h","n","left","top","rect","roundrect","ellipse","image","aspect","filter","createDiv","str","align","valign","overflow","div","css","fontBackgroundColor","fontBorderColor","isNode","div2","cssText","display","IS_QUIRKS","zoom","textDecoration","innerHTML","fontSize","fontFamily","fontColor","verticalAlign","textAlign","lineHeight","ABSOLUTE_LINE_HEIGHT","LINE_HEIGHT","fontStyle","FONT_BOLD","fontWeight","FONT_ITALIC","FONT_UNDERLINE","text","wrap","clip","dir","pt","rotatePoint","IS_EM","ALIGN_TOP","abs","box","margin","getAlignmentAsPoint","inner","wordWrap","WORD_WRAP","whiteSpace","tmp","firstChild","rot","rotateHtml","maxHeight","real_cos","parseFloat","toFixed","real_sin","visibility","body","sizeDiv","offsetWidth","oh","offsetHeight","min","top_fix","left_fix","pos","parentNode","sc","backgroundColor","divParent","plainText","htmlEntities","textpathok","v","tp","string","on","size","lines","textHeight","ALIGN_BOTTOM","ALIGN_MIDDLE","fillAndStroke","__mxOutput","undefined"],"mappings":"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","file":"mxVmlCanvas2D.js","sourcesContent":["/**\n * Copyright (c) 2006-2015, JGraph Ltd\n * Copyright (c) 2006-2015, Gaudenz Alder\n */\n/**\n *\n * Class: mxVmlCanvas2D\n * \n * Implements a canvas to be used for rendering VML. Here is an example of implementing a\n * fallback for SVG images which are not supported in VML-based browsers.\n * \n * (code)\n * var mxVmlCanvas2DImage = mxVmlCanvas2D.prototype.image;\n * mxVmlCanvas2D.prototype.image = function(x, y, w, h, src, aspect, flipH, flipV)\n * {\n *   if (src.substring(src.length - 4, src.length) == '.svg')\n *   {\n *     src = 'http://www.jgraph.com/images/mxgraph.gif';\n *   }\n *   \n *   mxVmlCanvas2DImage.apply(this, arguments);\n * };\n * (end)\n * \n * To disable anti-aliasing in the output, use the following code.\n * \n * (code)\n * document.createStyleSheet().cssText = mxClient.VML_PREFIX + '\\\\:*{antialias:false;)}';\n * (end)\n * \n * A description of the public API is available in <mxXmlCanvas2D>. Note that\n * there is a known issue in VML where gradients are painted using the outer\n * bounding box of rotated shapes, not the actual bounds of the shape. See\n * also <text> for plain text label restrictions in shapes for VML.\n */\nvar mxVmlCanvas2D = function(root)\n{\n\tmxAbstractCanvas2D.call(this);\n\n\t/**\n\t * Variable: root\n\t * \n\t * Reference to the container for the SVG content.\n\t */\n\tthis.root = root;\n};\n\n/**\n * Extends mxAbstractCanvas2D\n */\nmxUtils.extend(mxVmlCanvas2D, mxAbstractCanvas2D);\n\n/**\n * Variable: path\n * \n * Holds the current DOM node.\n */\nmxVmlCanvas2D.prototype.node = null;\n\n/**\n * Variable: textEnabled\n * \n * Specifies if text output should be enabledetB. Default is true.\n */\nmxVmlCanvas2D.prototype.textEnabled = true;\n\n/**\n * Variable: moveOp\n * \n * Contains the string used for moving in paths. Default is 'm'.\n */\nmxVmlCanvas2D.prototype.moveOp = 'm';\n\n/**\n * Variable: lineOp\n * \n * Contains the string used for moving in paths. Default is 'l'.\n */\nmxVmlCanvas2D.prototype.lineOp = 'l';\n\n/**\n * Variable: curveOp\n * \n * Contains the string used for bezier curves. Default is 'c'.\n */\nmxVmlCanvas2D.prototype.curveOp = 'c';\n\n/**\n * Variable: closeOp\n * \n * Holds the operator for closing curves. Default is 'x e'.\n */\nmxVmlCanvas2D.prototype.closeOp = 'x';\n\n/**\n * Variable: rotatedHtmlBackground\n * \n * Background color for rotated HTML. Default is ''. This can be set to eg.\n * white to improve rendering of rotated text in VML for IE9.\n */\nmxVmlCanvas2D.prototype.rotatedHtmlBackground = '';\n\n/**\n * Variable: vmlScale\n * \n * Specifies the scale used to draw VML shapes.\n */\nmxVmlCanvas2D.prototype.vmlScale = 1;\n\n/**\n * Function: createElement\n * \n * Creates the given element using the document.\n */\nmxVmlCanvas2D.prototype.createElement = function(name)\n{\n\treturn document.createElement(name);\n};\n\n/**\n * Function: createVmlElement\n * \n * Creates a new element using <createElement> and prefixes the given name with\n * <mxClient.VML_PREFIX>.\n */\nmxVmlCanvas2D.prototype.createVmlElement = function(name)\n{\n\treturn this.createElement(mxClient.VML_PREFIX + ':' + name);\n};\n\n/**\n * Function: addNode\n * \n * Adds the current node to the <root>.\n */\nmxVmlCanvas2D.prototype.addNode = function(filled, stroked)\n{\n\tvar node = this.node;\n\tvar s = this.state;\n\t\n\tif (node != null)\n\t{\n\t\tif (node.nodeName == 'shape')\n\t\t{\n\t\t\t// Checks if the path is not empty\n\t\t\tif (this.path != null && this.path.length > 0)\n\t\t\t{\n\t\t\t\tnode.path = this.path.join(' ') + ' e';\n\t\t\t\tnode.style.width = this.root.style.width;\n\t\t\t\tnode.style.height = this.root.style.height;\n\t\t\t\tnode.coordsize = parseInt(node.style.width) + ' ' + parseInt(node.style.height);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tnode.strokeweight = this.format(Math.max(1, s.strokeWidth * s.scale / this.vmlScale)) + 'px';\n\t\t\n\t\tif (s.shadow)\n\t\t{\n\t\t\tthis.root.appendChild(this.createShadow(node,\n\t\t\t\tfilled && s.fillColor != null,\n\t\t\t\tstroked && s.strokeColor != null));\n\t\t}\n\t\t\n\t\tif (stroked && s.strokeColor != null)\n\t\t{\n\t\t\tnode.stroked = 'true';\n\t\t\tnode.strokecolor = s.strokeColor;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.stroked = 'false';\n\t\t}\n\n\t\tnode.appendChild(this.createStroke());\n\n\t\tif (filled && s.fillColor != null)\n\t\t{\n\t\t\tnode.appendChild(this.createFill());\n\t\t}\n\t\telse if (this.pointerEvents && (node.nodeName != 'shape' ||\n\t\t\tthis.path[this.path.length - 1] == this.closeOp))\n\t\t{\n\t\t\tnode.appendChild(this.createTransparentFill());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.filled = 'false';\n\t\t}\n\n\t\t// LATER: Update existing DOM for performance\n\t\tthis.root.appendChild(node);\n\t}\n};\n\n/**\n * Function: createTransparentFill\n * \n * Creates a transparent fill.\n */\nmxVmlCanvas2D.prototype.createTransparentFill = function()\n{\n\tvar fill = this.createVmlElement('fill');\n\tfill.src = mxClient.imageBasePath + '/transparent.gif';\n\tfill.type = 'tile';\n\t\n\treturn fill;\n};\n\n/**\n * Function: createFill\n * \n * Creates a fill for the current state.\n */\nmxVmlCanvas2D.prototype.createFill = function()\n{\n\tvar s = this.state;\n\t\n\t// Gradients in foregrounds not supported because special gradients\n\t// with bounds must be created for each element in graphics-canvases\n\tvar fill = this.createVmlElement('fill');\n\tfill.color = s.fillColor;\n\n\tif (s.gradientColor != null)\n\t{\n\t\tfill.type = 'gradient';\n\t\tfill.method = 'none';\n\t\tfill.color2 = s.gradientColor;\n\t\tvar angle = 180 - s.rotation;\n\t\t\n\t\tif (s.gradientDirection == mxConstants.DIRECTION_WEST)\n\t\t{\n\t\t\tangle -= 90 + ((this.root.style.flip == 'x') ? 180 : 0);\n\t\t}\n\t\telse if (s.gradientDirection == mxConstants.DIRECTION_EAST)\n\t\t{\n\t\t\tangle += 90 + ((this.root.style.flip == 'x') ? 180 : 0);\n\t\t}\n\t\telse if (s.gradientDirection == mxConstants.DIRECTION_NORTH)\n\t\t{\n\t\t\tangle -= 180 + ((this.root.style.flip == 'y') ? -180 : 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\t angle += ((this.root.style.flip == 'y') ? -180 : 0);\n\t\t}\n\t\t\n\t\tif (this.root.style.flip == 'x' || this.root.style.flip == 'y')\n\t\t{\n\t\t\tangle *= -1;\n\t\t}\n\n\t\t// LATER: Fix outer bounding box for rotated shapes used in VML.\n\t\tfill.angle = mxUtils.mod(angle, 360);\n\t\tfill.opacity = (s.alpha * s.gradientFillAlpha * 100) + '%';\n\t\tfill.setAttribute(mxClient.OFFICE_PREFIX + ':opacity2', (s.alpha * s.gradientAlpha * 100) + '%');\n\t}\n\telse if (s.alpha < 1 || s.fillAlpha < 1)\n\t{\n\t\tfill.opacity = (s.alpha * s.fillAlpha * 100) + '%';\t\t\t\n\t}\n\t\n\treturn fill;\n};\n/**\n * Function: createStroke\n * \n * Creates a fill for the current state.\n */\nmxVmlCanvas2D.prototype.createStroke = function()\n{\n\tvar s = this.state;\n\tvar stroke = this.createVmlElement('stroke');\n\tstroke.endcap = s.lineCap || 'flat';\n\tstroke.joinstyle = s.lineJoin || 'miter';\n\tstroke.miterlimit = s.miterLimit || '10';\n\t\n\tif (s.alpha < 1 || s.strokeAlpha < 1)\n\t{\n\t\tstroke.opacity = (s.alpha * s.strokeAlpha * 100) + '%';\n\t}\n\t\n\tif (s.dashed)\n\t{\n\t\tstroke.dashstyle = this.getVmlDashStyle();\n\t}\n\t\n\treturn stroke;\n};\n\n/**\n * Function: getVmlDashPattern\n * \n * Returns a VML dash pattern for the current dashPattern.\n * See http://msdn.microsoft.com/en-us/library/bb264085(v=vs.85).aspx\n */\nmxVmlCanvas2D.prototype.getVmlDashStyle = function()\n{\n\tvar result = 'dash';\n\t\n\tif (typeof(this.state.dashPattern) === 'string')\n\t{\n\t\tvar tok = this.state.dashPattern.split(' ');\n\t\t\n\t\tif (tok.length > 0 && tok[0] == 1)\n\t\t{\n\t\t\tresult = '0 2';\n\t\t}\n\t}\n\t\n\treturn result;\n};\n\n/**\n * Function: createShadow\n * \n * Creates a shadow for the given node.\n */\nmxVmlCanvas2D.prototype.createShadow = function(node, filled, stroked)\n{\n\tvar s = this.state;\n\tvar rad = -s.rotation * (Math.PI / 180);\n\tvar cos = Math.cos(rad);\n\tvar sin = Math.sin(rad);\n\n\tvar dx = s.shadowDx * s.scale;\n\tvar dy = s.shadowDy * s.scale;\n\n\tif (this.root.style.flip == 'x')\n\t{\n\t\tdx *= -1;\n\t}\n\telse if (this.root.style.flip == 'y')\n\t{\n\t\tdy *= -1;\n\t}\n\t\n\tvar shadow = node.cloneNode(true);\n\tshadow.style.marginLeft = Math.round(dx * cos - dy * sin) + 'px';\n\tshadow.style.marginTop = Math.round(dx * sin + dy * cos) + 'px';\n\n\t// Workaround for wrong cloning in IE8 standards mode\n\tif (document.documentMode == 8)\n\t{\n\t\tshadow.strokeweight = node.strokeweight;\n\t\t\n\t\tif (node.nodeName == 'shape')\n\t\t{\n\t\t\tshadow.path = this.path.join(' ') + ' e';\n\t\t\tshadow.style.width = this.root.style.width;\n\t\t\tshadow.style.height = this.root.style.height;\n\t\t\tshadow.coordsize = parseInt(node.style.width) + ' ' + parseInt(node.style.height);\n\t\t}\n\t}\n\t\n\tif (stroked)\n\t{\n\t\tshadow.strokecolor = s.shadowColor;\n\t\tshadow.appendChild(this.createShadowStroke());\n\t}\n\telse\n\t{\n\t\tshadow.stroked = 'false';\n\t}\n\t\n\tif (filled)\n\t{\n\t\tshadow.appendChild(this.createShadowFill());\n\t}\n\telse\n\t{\n\t\tshadow.filled = 'false';\n\t}\n\t\n\treturn shadow;\n};\n\n/**\n * Function: createShadowFill\n * \n * Creates the fill for the shadow.\n */\nmxVmlCanvas2D.prototype.createShadowFill = function()\n{\n\tvar fill = this.createVmlElement('fill');\n\tfill.color = this.state.shadowColor;\n\tfill.opacity = (this.state.alpha * this.state.shadowAlpha * 100) + '%';\n\t\n\treturn fill;\n};\n\n/**\n * Function: createShadowStroke\n * \n * Creates the stroke for the shadow.\n */\nmxVmlCanvas2D.prototype.createShadowStroke = function()\n{\n\tvar stroke = this.createStroke();\n\tstroke.opacity = (this.state.alpha * this.state.shadowAlpha * 100) + '%';\n\t\n\treturn stroke;\n};\n\n/**\n * Function: rotate\n * \n * Sets the rotation of the canvas. Note that rotation cannot be concatenated.\n */\nmxVmlCanvas2D.prototype.rotate = function(theta, flipH, flipV, cx, cy)\n{\n\tif (flipH && flipV)\n\t{\n\t\ttheta += 180;\n\t}\n\telse if (flipH)\n\t{\n\t\tthis.root.style.flip = 'x';\n\t}\n\telse if (flipV)\n\t{\n\t\tthis.root.style.flip = 'y';\n\t}\n\n\tif (flipH ? !flipV : flipV)\n\t{\n\t\ttheta *= -1;\n\t}\n\n\tthis.root.style.rotation = theta;\n\tthis.state.rotation = this.state.rotation + theta;\n\tthis.state.rotationCx = cx;\n\tthis.state.rotationCy = cy;\n};\n\n/**\n * Function: begin\n * \n * Extends superclass to create path.\n */\nmxVmlCanvas2D.prototype.begin = function()\n{\n\tmxAbstractCanvas2D.prototype.begin.apply(this, arguments);\n\tthis.node = this.createVmlElement('shape');\n\tthis.node.style.position = 'absolute';\n};\n\n/**\n * Function: quadTo\n * \n * Replaces quadratic curve with bezier curve in VML.\n */\nmxVmlCanvas2D.prototype.quadTo = function(x1, y1, x2, y2)\n{\n\tvar s = this.state;\n\n\tvar cpx0 = (this.lastX + s.dx) * s.scale;\n\tvar cpy0 = (this.lastY + s.dy) * s.scale;\n\tvar qpx1 = (x1 + s.dx) * s.scale;\n\tvar qpy1 = (y1 + s.dy) * s.scale;\n\tvar cpx3 = (x2 + s.dx) * s.scale;\n\tvar cpy3 = (y2 + s.dy) * s.scale;\n\t\n\tvar cpx1 = cpx0 + 2/3 * (qpx1 - cpx0);\n\tvar cpy1 = cpy0 + 2/3 * (qpy1 - cpy0);\n\t\n\tvar cpx2 = cpx3 + 2/3 * (qpx1 - cpx3);\n\tvar cpy2 = cpy3 + 2/3 * (qpy1 - cpy3);\n\t\n\tthis.path.push('c ' + this.format(cpx1) + ' ' + this.format(cpy1) +\n\t\t\t' ' + this.format(cpx2) + ' ' + this.format(cpy2) +\n\t\t\t' ' + this.format(cpx3) + ' ' + this.format(cpy3));\n\tthis.lastX = (cpx3 / s.scale) - s.dx;\n\tthis.lastY = (cpy3 / s.scale) - s.dy;\n\t\n};\n\n/**\n * Function: createRect\n * \n * Sets the glass gradient.\n */\nmxVmlCanvas2D.prototype.createRect = function(nodeName, x, y, w, h)\n{\n\tvar s = this.state;\n\tvar n = this.createVmlElement(nodeName);\n\tn.style.position = 'absolute';\n\tn.style.left = this.format((x + s.dx) * s.scale) + 'px';\n\tn.style.top = this.format((y + s.dy) * s.scale) + 'px';\n\tn.style.width = this.format(w * s.scale) + 'px';\n\tn.style.height = this.format(h * s.scale) + 'px';\n\t\n\treturn n;\n};\n\n/**\n * Function: rect\n * \n * Sets the current path to a rectangle.\n */\nmxVmlCanvas2D.prototype.rect = function(x, y, w, h)\n{\n\tthis.node = this.createRect('rect', x, y, w, h);\n};\n\n/**\n * Function: roundrect\n * \n * Sets the current path to a rounded rectangle.\n */\nmxVmlCanvas2D.prototype.roundrect = function(x, y, w, h, dx, dy)\n{\n\tthis.node = this.createRect('roundrect', x, y, w, h);\n\t// SetAttribute needed here for IE8\n\tthis.node.setAttribute('arcsize', Math.max(dx * 100 / w, dy * 100 / h) + '%');\n};\n\n/**\n * Function: ellipse\n * \n * Sets the current path to an ellipse.\n */\nmxVmlCanvas2D.prototype.ellipse = function(x, y, w, h)\n{\n\tthis.node = this.createRect('oval', x, y, w, h);\n};\n\n/**\n * Function: image\n * \n * Paints an image.\n */\nmxVmlCanvas2D.prototype.image = function(x, y, w, h, src, aspect, flipH, flipV)\n{\n\tvar node = null;\n\t\n\tif (!aspect)\n\t{\n\t\tnode = this.createRect('image', x, y, w, h);\n\t\tnode.src = src;\n\t}\n\telse\n\t{\n\t\t// Uses fill with aspect to avoid asynchronous update of size\n\t\tnode = this.createRect('rect', x, y, w, h);\n\t\tnode.stroked = 'false';\n\t\t\n\t\t// Handles image aspect via fill\n\t\tvar fill = this.createVmlElement('fill');\n\t\tfill.aspect = (aspect) ? 'atmost' : 'ignore';\n\t\tfill.rotate = 'true';\n\t\tfill.type = 'frame';\n\t\tfill.src = src;\n\n\t\tnode.appendChild(fill);\n\t}\n\t\n\tif (flipH && flipV)\n\t{\n\t\tnode.style.rotation = '180';\n\t}\n\telse if (flipH)\n\t{\n\t\tnode.style.flip = 'x';\n\t}\n\telse if (flipV)\n\t{\n\t\tnode.style.flip = 'y';\n\t}\n\t\n\tif (this.state.alpha < 1 || this.state.fillAlpha < 1)\n\t{\n\t\t// KNOWN: Borders around transparent images in IE<9. Using fill.opacity\n\t\t// fixes this problem by adding a white background in all IE versions.\n\t\tnode.style.filter += 'alpha(opacity=' + (this.state.alpha * this.state.fillAlpha * 100) + ')';\n\t}\n\n\tthis.root.appendChild(node);\n};\n\n/**\n * Function: createText\n * \n * Creates the innermost element that contains the HTML text.\n */\nmxVmlCanvas2D.prototype.createDiv = function(str, align, valign, overflow)\n{\n\tvar div = this.createElement('div');\n\tvar state = this.state;\n\n\tvar css = '';\n\t\n\tif (state.fontBackgroundColor != null)\n\t{\n\t\tcss += 'background-color:' + state.fontBackgroundColor + ';';\n\t}\n\t\n\tif (state.fontBorderColor != null)\n\t{\n\t\tcss += 'border:1px solid ' + state.fontBorderColor + ';';\n\t}\n\t\n\tif (mxUtils.isNode(str))\n\t{\n\t\tdiv.appendChild(str);\n\t}\n\telse\n\t{\n\t\tif (overflow != 'fill' && overflow != 'width')\n\t\t{\n\t\t\tvar div2 = this.createElement('div');\n\t\t\tdiv2.style.cssText = css;\n\t\t\tdiv2.style.display = (mxClient.IS_QUIRKS) ? 'inline' : 'inline-block';\n\t\t\tdiv2.style.zoom = '1';\n\t\t\tdiv2.style.textDecoration = 'inherit';\n\t\t\tdiv2.innerHTML = str;\n\t\t\tdiv.appendChild(div2);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdiv.style.cssText = css;\n\t\t\tdiv.innerHTML = str;\n\t\t}\n\t}\n\t\n\tvar style = div.style;\n\n\tstyle.fontSize = (state.fontSize / this.vmlScale) + 'px';\n\tstyle.fontFamily = state.fontFamily;\n\tstyle.color = state.fontColor;\n\tstyle.verticalAlign = 'top';\n\tstyle.textAlign = align || 'left';\n\tstyle.lineHeight = (mxConstants.ABSOLUTE_LINE_HEIGHT) ? (state.fontSize * mxConstants.LINE_HEIGHT / this.vmlScale) + 'px' : mxConstants.LINE_HEIGHT;\n\n\tif ((state.fontStyle & mxConstants.FONT_BOLD) == mxConstants.FONT_BOLD)\n\t{\n\t\tstyle.fontWeight = 'bold';\n\t}\n\n\tif ((state.fontStyle & mxConstants.FONT_ITALIC) == mxConstants.FONT_ITALIC)\n\t{\n\t\tstyle.fontStyle = 'italic';\n\t}\n\t\n\tif ((state.fontStyle & mxConstants.FONT_UNDERLINE) == mxConstants.FONT_UNDERLINE)\n\t{\n\t\tstyle.textDecoration = 'underline';\n\t}\n\t\n\treturn div;\n};\n\n/**\n * Function: text\n * \n * Paints the given text. Possible values for format are empty string for plain\n * text and html for HTML markup. Clipping, text background and border are not\n * supported for plain text in VML.\n */\nmxVmlCanvas2D.prototype.text = function(x, y, w, h, str, align, valign, wrap, format, overflow, clip, rotation, dir)\n{\n\tif (this.textEnabled && str != null)\n\t{\n\t\tvar s = this.state;\n\t\t\n\t\tif (format == 'html')\n\t\t{\n\t\t\tif (s.rotation != null)\n\t\t\t{\n\t\t\t\tvar pt = this.rotatePoint(x, y, s.rotation, s.rotationCx, s.rotationCy);\n\t\t\t\t\n\t\t\t\tx = pt.x;\n\t\t\t\ty = pt.y;\n\t\t\t}\n\n\t\t\tif (document.documentMode == 8 && !mxClient.IS_EM)\n\t\t\t{\n\t\t\t\tx += s.dx;\n\t\t\t\ty += s.dy;\n\t\t\t\t\n\t\t\t\t// Workaround for rendering offsets\n\t\t\t\tif (overflow != 'fill' && valign == mxConstants.ALIGN_TOP)\n\t\t\t\t{\n\t\t\t\t\ty -= 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tx *= s.scale;\n\t\t\t\ty *= s.scale;\n\t\t\t}\n\n\t\t\t// Adds event transparency in IE8 standards without the transparent background\n\t\t\t// filter which cannot be used due to bugs in the zoomed bounding box (too slow)\n\t\t\t// FIXME: No event transparency if inside v:rect (ie part of shape)\n\t\t\t// KNOWN: Offset wrong for rotated text with word that are longer than the wrapping\n\t\t\t// width in IE8 because real width of text cannot be determined here.\n\t\t\t// This should be fixed in mxText.updateBoundingBox by calling before this and\n\t\t\t// passing the real width to this method if not clipped and wrapped.\n\t\t\tvar abs = (document.documentMode == 8 && !mxClient.IS_EM) ? this.createVmlElement('group') : this.createElement('div');\n\t\t\tabs.style.position = 'absolute';\n\t\t\tabs.style.display = 'inline';\n\t\t\tabs.style.left = this.format(x) + 'px';\n\t\t\tabs.style.top = this.format(y) + 'px';\n\t\t\tabs.style.zoom = s.scale;\n\n\t\t\tvar box = this.createElement('div');\n\t\t\tbox.style.position = 'relative';\n\t\t\tbox.style.display = 'inline';\n\t\t\t\n\t\t\tvar margin = mxUtils.getAlignmentAsPoint(align, valign);\n\t\t\tvar dx = margin.x;\n\t\t\tvar dy = margin.y;\n\n\t\t\tvar div = this.createDiv(str, align, valign, overflow);\n\t\t\tvar inner = this.createElement('div');\n\t\t\t\n\t\t\tif (dir != null)\n\t\t\t{\n\t\t\t\tdiv.setAttribute('dir', dir);\n\t\t\t}\n\n\t\t\tif (wrap && w > 0)\n\t\t\t{\n\t\t\t\tif (!clip)\n\t\t\t\t{\n\t\t\t\t\tdiv.style.width = Math.round(w) + 'px';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdiv.style.wordWrap = mxConstants.WORD_WRAP;\n\t\t\t\tdiv.style.whiteSpace = 'normal';\n\t\t\t\t\n\t\t\t\t// LATER: Check if other cases need to be handled\n\t\t\t\tif (div.style.wordWrap == 'break-word')\n\t\t\t\t{\n\t\t\t\t\tvar tmp = div;\n\t\t\t\t\t\n\t\t\t\t\tif (tmp.firstChild != null && tmp.firstChild.nodeName == 'DIV')\n\t\t\t\t\t{\n\t\t\t\t\t\ttmp.firstChild.style.width = '100%';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdiv.style.whiteSpace = 'nowrap';\n\t\t\t}\n\t\t\t\n\t\t\tvar rot = s.rotation + (rotation || 0);\n\t\t\t\n\t\t\tif (this.rotateHtml && rot != 0)\n\t\t\t{\n\t\t\t\tinner.style.display = 'inline';\n\t\t\t\tinner.style.zoom = '1';\n\t\t\t\tinner.appendChild(div);\n\n\t\t\t\t// Box not needed for rendering in IE8 standards\n\t\t\t\tif (document.documentMode == 8 && !mxClient.IS_EM && this.root.nodeName != 'DIV')\n\t\t\t\t{\n\t\t\t\t\tbox.appendChild(inner);\n\t\t\t\t\tabs.appendChild(box);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tabs.appendChild(inner);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (document.documentMode == 8 && !mxClient.IS_EM)\n\t\t\t{\n\t\t\t\tbox.appendChild(div);\n\t\t\t\tabs.appendChild(box);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdiv.style.display = 'inline';\n\t\t\t\tabs.appendChild(div);\n\t\t\t}\n\t\t\t\n\t\t\t// Inserts the node into the DOM\n\t\t\tif (this.root.nodeName != 'DIV')\n\t\t\t{\n\t\t\t\t// Rectangle to fix position in group\n\t\t\t\tvar rect = this.createVmlElement('rect');\n\t\t\t\trect.stroked = 'false';\n\t\t\t\trect.filled = 'false';\n\n\t\t\t\trect.appendChild(abs);\n\t\t\t\tthis.root.appendChild(rect);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.root.appendChild(abs);\n\t\t\t}\n\t\t\t\n\t\t\tif (clip)\n\t\t\t{\n\t\t\t\tdiv.style.overflow = 'hidden';\n\t\t\t\tdiv.style.width = Math.round(w) + 'px';\n\t\t\t\t\n\t\t\t\tif (!mxClient.IS_QUIRKS)\n\t\t\t\t{\n\t\t\t\t\tdiv.style.maxHeight = Math.round(h) + 'px';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (overflow == 'fill')\n\t\t\t{\n\t\t\t\t// KNOWN: Affects horizontal alignment in quirks\n\t\t\t\t// but fill should only be used with align=left\n\t\t\t\tdiv.style.overflow = 'hidden';\n\t\t\t\tdiv.style.width = (Math.max(0, w) + 1) + 'px';\n\t\t\t\tdiv.style.height = (Math.max(0, h) + 1) + 'px';\n\t\t\t}\n\t\t\telse if (overflow == 'width')\n\t\t\t{\n\t\t\t\t// KNOWN: Affects horizontal alignment in quirks\n\t\t\t\t// but fill should only be used with align=left\n\t\t\t\tdiv.style.overflow = 'hidden';\n\t\t\t\tdiv.style.width = (Math.max(0, w) + 1) + 'px';\n\t\t\t\tdiv.style.maxHeight = (Math.max(0, h) + 1) + 'px';\n\t\t\t}\n\t\t\t\n\t\t\tif (this.rotateHtml && rot != 0)\n\t\t\t{\n\t\t\t\tvar rad = rot * (Math.PI / 180);\n\t\t\t\t\n\t\t\t\t// Precalculate cos and sin for the rotation\n\t\t\t\tvar real_cos = parseFloat(parseFloat(Math.cos(rad)).toFixed(8));\n\t\t\t\tvar real_sin = parseFloat(parseFloat(Math.sin(-rad)).toFixed(8));\n\n\t\t\t\trad %= 2 * Math.PI;\n\t\t\t\tif (rad < 0) rad += 2 * Math.PI;\n\t\t\t\trad %= Math.PI;\n\t\t\t\tif (rad > Math.PI / 2) rad = Math.PI - rad;\n\t\t\t\t\n\t\t\t\tvar cos = Math.cos(rad);\n\t\t\t\tvar sin = Math.sin(rad);\n\n\t\t\t\t// Adds div to document to measure size\n\t\t\t\tif (document.documentMode == 8 && !mxClient.IS_EM)\n\t\t\t\t{\n\t\t\t\t\tdiv.style.display = 'inline-block';\n\t\t\t\t\tinner.style.display = 'inline-block';\n\t\t\t\t\tbox.style.display = 'inline-block';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdiv.style.visibility = 'hidden';\n\t\t\t\tdiv.style.position = 'absolute';\n\t\t\t\tdocument.body.appendChild(div);\n\t\t\t\t\n\t\t\t\tvar sizeDiv = div;\n\t\t\t\t\n\t\t\t\tif (sizeDiv.firstChild != null && sizeDiv.firstChild.nodeName == 'DIV')\n\t\t\t\t{\n\t\t\t\t\tsizeDiv = sizeDiv.firstChild;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar tmp = sizeDiv.offsetWidth + 3;\n\t\t\t\tvar oh = sizeDiv.offsetHeight;\n\t\t\t\t\n\t\t\t\tif (clip)\n\t\t\t\t{\n\t\t\t\t\tw = Math.min(w, tmp);\n\t\t\t\t\toh = Math.min(oh, h);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tw = tmp;\n\t\t\t\t}\n\n\t\t\t\t// Handles words that are longer than the given wrapping width\n\t\t\t\tif (wrap)\n\t\t\t\t{\n\t\t\t\t\tdiv.style.width = w + 'px';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// Simulates max-height in quirks\n\t\t\t\tif (mxClient.IS_QUIRKS && (clip || overflow == 'width') && oh > h)\n\t\t\t\t{\n\t\t\t\t\toh = h;\n\t\t\t\t\t\n\t\t\t\t\t// Quirks does not support maxHeight\n\t\t\t\t\tdiv.style.height = oh + 'px';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\th = oh;\n\n\t\t\t\tvar top_fix = (h - h * cos + w * -sin) / 2 - real_sin * w * (dx + 0.5) + real_cos * h * (dy + 0.5);\n\t\t\t\tvar left_fix = (w - w * cos + h * -sin) / 2 + real_cos * w * (dx + 0.5) + real_sin * h * (dy + 0.5);\n\n\t\t\t\tif (abs.nodeName == 'group' && this.root.nodeName == 'DIV')\n\t\t\t\t{\n\t\t\t\t\t// Workaround for bug where group gets moved away if left and top are non-zero in IE8 standards\n\t\t\t\t\tvar pos = this.createElement('div');\n\t\t\t\t\tpos.style.display = 'inline-block';\n\t\t\t\t\tpos.style.position = 'absolute';\n\t\t\t\t\tpos.style.left = this.format(x + (left_fix - w / 2) * s.scale) + 'px';\n\t\t\t\t\tpos.style.top = this.format(y + (top_fix - h / 2) * s.scale) + 'px';\n\t\t\t\t\t\n\t\t\t\t\tabs.parentNode.appendChild(pos);\n\t\t\t\t\tpos.appendChild(abs);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvar sc = (document.documentMode == 8 && !mxClient.IS_EM) ? 1 : s.scale;\n\t\t\t\t\t\n\t\t\t\t\tabs.style.left = this.format(x + (left_fix - w / 2) * sc) + 'px';\n\t\t\t\t\tabs.style.top = this.format(y + (top_fix - h / 2) * sc) + 'px';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// KNOWN: Rotated text rendering quality is bad for IE9 quirks\n\t\t\t\tinner.style.filter = \"progid:DXImageTransform.Microsoft.Matrix(M11=\"+real_cos+\", M12=\"+\n\t\t\t\t\treal_sin+\", M21=\"+(-real_sin)+\", M22=\"+real_cos+\", sizingMethod='auto expand')\";\n\t\t\t\tinner.style.backgroundColor = this.rotatedHtmlBackground;\n\t\t\t\t\n\t\t\t\tif (this.state.alpha < 1)\n\t\t\t\t{\n\t\t\t\t\tinner.style.filter += 'alpha(opacity=' + (this.state.alpha * 100) + ')';\n\t\t\t\t}\n\n\t\t\t\t// Restore parent node for DIV\n\t\t\t\tinner.appendChild(div);\n\t\t\t\tdiv.style.position = '';\n\t\t\t\tdiv.style.visibility = '';\n\t\t\t}\n\t\t\telse if (document.documentMode != 8 || mxClient.IS_EM)\n\t\t\t{\n\t\t\t\tdiv.style.verticalAlign = 'top';\n\t\t\t\t\n\t\t\t\tif (this.state.alpha < 1)\n\t\t\t\t{\n\t\t\t\t\tabs.style.filter = 'alpha(opacity=' + (this.state.alpha * 100) + ')';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// Adds div to document to measure size\n\t\t\t\tvar divParent = div.parentNode;\n\t\t\t\tdiv.style.visibility = 'hidden';\n\t\t\t\tdocument.body.appendChild(div);\n\t\t\t\t\n\t\t\t\tw = div.offsetWidth;\n\t\t\t\tvar oh = div.offsetHeight;\n\t\t\t\t\n\t\t\t\t// Simulates max-height in quirks\n\t\t\t\tif (mxClient.IS_QUIRKS && clip && oh > h)\n\t\t\t\t{\n\t\t\t\t\toh = h;\n\t\t\t\t\t\n\t\t\t\t\t// Quirks does not support maxHeight\n\t\t\t\t\tdiv.style.height = oh + 'px';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\th = oh;\n\t\t\t\t\n\t\t\t\tdiv.style.visibility = '';\n\t\t\t\tdivParent.appendChild(div);\n\t\t\t\t\n\t\t\t\tabs.style.left = this.format(x + w * dx * this.state.scale) + 'px';\n\t\t\t\tabs.style.top = this.format(y + h * dy * this.state.scale) + 'px';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.state.alpha < 1)\n\t\t\t\t{\n\t\t\t\t\tdiv.style.filter = 'alpha(opacity=' + (this.state.alpha * 100) + ')';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// Faster rendering in IE8 without offsetWidth/Height\n\t\t\t\tbox.style.left = (dx * 100) + '%';\n\t\t\t\tbox.style.top = (dy * 100) + '%';\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.plainText(x, y, w, h, mxUtils.htmlEntities(str, false), align, valign, wrap, format, overflow, clip, rotation, dir);\n\t\t}\n\t}\n};\n\n/**\n * Function: plainText\n * \n * Paints the outline of the current path.\n */\nmxVmlCanvas2D.prototype.plainText = function(x, y, w, h, str, align, valign, wrap, format, overflow, clip, rotation, dir)\n{\n\t// TextDirection is ignored since this code is not used (format is always HTML in the text function)\n\tvar s = this.state;\n\tx = (x + s.dx) * s.scale;\n\ty = (y + s.dy) * s.scale;\n\t\n\tvar node = this.createVmlElement('shape');\n\tnode.style.width = '1px';\n\tnode.style.height = '1px';\n\tnode.stroked = 'false';\n\n\tvar fill = this.createVmlElement('fill');\n\tfill.color = s.fontColor;\n\tfill.opacity = (s.alpha * 100) + '%';\n\tnode.appendChild(fill);\n\t\n\tvar path = this.createVmlElement('path');\n\tpath.textpathok = 'true';\n\tpath.v = 'm ' + this.format(0) + ' ' + this.format(0) + ' l ' + this.format(1) + ' ' + this.format(0);\n\t\n\tnode.appendChild(path);\n\t\n\t// KNOWN: Font family and text decoration ignored\n\tvar tp = this.createVmlElement('textpath');\n\ttp.style.cssText = 'v-text-align:' + align;\n\ttp.style.align = align;\n\ttp.style.fontFamily = s.fontFamily;\n\ttp.string = str;\n\ttp.on = 'true';\n\t\n\t// Scale via fontsize instead of node.style.zoom for correct offsets in IE8\n\tvar size = s.fontSize * s.scale / this.vmlScale;\n\ttp.style.fontSize = size + 'px';\n\t\n\t// Bold\n\tif ((s.fontStyle & mxConstants.FONT_BOLD) == mxConstants.FONT_BOLD)\n\t{\n\t\ttp.style.fontWeight = 'bold';\n\t}\n\t\n\t// Italic\n\tif ((s.fontStyle & mxConstants.FONT_ITALIC) == mxConstants.FONT_ITALIC)\n\t{\n\t\ttp.style.fontStyle = 'italic';\n\t}\n\n\t// Underline\n\tif ((s.fontStyle & mxConstants.FONT_UNDERLINE) == mxConstants.FONT_UNDERLINE)\n\t{\n\t\ttp.style.textDecoration = 'underline';\n\t}\n\n\tvar lines = str.split('\\n');\n\tvar textHeight = size + (lines.length - 1) * size * mxConstants.LINE_HEIGHT;\n\tvar dx = 0;\n\tvar dy = 0;\n\n\tif (valign == mxConstants.ALIGN_BOTTOM)\n\t{\n\t\tdy = - textHeight / 2;\n\t}\n\telse if (valign != mxConstants.ALIGN_MIDDLE) // top\n\t{\n\t\tdy = textHeight / 2;\n\t}\n\n\tif (rotation != null)\n\t{\n\t\tnode.style.rotation = rotation;\n\t\tvar rad = rotation * (Math.PI / 180);\n\t\tdx = Math.sin(rad) * dy;\n\t\tdy = Math.cos(rad) * dy;\n\t}\n\n\t// FIXME: Clipping is relative to bounding box\n\t/*if (clip)\n\t{\n\t\tnode.style.clip = 'rect(0px ' + this.format(w) + 'px ' + this.format(h) + 'px 0px)';\n\t}*/\n\t\n\tnode.appendChild(tp);\n\tnode.style.left = this.format(x - dx) + 'px';\n\tnode.style.top = this.format(y + dy) + 'px';\n\t\n\tthis.root.appendChild(node);\n};\n\n/**\n * Function: stroke\n * \n * Paints the outline of the current path.\n */\nmxVmlCanvas2D.prototype.stroke = function()\n{\n\tthis.addNode(false, true);\n};\n\n/**\n * Function: fill\n * \n * Fills the current path.\n */\nmxVmlCanvas2D.prototype.fill = function()\n{\n\tthis.addNode(true, false);\n};\n\n/**\n * Function: fillAndStroke\n * \n * Fills and paints the outline of the current path.\n */\nmxVmlCanvas2D.prototype.fillAndStroke = function()\n{\n\tthis.addNode(true, true);\n};\n\n__mxOutput.mxVmlCanvas2D = typeof mxVmlCanvas2D !== 'undefined' ? mxVmlCanvas2D : undefined;\n"]}