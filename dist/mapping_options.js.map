{"version":3,"sources":["../src/mapping_options.js"],"names":["MappingOptionsCtrl","$scope","editor","panelCtrl","ctrl","panel","rulesHandler","flowchartHandler","u","window","unitFormats","kbn","getUnitFormats","style","text","value","colorOn","linkOn","textOn","textReplace","propTypes","textPattern","metricTypes","dateFormats","aggregationTypes","mappingTypes","getMetricNames","series","_","map","t","alias","getCellNamesForShape","log","flowchart","getFlowchart","cells","getNamesByProp","getCellNamesForText","getCellNamesForLink","render","column","subItem","unit","onRulesChange","ruleChanged","mappingOptionsTab","$q","uiSegmentSrv","restrict","scope","templateUrl","plugin","id","controller"],"mappings":"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","sourcesContent":["// eslint-disable-next-line import/no-unresolved\r\nimport kbn from 'app/core/utils/kbn';\r\nimport { plugin } from './plugin';\r\n\r\nexport class MappingOptionsCtrl {\r\n  /** @ngInject */\r\n  constructor($scope) {\r\n    $scope.editor = this;\r\n    this.panelCtrl = $scope.ctrl;\r\n    this.panel = this.panelCtrl.panel;\r\n    $scope.rulesHandler = this.panelCtrl.rulesHandler;\r\n    $scope.flowchartHandler = this.panelCtrl.flowchartHandler;\r\n    $scope.u = window.u;\r\n    this.flowchartHandler = $scope.ctrl.flowchartHandler;\r\n    this.unitFormats = kbn.getUnitFormats();\r\n    this.style = [\r\n      { text: 'Disabled', value: null },\r\n      { text: 'Stroke', value: 'strokeColor' },\r\n      { text: 'Fill', value: 'fillColor' },\r\n      { text: 'Text', value: 'fontColor' },\r\n    ];\r\n    this.colorOn = [{ text: 'Warning / Critical', value: 'wc' }, { text: 'Always', value: 'a' }];\r\n    this.linkOn = [{ text: 'Warning / Critical', value: 'wc' }, { text: 'Always', value: 'a' }];\r\n    this.textOn = [\r\n      { text: 'Never', value: 'n' },\r\n      { text: 'When Metric Displayed', value: 'wmd' },\r\n      { text: 'Warning / Critical', value: 'wc' },\r\n      { text: 'Critical Only', value: 'co' },\r\n    ];\r\n    this.textReplace = [\r\n      { text: 'All content', value: 'content' },\r\n      { text: 'Substring', value: 'pattern' },\r\n    ];\r\n    this.propTypes = [\r\n      { text: 'Id', value: 'id' },\r\n      // { text: \"Substring\", value: \"pattern\" }\r\n    ];\r\n    this.textPattern = '/.*/';\r\n    this.metricTypes = [\r\n      { text: 'Number', value: 'number' },\r\n      { text: 'String', value: 'string' },\r\n      { text: 'Date', value: 'date' },\r\n    ];\r\n    this.dateFormats = [\r\n      { text: 'YYYY-MM-DD HH:mm:ss', value: 'YYYY-MM-DD HH:mm:ss' },\r\n      { text: 'YYYY-MM-DD HH:mm:ss.SSS', value: 'YYYY-MM-DD HH:mm:ss.SSS' },\r\n      { text: 'MM/DD/YY h:mm:ss a', value: 'MM/DD/YY h:mm:ss a' },\r\n      { text: 'MMMM D, YYYY LT', value: 'MMMM D, YYYY LT' },\r\n      { text: 'YYYY-MM-DD', value: 'YYYY-MM-DD' },\r\n    ];\r\n    this.aggregationTypes = [\r\n      { text: 'First', value: 'first' },\r\n      { text: 'Last', value: 'current' },\r\n      { text: 'Min', value: 'min' },\r\n      { text: 'Max', value: 'max' },\r\n      { text: 'Sum', value: 'total' },\r\n      { text: 'Avg', value: 'avg' },\r\n      { text: 'Count', value: 'count' },\r\n      { text: 'Delta', value: 'delta' },\r\n      { text: 'Range', value: 'range' },\r\n      { text: 'Diff', value: 'diff' },\r\n    ];\r\n    this.mappingTypes = [{ text: 'Value to text', value: 1 }, { text: 'Range to text', value: 2 }];\r\n\r\n    this.getMetricNames = () => {\r\n      if (!this.panelCtrl.series) {\r\n        return [];\r\n      }\r\n      return _.map(this.panelCtrl.series, t => t.alias);\r\n    };\r\n\r\n    this.getCellNamesForShape = () => {\r\n      u.log(1, \"mapping_options.getCellNamesForShape()\");\r\n      const flowchart = this.flowchartHandler.getFlowchart(0);\r\n      const cells = flowchart.getNamesByProp('id');\r\n      return _.map(cells, t => t);\r\n    };\r\n\r\n    this.getCellNamesForText = () => {\r\n      u.log(1, \"mapping_options.getCellNamesForText()\");\r\n      const flowchart = this.flowchartHandler.getFlowchart(0);\r\n      const cells = flowchart.getNamesByProp('id');\r\n      return _.map(cells, t => t);\r\n    };\r\n\r\n    this.getCellNamesForLink = () => {\r\n      u.log(1, \"mapping_options.getCellNamesForLink()\");\r\n      const flowchart = this.flowchartHandler.getFlowchart(0);\r\n      const cells = flowchart.getNamesByProp('id');\r\n      return _.map(cells, t => t);\r\n    };\r\n  }\r\n\r\n  render() {\r\n    this.panelCtrl.render();\r\n  }\r\n\r\n  setUnitFormat(column, subItem) {\r\n    column.unit = subItem.value;\r\n    this.onRulesChange();\r\n  }\r\n\r\n  onRulesChange() {\r\n    this.flowchartHandler.ruleChanged();\r\n    this.render();\r\n  }\r\n}\r\n\r\n/** @ngInject */\r\nexport function mappingOptionsTab($q, uiSegmentSrv) {\r\n  'use strict';\r\n  return {\r\n    restrict: 'E',\r\n    scope: true,\r\n    templateUrl: `public/plugins/${plugin.id}/partials/mapping_options.html`,\r\n    controller: MappingOptionsCtrl,\r\n  };\r\n}\r\n"],"file":"mapping_options.js"}