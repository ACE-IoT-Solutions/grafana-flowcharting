{"version":3,"sources":["../src/flowchart_ctrl.js"],"names":["u","require","window","FlowchartCtrl","$scope","$injector","$rootScope","version","unitFormats","kbn","getUnitFormats","changedSource","changedData","changedOptions","rulesHandler","flowchartHandler","statesHandler","series","onMapping","active","object","undefined","idFocus","panelDefaults","newFlag","format","valueName","rulesData","flowchartsData","flowchart","source","type","xml","value","url","javascript","csv","options","zoom","center","scale","lock","grid","bgColor","_","defaults","panel","graphId","id","containerDivId","events","on","onRender","bind","onRefresh","onDataReceived","onDataError","onInitEditMode","onInitPanelActions","addEditorTab","flowchartOptionsTab","mappingOptionsTab","inspectOptionsTab","dataList","log","map","seriesHandler","SetUpdateStates","getRules","render","actions","push","text","click","scope","elem","attrs","ctrl","RulesHandler","FlowchartHandler","flowcharts","import","$new","publishAppEvent","templateHtml","modalClass","subItem","refresh","seriesData","TimeSeries","datapoints","alias","target","unit","flotpairs","getFlotPairs","nullPointMode","length","last","from","range","isOutsideRange","MetricsPanelCtrl","templateUrl"],"mappings":"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","sourcesContent":["import { MetricsPanelCtrl } from \"app/plugins/sdk\";\nimport TimeSeries from \"app/core/time_series2\";\nimport kbn from \"app/core/utils/kbn\";\nimport { mappingOptionsTab } from \"./mapping_options\";\nimport { flowchartOptionsTab } from \"./flowchart_options\";\nimport { inspectOptionsTab } from \"./inspect_options\";\n\nvar u = require(\"./utils\");\nwindow.u = window.u || u;\n\nimport RulesHandler from \"./rulesHandler\";\nimport FlowchartHandler from \"./flowchartHandler\"\nimport { plugin } from \"./plugin\";\n\n\nclass FlowchartCtrl extends MetricsPanelCtrl {\n  constructor($scope, $injector, $rootScope) {\n    super($scope, $injector);\n    this.version = \"0.3.0\";\n    this.$rootScope = $rootScope;\n    this.$scope = $scope;\n    this.unitFormats = kbn.getUnitFormats();\n    this.changedSource = true;\n    this.changedData = true;\n    this.changedOptions = true;\n    this.rulesHandler;\n    this.flowchartHandler;\n    this.statesHandler;\n    this.series = [];\n\n    // For Mapping with pointer\n    this.onMapping = {\n      active: false, // boolean if pointer mapping is active\n      object: undefined, // ojb to return id of mapping\n      idFocus: undefined // id of dom\n    };\n\n    var panelDefaults = {\n      version : this.version,\n      newFlag : true,\n      format: \"short\",\n      valueName: \"current\",\n      rulesData: [],\n      flowchartsData : [], \n      flowchart: {\n        source: {\n          type: \"xml\",\n          xml: {\n            //value: '<mxGraphModel  grid=\"1\" gridSize=\"10\" guides=\"1\" tooltips=\"1\" connect=\"1\" arrows=\"1\" fold=\"1\" page=\"1\" pageScale=\"1\"  math=\"0\" shadow=\"0\"><root><mxCell id=\"0\"/><mxCell id=\"1\" parent=\"0\"/><mxCell id=\"hPZ40pGzY2HQIh7cGHQj-1\" value=\"Grafana\" style=\"rounded=1;whiteSpace=wrap;html=1;gradientColor=#ffffff;fillColor=#FF8000;\" vertex=\"1\" parent=\"1\"><mxGeometry x=\"20\" y=\"20\" width=\"120\" height=\"60\" as=\"geometry\"/></mxCell><mxCell id=\"hPZ40pGzY2HQIh7cGHQj-2\" value=\"\" style=\"shape=flexArrow;endArrow=classic;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\" edge=\"1\" parent=\"1\" source=\"hPZ40pGzY2HQIh7cGHQj-1\" target=\"hPZ40pGzY2HQIh7cGHQj-3\"><mxGeometry width=\"50\" height=\"50\" relative=\"1\" as=\"geometry\"><mxPoint x=\"20\" y=\"150\" as=\"sourcePoint\"/><mxPoint x=\"80\" y=\"150\" as=\"targetPoint\"/></mxGeometry></mxCell><mxCell id=\"hPZ40pGzY2HQIh7cGHQj-3\" value=\"Loves\" style=\"ellipse;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;\" vertex=\"1\" parent=\"1\"><mxGeometry x=\"20\" y=\"134\" width=\"120\" height=\"80\" as=\"geometry\"/></mxCell><mxCell id=\"hPZ40pGzY2HQIh7cGHQj-4\" value=\"\" style=\"shape=flexArrow;endArrow=classic;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\" edge=\"1\" parent=\"1\" source=\"hPZ40pGzY2HQIh7cGHQj-3\" target=\"hPZ40pGzY2HQIh7cGHQj-5\"><mxGeometry width=\"50\" height=\"50\" relative=\"1\" as=\"geometry\"><mxPoint x=\"20\" y=\"281\" as=\"sourcePoint\"/><mxPoint x=\"160\" y=\"261\" as=\"targetPoint\"/></mxGeometry></mxCell><mxCell id=\"hPZ40pGzY2HQIh7cGHQj-5\" value=\"MxGraph\" style=\"rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;gradientColor=#ffffff;\" vertex=\"1\" parent=\"1\"><mxGeometry x=\"20\" y=\"261\" width=\"120\" height=\"60\" as=\"geometry\"/></mxCell></root></mxGraphModel>',\n            // value: '<mxGraphModel dx=\"1394\" dy=\"796\" grid=\"1\" gridSize=\"10\" guides=\"1\" tooltips=\"1\" connect=\"1\" arrows=\"1\" fold=\"1\" page=\"1\" pageScale=\"1\" pageWidth=\"827\" pageHeight=\"1169\" math=\"0\" shadow=\"0\"><root><mxCell id=\"0\"/><mxCell id=\"1\" parent=\"0\"/><mxCell id=\"arrow-1\" style=\"edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;jettySize=auto;orthogonalLoop=1;strokeWidth=4;shadow=1;\" parent=\"1\" source=\"shape-grafana\" target=\"shape-love\" edge=\"1\"><mxGeometry relative=\"1\" as=\"geometry\"/></mxCell><mxCell id=\"shape-grafana\" value=\"Grafana\" style=\"rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;shadow=1;\" parent=\"1\" vertex=\"1\"><mxGeometry x=\"10\" y=\"10\" width=\"120\" height=\"60\" as=\"geometry\"/></mxCell><mxCell id=\"arrow-2\" style=\"edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;jettySize=auto;orthogonalLoop=1;strokeWidth=4;shadow=1;\" parent=\"1\" source=\"shape-love\" target=\"shape-mxgraph\" edge=\"1\"><mxGeometry relative=\"1\" as=\"geometry\"/></mxCell><mxCell id=\"shape-love\" value=\"love\" style=\"triangle;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;shadow=1;\" parent=\"1\" vertex=\"1\"><mxGeometry x=\"210\" width=\"60\" height=\"80\" as=\"geometry\"/></mxCell><mxCell id=\"shape-mxgraph\" value=\"mxGraph\" style=\"ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;shadow=1;\" parent=\"1\" vertex=\"1\"><mxGeometry x=\"340\" width=\"120\" height=\"80\" as=\"geometry\"/></mxCell><mxCell id=\"text-grafana\" value=\"Le text : TextVal\" style=\"text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\" parent=\"1\" vertex=\"1\"><mxGeometry x=\"9\" y=\"50\" width=\"120\" height=\"20\" as=\"geometry\"/></mxCell><mxCell id=\"text-arrow1\" value=\"Text 2\" style=\"text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\" parent=\"1\" vertex=\"1\"><mxGeometry x=\"150\" y=\"20\" width=\"40\" height=\"20\" as=\"geometry\"/></mxCell><mxCell id=\"text-arrow2\" value=\"Text 3\" style=\"text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\" parent=\"1\" vertex=\"1\"><mxGeometry x=\"280\" y=\"20\" width=\"40\" height=\"20\" as=\"geometry\"/></mxCell><mxCell id=\"text-mxgraph\" value=\"Text 4\" style=\"text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\" parent=\"1\" vertex=\"1\"><mxGeometry x=\"380\" y=\"50\" width=\"40\" height=\"20\" as=\"geometry\"/></mxCell></root></mxGraphModel>',\n            value:\n              '<mxGraphModel dx=\"1073\" dy=\"521\" grid=\"1\" gridSize=\"10\" guides=\"1\" tooltips=\"1\" connect=\"1\" arrows=\"1\" fold=\"1\" page=\"0\" pageScale=\"1\" pageWidth=\"827\" pageHeight=\"1169\" math=\"0\" shadow=\"0\"><root><mxCell id=\"0\"/><mxCell id=\"1\" parent=\"0\"/><mxCell id=\"arrow-1\" style=\"edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;jettySize=auto;orthogonalLoop=1;strokeWidth=4;shadow=1;\" parent=\"1\" source=\"shape-grafana\" target=\"shape-love\" edge=\"1\"><mxGeometry relative=\"1\" as=\"geometry\"/></mxCell><object label=\"Grafana\" href=\"www.google.fr\" id=\"shape-grafana\"><mxCell style=\"rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;shadow=1;\" parent=\"1\" vertex=\"1\"><mxGeometry x=\"10\" y=\"10\" width=\"120\" height=\"60\" as=\"geometry\"/></mxCell></object><mxCell id=\"arrow-2\" style=\"edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;jettySize=auto;orthogonalLoop=1;strokeWidth=4;shadow=1;\" parent=\"1\" source=\"shape-love\" target=\"shape-mxgraph\" edge=\"1\"><mxGeometry relative=\"1\" as=\"geometry\"/></mxCell><mxCell id=\"shape-love\" value=\"loves\" style=\"triangle;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;shadow=1;\" parent=\"1\" vertex=\"1\"><mxGeometry x=\"210\" width=\"60\" height=\"80\" as=\"geometry\"/></mxCell><mxCell id=\"shape-mxgraph\" value=\"mxGraph\" style=\"ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;shadow=1;\" parent=\"1\" vertex=\"1\"><mxGeometry x=\"340\" width=\"120\" height=\"80\" as=\"geometry\"/></mxCell><mxCell id=\"text-grafana\" value=\"MyText : TextVal\" style=\"text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\" parent=\"1\" vertex=\"1\"><mxGeometry x=\"9\" y=\"50\" width=\"120\" height=\"20\" as=\"geometry\"/></mxCell><mxCell id=\"text-arrow1\" value=\"Text 2\" style=\"text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\" parent=\"1\" vertex=\"1\"><mxGeometry x=\"150\" y=\"20\" width=\"40\" height=\"20\" as=\"geometry\"/></mxCell><mxCell id=\"text-arrow2\" value=\"Text 3\" style=\"text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\" parent=\"1\" vertex=\"1\"><mxGeometry x=\"280\" y=\"20\" width=\"40\" height=\"20\" as=\"geometry\"/></mxCell><mxCell id=\"text-mxgraph\" value=\"Text 4\" style=\"text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\" parent=\"1\" vertex=\"1\"><mxGeometry x=\"380\" y=\"50\" width=\"40\" height=\"20\" as=\"geometry\"/></mxCell></root></mxGraphModel>'\n          },\n          url: {\n            value: \"http://<source>:<port>/<pathToXml>\"\n          },\n\n          javascript: {\n            value: \"Not yet\"\n          },\n          csv: {\n            value: \"Not yet\"\n          }\n        },\n        options: {\n          zoom: \"100%\",\n          center: true,\n          scale: true,\n          lock: true,\n          grid: false,\n          bgColor: undefined\n        }\n      }\n    };\n\n    _.defaults(this.panel, panelDefaults);\n    this.panel.graphId = \"flowchart_\" + this.panel.id;\n    this.containerDivId = \"container_\" + this.panel.graphId;\n\n    // events\n    this.events.on(\"render\", this.onRender.bind(this));\n    this.events.on(\"refresh\", this.onRefresh.bind(this));\n    this.events.on(\"data-received\", this.onDataReceived.bind(this));\n    this.events.on(\"data-error\", this.onDataError.bind(this));\n    this.events.on(\"data-snapshot-load\", this.onDataReceived.bind(this));\n    this.events.on(\"init-edit-mode\", this.onInitEditMode.bind(this));\n    this.events.on(\"init-panel-actions\", this.onInitPanelActions.bind(this));\n\n  }\n\n  //\n  // EVENTS FCT\n  //\n  onInitEditMode() {\n    this.addEditorTab(\"Flowchart\", flowchartOptionsTab, 2);\n    this.addEditorTab(\"Mapping\", mappingOptionsTab, 3);\n    this.addEditorTab(\"Inspect\", inspectOptionsTab, 4);\n  }\n\n  onRefresh() {\n    this.onRender();\n  }\n\n  onRender() {\n    // if (this.changedData == true || this.changedOptions == true) {\n    //   this.flowchartHandler.setStates(this.rulesHandler.getRules(),this.series);\n    //   this.changedOptions == false;\n    //   this.changedData == false;\n    // }\n  }\n\n  onDataReceived(dataList) {\n    u.log(1,\"ctrl.onDataReceived()\");\n    u.log(0,\"ctrl.onDataReceived()\",dataList);\n    this.changedData = true;\n    // console.debug(\"received data\");\n    // console.debug(dataList);\n    this.series = dataList.map(this.seriesHandler.bind(this));\n    // console.debug(\"mapped dataList to series\");\n    // console.debug(this.series);\n    this.flowchartHandler.SetUpdateStates(this.rulesHandler.getRules(),this.series);\n    this.render();\n  }\n\n  onDataError() {\n    this.series = [];\n    this.render();\n  }\n\n  onInitPanelActions(actions) {\n    actions.push({\n      text: \"Export SVG\",\n      click: \"ctrl.exportSVG()\"\n    });\n  }\n\n  //\n  // FUNCTIONS\n  //\n  link(scope, elem, attrs, ctrl) {\n    u.log(1,\"flowchart.link()\")\n    this.rulesHandler = new RulesHandler(scope, this.panel.rulesData);\n    this.flowchartHandler = new FlowchartHandler(scope,elem, ctrl, this.panel.flowcharts)\n    if ( this.panel.version == undefined ) this.flowchartHandler.import(this.panel.flowchartsData);\n    if ( this.panel.version != this.version ) this.flowchartHandler.import(this.panel.flowchartsData);\n  }\n\n  exportSVG() {\n    const scope = this.$scope.$new(true);\n    scope.panel = \"table\";\n    this.publishAppEvent(\"show-modal\", {\n      templateHtml:\n        '<export-data-modal panel=\"panel\" data=\"tableData\"></export-data-modal>',\n      scope,\n      modalClass: \"modal--narrow\"\n    });\n  }\n\n  setUnitFormat(subItem) {\n    this.panel.format = subItem.value;\n    this.refresh();\n  }\n\n  //\n  // Series\n  //\n  seriesHandler(seriesData) {\n    var series = new TimeSeries({\n      datapoints: seriesData.datapoints,\n      alias: seriesData.target,\n      unit: seriesData.unit\n    });\n\n    series.flotpairs = series.getFlotPairs(this.panel.nullPointMode);\n    var datapoints = seriesData.datapoints || [];\n    if (datapoints && datapoints.length > 0) {\n      var last = datapoints[datapoints.length - 1][1];\n      var from = this.range.from;\n      if (last - from < -10000) {\n        series.isOutsideRange = true;\n      }\n    }\n    return series;\n  }\n\n}\n\nexport { FlowchartCtrl, FlowchartCtrl as MetricsPanelCtrl };\n\nFlowchartCtrl.templateUrl = \"./partials/module.html\";\n"],"file":"flowchart_ctrl.js"}