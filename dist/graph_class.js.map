{"version":3,"sources":["../src/graph_class.js"],"names":["window","mxLanguages","sanitizer","require","mxgraph","mxImageBasePath","GF_PLUGIN","getMxImagePath","mxBasePath","getMxBasePath","mxLoadStylesheets","mxLanguage","mxLoadResources","BASE_PATH","RESOURCES_PATH","RESOURCE_BASE","STENCIL_PATH","IMAGE_PATH","STYLE_PATH","CSS_PATH","mxActor","mxArrow","mxArrowConnector","mxCell","mxCellEditor","mxCellHighlight","mxCellOverlay","mxCellRenderer","mxCellState","mxClient","mxCloud","mxCodec","mxCompactTreeLayout","mxConnectionConstraint","mxConnectionHandler","mxConnector","mxConstants","mxConstraintHandler","mxCylinder","mxDefaultKeyHandler","mxDefaultPopupMenu","mxDefaultToolbar","mxDivResizer","mxDoubleEllipse","mxDragSource","mxEdgeStyle","mxEdgeHandler","mxEditor","mxElbowEdgeHandler","mxEllipse","mxEvent","mxEventObject","mxFile","mxGeometry","mxGraph","mxGraphHandler","mxGraphModel","mxGraphView","mxGuide","mxHexagon","mxHandle","mxHierarchicalLayout","mxImage","mxImageShape","mxKeyHandler","mxLabel","mxLayoutManager","mxLine","mxMarker","mxOutline","mxPanningHandler","mxPerimeter","mxPoint","mxPolyline","mxPopupMenu","mxPopupMenuHandler","mxPrintPreview","mxRectangle","mxRectangleShape","mxResources","mxRhombus","mxRubberband","mxShape","mxStackLayout","mxStencil","mxStencilRegistry","mxStylesheet","mxStyleRegistry","mxSvgCanvas2D","mxSwimlane","mxText","mxToolbar","mxTooltip","mxTooltipHandler","mxTriangle","mxUndoManager","mxUtils","mxValueChange","mxVertexHandler","XGraph","container","xmlGraph","u","log","undefined","isencoded","decode","graph","scale","tooltip","lock","center","zoom","grid","zoomPercent","cells","id","value","attributs","clickBackup","initGraph","Graph","libs","Shapes","click","getModel","beginUpdate","clear","xmlDoc","parseXml","codec","documentElement","error","endUpdate","getCurrentCells","width","height","$div","$","size","Math","min","css","margin","position","zoomGraph","unzoomGraph","tooltipGraph","lockGraph","scaleGraph","gridGraph","centerGraph","refresh","bool","setEnabled","setTooltips","centerZoom","fit","view","rendering","style","backgroundImage","percent","length","ratio","replace","zoomTo","zoomActual","drawGraph","prop","cellIds","model","_","each","cell","push","getId","getValue","pattern","mxcells","getMxCells","result","mxcell","matchString","findMxCells","setSelectionCells","clearSelection","image","overlay","addListener","CLICK","_sender","_evt","alert","Date","state","addCellOverlay","createOverlay","warningImage","removeCellOverlays","link","setLinkForCell","getLinkForCell","oldId","newId","forEach","encoder","node","encode","getXml","find","getOrignalCells","getState","color","setCellStyles","text","lastValue","setValue","onMappingObj","onMapping","active","eventGraph","bind","$scope","$apply","me","self","object","data","elt","document","getElementById","setTimeout","focus","unsetMap"],"mappings":"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","sourcesContent":["/* eslint-disable no-undef */\r\n/* eslint-disable new-cap */\r\n/* eslint-disable dot-notation */\r\n/* eslint-disable object-shorthand */\r\nwindow.mxLanguages = window.mxLanguages || ['en'];\r\n\r\nconst sanitizer = require('sanitizer');\r\nconst mxgraph = require('mxgraph')({\r\n  mxImageBasePath: GF_PLUGIN.getMxImagePath(),\r\n  mxBasePath: GF_PLUGIN.getMxBasePath(),\r\n  mxLoadStylesheets: false,\r\n  mxLanguage: 'en',\r\n  mxLoadResources: false,\r\n});\r\n\r\nwindow.BASE_PATH = window.BASE_PATH || GF_PLUGIN.getMxBasePath();\r\nwindow.RESOURCES_PATH = window.BASE_PATH || `${window.BASE_PATH}resources`;\r\nwindow.RESOURCE_BASE = window.RESOURCE_BASE || `${window.RESOURCES_PATH}/grapheditor`;\r\nwindow.STENCIL_PATH = window.STENCIL_PATH || `${window.BASE_PATH}stencils`;\r\nwindow.IMAGE_PATH = window.IMAGE_PATH || `${window.BASE_PATH}images`;\r\nwindow.STYLE_PATH = window.STYLE_PATH || `${window.BASE_PATH}styles`;\r\nwindow.CSS_PATH = window.CSS_PATH || `${window.BASE_PATH}styles`;\r\nwindow.mxLanguages = window.mxLanguages || ['en'];\r\n\r\n// Put to global vars to work\r\nwindow.mxActor = window.mxActor || mxgraph.mxActor;\r\nwindow.mxArrow = window.mxArrow || mxgraph.mxArrow;\r\nwindow.mxArrowConnector = window.mxArrowConnector || mxgraph.mxArrowConnector;\r\nwindow.mxCell = window.mxCell || mxgraph.mxCell;\r\nwindow.mxCellEditor = window.mxCellEditor || mxgraph.mxCellEditor;\r\nwindow.mxCellHighlight = window.mxCellHighlight || mxgraph.mxCellHighlight;\r\nwindow.mxCellOverlay = window.mxCellOverlay || mxgraph.mxCellOverlay;\r\nwindow.mxCellRenderer = window.mxCellRenderer || mxgraph.mxCellRenderer;\r\nwindow.mxCellState = window.mxCellState || mxgraph.mxCellState;\r\nwindow.mxClient = window.mxClient || mxgraph.mxClient;\r\nmxClient.mxBasePath = GF_PLUGIN.getMxBasePath();\r\nmxClient.mxImageBasePath = GF_PLUGIN.getMxImagePath();\r\nmxClient.mxLoadResources = true;\r\nmxClient.mxLanguage = 'en';\r\nmxClient.mxLoadStylesheets = true;\r\nwindow.mxCloud = window.mxCloud || mxgraph.mxCloud;\r\nwindow.mxCodec = window.mxCodec || mxgraph.mxCodec;\r\nwindow.mxCompactTreeLayout = window.mxCompactTreeLayout || mxgraph.mxCompactTreeLayout;\r\nwindow.mxConnectionConstraint = window.mxConnectionConstraint || mxgraph.mxConnectionConstraint;\r\nwindow.mxConnectionHandler = window.mxConnectionHandler || mxgraph.mxConnectionHandler;\r\nwindow.mxConnector = window.mxConnector || mxgraph.mxConnector;\r\nwindow.mxConstants = window.mxConstants || mxgraph.mxConstants;\r\nwindow.mxConstraintHandler = window.mxConstraintHandler || mxgraph.mxConstraintHandler;\r\nwindow.mxCylinder = window.mxCylinder || mxgraph.mxCylinder;\r\nwindow.mxDefaultKeyHandler = window.mxDefaultKeyHandler || mxgraph.mxDefaultKeyHandler;\r\nwindow.mxDefaultPopupMenu = window.mxDefaultPopupMenu || mxgraph.mxDefaultPopupMenu;\r\nwindow.mxDefaultToolbar = window.mxDefaultToolbar || mxgraph.mxDefaultToolbar;\r\nwindow.mxDivResizer = window.mxDivResizer || mxgraph.mxDivResizer;\r\nwindow.mxDoubleEllipse = window.mxDoubleEllipse || mxgraph.mxDoubleEllipse;\r\nwindow.mxDragSource = window.mxDragSource || mxgraph.mxDragSource;\r\nwindow.mxEdgeStyle = window.mxEdgeStyle || mxgraph.mxEdgeStyle;\r\nwindow.mxEdgeHandler = window.mxEdgeHandler || mxgraph.mxEdgeHandler;\r\nwindow.mxEditor = window.mxEditor || mxgraph.mxEditor;\r\nwindow.mxElbowEdgeHandler = window.mxElbowEdgeHandler || mxgraph.mxElbowEdgeHandler;\r\nwindow.mxEllipse = window.mxEllipse || mxgraph.mxEllipse;\r\nwindow.mxEvent = window.mxEvent || mxgraph.mxEvent;\r\nwindow.mxEventObject = window.mxEventObject || mxgraph.mxEventObject;\r\nwindow.mxFile = window.mxFile || mxgraph.mxFile;\r\nwindow.mxGeometry = window.mxGeometry || mxgraph.mxGeometry;\r\nwindow.mxGraph = window.mxGraph || mxgraph.mxGraph;\r\nwindow.mxGraphHandler = window.mxGraphHandler || mxgraph.mxGraphHandler;\r\nwindow.mxGraphModel = window.mxGraphModel || mxgraph.mxGraphModel;\r\nwindow.mxGraphView = window.mxGraphView || mxgraph.mxGraphView;\r\nwindow.mxGuide = window.mxGuide || mxgraph.mxGuide;\r\nwindow.mxHexagon = window.mxHexagon || mxgraph.mxHexagon;\r\nwindow.mxHandle = window.mxHandle || mxgraph.mxHandle;\r\nwindow.mxHierarchicalLayout = window.mxHierarchicalLayout || mxgraph.mxHierarchicalLayout;\r\nwindow.mxImage = window.mxImage || mxgraph.mxImage;\r\nwindow.mxImageShape = window.mxImageShape || mxgraph.mxImageShape;\r\nwindow.mxKeyHandler = window.mxKeyHandler || mxgraph.mxKeyHandler;\r\nwindow.mxLabel = window.mxLabel || mxgraph.mxLabel;\r\nwindow.mxLayoutManager = window.mxLayoutManager || mxgraph.mxLayoutManager;\r\nwindow.mxLine = window.mxLine || mxgraph.mxLine;\r\nwindow.mxMarker = window.mxMarker || mxgraph.mxMarker;\r\nwindow.mxOutline = window.mxOutline || mxgraph.mxOutline;\r\nwindow.mxPanningHandler = window.mxPanningHandler || mxgraph.mxPanningHandler;\r\nwindow.mxPerimeter = window.mxPerimeter || mxgraph.mxPerimeter;\r\nwindow.mxPoint = window.mxPoint || mxgraph.mxPoint;\r\nwindow.mxPolyline = window.mxPolyline || mxgraph.mxPolyline;\r\nwindow.mxPopupMenu = window.mxPopupMenu || mxgraph.mxPopupMenu;\r\nwindow.mxPopupMenuHandler = window.mxPopupMenuHandler || mxgraph.mxPopupMenuHandler;\r\nwindow.mxPrintPreview = window.mxPrintPreview || mxgraph.mxPrintPreview;\r\nwindow.mxRectangle = window.mxRectangle || mxgraph.mxRectangle;\r\nwindow.mxRectangleShape = window.mxRectangleShape || mxgraph.mxRectangleShape;\r\nwindow.mxResources = window.mxResources || mxgraph.mxResources;\r\nwindow.mxRhombus = window.mxRhombus || mxgraph.mxRhombus;\r\nwindow.mxRubberband = window.mxRubberband || mxgraph.mxRubberband;\r\nwindow.mxShape = window.mxShape || mxgraph.mxShape;\r\nwindow.mxStackLayout = window.mxStackLayout || mxgraph.mxStackLayout;\r\nwindow.mxStencil = window.mxStencil || mxgraph.mxStencil;\r\nwindow.mxStencilRegistry = window.mxStencilRegistry || mxgraph.mxStencilRegistry;\r\nwindow.mxStylesheet = window.mxStylesheet || mxgraph.mxStylesheet;\r\nwindow.mxStyleRegistry = window.mxStyleRegistry || mxgraph.mxStyleRegistry;\r\nwindow.mxSvgCanvas2D = window.mxSvgCanvas2D || mxgraph.mxSvgCanvas2D;\r\nwindow.mxSwimlane = window.mxSwimlane || mxgraph.mxSwimlane;\r\nwindow.mxText = window.mxText || mxgraph.mxText;\r\nwindow.mxToolbar = window.mxToolbar || mxgraph.mxToolbar;\r\nwindow.mxTooltip = window.mxTooltip || mxgraph.mxTooltip;\r\nwindow.mxTooltipHandler = window.mxTooltipHandler || mxgraph.mxTooltipHandler;\r\nwindow.mxTriangle = window.mxTriangle || mxgraph.mxTriangle;\r\nwindow.mxUndoManager = window.mxUndoManager || mxgraph.mxUndoManager;\r\nwindow.mxUtils = window.mxUtils || mxgraph.mxUtils;\r\nwindow.mxValueChange = window.mxValueChange || mxgraph.mxValueChange;\r\nwindow.mxVertexHandler = window.mxVertexHandler || mxgraph.mxVertexHandler;\r\n\r\nexport default class XGraph {\r\n  constructor(container, xmlGraph) {\r\n    u.log(1, 'XGraph.constructor()');\r\n    this.container = container;\r\n    this.xmlGraph = undefined;\r\n    if (u.isencoded(xmlGraph)) this.xmlGraph = u.decode(xmlGraph, true, true, true);\r\n    else this.xmlGraph = xmlGraph;\r\n    this.xmlGraph = xmlGraph;\r\n    this.graph = undefined;\r\n    this.scale = true;\r\n    this.tooltip = true;\r\n    this.lock = true;\r\n    this.center = true;\r\n    this.zoom = false;\r\n    this.grid = false;\r\n    this.zoomPercent = '1';\r\n    this.cells = {};\r\n    this.cells.id = [];\r\n    this.cells.value = [];\r\n    this.cells.attributs = {};\r\n    this.clickBackup = undefined;\r\n\r\n    this.initGraph();\r\n  }\r\n\r\n  initGraph() {\r\n    u.log(1, 'XGraph.initGraph()');\r\n    const Graph = require('./Graph')({\r\n      libs: 'arrows;basic;bpmn;flowchart',\r\n    });\r\n    const Shapes = require('./Shapes');\r\n    this.graph = new Graph(this.container);\r\n    // /!\\ What is setPannig\r\n    // this.graph.setPanning(true);\r\n    this.clickBackup = this.graph.click;\r\n  }\r\n\r\n  drawGraph() {\r\n    u.log(1, 'XGraph.drawGraph()');\r\n    this.graph.getModel().beginUpdate();\r\n    this.graph.getModel().clear();\r\n    try {\r\n      const xmlDoc = mxUtils.parseXml(this.xmlGraph);\r\n      const codec = new mxCodec(xmlDoc);\r\n      codec.decode(xmlDoc.documentElement, this.graph.getModel());\r\n    } catch (error) {\r\n      u.log(3, 'Error in draw', error);\r\n    } finally {\r\n      this.graph.getModel().endUpdate();\r\n      this.cells['id'] = this.getCurrentCells('id');\r\n      this.cells['value'] = this.getCurrentCells('value');\r\n    }\r\n  }\r\n\r\n  refreshGraph(width, height) {\r\n    u.log(1, 'XGraph.refreshGraph()');\r\n    const $div = $(this.container);\r\n    const size = Math.min(width, height);\r\n\r\n    const css = {\r\n      margin: 'auto',\r\n      position: 'relative',\r\n      width: width,\r\n      height: `${size - 30}px`,\r\n    };\r\n\r\n    $div.css(css);\r\n    if (!this.scale) this.zoomGraph(this.zoomPercent);\r\n    else this.unzoomGraph();\r\n\r\n    this.tooltipGraph(this.tooltip);\r\n    this.lockGraph(this.lock);\r\n    this.scaleGraph(this.scale);\r\n    this.gridGraph(this.grid);\r\n    this.centerGraph(this.center);\r\n    this.graph.refresh();\r\n  }\r\n\r\n  lockGraph(bool) {\r\n    if (bool) this.graph.setEnabled(false);\r\n    else this.graph.setEnabled(true);\r\n    this.lock = bool;\r\n  }\r\n\r\n  tooltipGraph(bool) {\r\n    if (bool) this.graph.setTooltips(true);\r\n    else this.graph.setTooltips(false);\r\n    this.tooltip = bool;\r\n  }\r\n\r\n  centerGraph(bool) {\r\n    this.graph.centerZoom = false;\r\n    if (bool) this.graph.center(true, true);\r\n    else this.graph.center(false, false);\r\n    this.center = bool;\r\n  }\r\n\r\n  scaleGraph(bool) {\r\n    if (bool) {\r\n      this.unzoomGraph();\r\n      this.graph.fit();\r\n      this.graph.view.rendering = true;\r\n    }\r\n    this.scale = bool;\r\n  }\r\n\r\n  gridGraph(bool) {\r\n    if (bool) {\r\n      // eslint-disable-next-line no-undef\r\n      this.container.style.backgroundImage = `url('${IMAGE_PATH}/grid.gif')`;\r\n    } else {\r\n      this.container.style.backgroundImage = '';\r\n    }\r\n    this.grid = bool;\r\n  }\r\n\r\n  zoomGraph(percent) {\r\n    u.log(1, 'XGraph.zoomGraph()');\r\n    if (!this.scale && percent && percent.length > 0 && percent !== '100%' && percent !== '0%') {\r\n      const ratio = percent.replace('%', '') / 100;\r\n      this.graph.zoomTo(ratio, true);\r\n      this.zoomPercent = percent;\r\n    } else {\r\n      this.unzoomGraph();\r\n    }\r\n    this.zoom = true;\r\n  }\r\n\r\n  unzoomGraph() {\r\n    this.zoom = false;\r\n    this.graph.zoomActual();\r\n  }\r\n\r\n  getMxGraph() {\r\n    return this.graph;\r\n  }\r\n\r\n  getxmlGraph() {\r\n    return this.xmlGraph;\r\n  }\r\n\r\n  setXmlGraph(xmlGraph) {\r\n    u.log(1, 'XGraph.setXmlGraph()');\r\n    if (u.isencoded(xmlGraph)) this.xmlGraph = u.decode(xmlGraph, true, true, true);\r\n    else this.xmlGraph = xmlGraph;\r\n    this.drawGraph();\r\n  }\r\n\r\n  getCurrentCells(prop) {\r\n    const cellIds = [];\r\n    const model = this.graph.getModel();\r\n    const cells = model.cells;\r\n    if (prop === 'id') {\r\n      _.each(cells, (cell) => {\r\n        cellIds.push(cell.getId());\r\n      });\r\n    } else if (prop === 'value') {\r\n      _.each(cells, (cell) => {\r\n        cellIds.push(cell.getValue());\r\n      });\r\n    }\r\n    return cellIds;\r\n  }\r\n\r\n  findMxCells(prop, pattern) {\r\n    const mxcells = this.getMxCells();\r\n    const result = [];\r\n    if (prop === 'id') {\r\n      _.each(mxcells, (mxcell) => {\r\n        if (u.matchString(mxcell.id, pattern)) result.push(mxcell);\r\n      });\r\n    } else if (prop === 'value') {\r\n      _.each(mxcells, (mxcell) => {\r\n        if (u.matchString(mxcell.getValue(), pattern)) result.push(mxcell);\r\n      });\r\n    }\r\n    return result;\r\n  }\r\n\r\n  selectMxCells(prop, pattern) {\r\n    const mxcells = this.findMxCells(prop, pattern);\r\n    if (mxcells) {\r\n      this.graph.setSelectionCells(mxcells);\r\n    }\r\n  }\r\n\r\n  unselectMxCells() {\r\n    // this.graph.removeCellOverlays(cell);\r\n    this.graph.clearSelection();\r\n  }\r\n\r\n  createOverlay(image, tooltip) {\r\n    const overlay = new mxCellOverlay(image, tooltip);\r\n    overlay.addListener(mxEvent.CLICK, (_sender, _evt) => {\r\n      mxUtils.alert(`${tooltip}\\nLast update: ${new Date()}`);\r\n    });\r\n    return overlay;\r\n  }\r\n\r\n  addOverlay(state, mxcell) {\r\n    this.graph.addCellOverlay(\r\n      mxcell,\r\n      this.createOverlay(this.graph.warningImage, `State: ${state}`),\r\n    );\r\n  }\r\n\r\n  removeOverlay(mxcell) {\r\n    this.graph.removeCellOverlays(mxcell);\r\n  }\r\n\r\n  addLink(mxcell, link) {\r\n    this.graph.setLinkForCell(mxcell, link);\r\n  }\r\n\r\n  getLink(mxcell) {\r\n    this.graph.getLinkForCell(mxcell);\r\n  }\r\n\r\n  removeLink(mxcell) {\r\n    this.graph.setLinkForCell(mxcell, null);\r\n  }\r\n\r\n  getOrignalCells(prop) {\r\n    if (prop === 'id' || prop === 'value') return this.cells[prop];\r\n    // TODO: attributs\r\n    return [];\r\n  }\r\n\r\n  renameId(oldId, newId) {\r\n    const cells = this.findMxCells('id', oldId);\r\n    if (cells !== undefined && cells.length > 0) {\r\n      cells.forEach((cell) => {\r\n        cell.id = newId;\r\n      });\r\n    } else {\r\n      u.log(2, `Cell ${oldId} not found`);\r\n    }\r\n  }\r\n\r\n  getXmlModel() {\r\n    const encoder = new mxCodec();\r\n    const node = encoder.encode(this.graph.getModel());\r\n    return mxUtils.getXml(node);\r\n  }\r\n\r\n  findCurrentCells(prop, pattern) {\r\n    const cells = this.getCurrentCells(prop);\r\n    const result = _.find(cells, (cell) => {\r\n      u.matchString(cell, pattern);\r\n    });\r\n    return result;\r\n  }\r\n\r\n  findOriginalCells(prop, pattern) {\r\n    const cells = this.getOrignalCells(prop);\r\n    const result = _.find(cells, (cell) => {\r\n      u.matchString(cell, pattern);\r\n    });\r\n    return result;\r\n  }\r\n\r\n  getMxCells() {\r\n    return this.graph.getModel().cells;\r\n  }\r\n\r\n  findCurrentMxCells(prop, pattern) {\r\n    const cells = [];\r\n    _.each(this.getMxCells(), (cell) => {\r\n      if (prop === 'id') {\r\n        const id = cell.getId();\r\n        if (u.matchString(id, pattern)) cells.push(cell);\r\n      } else if (prop === 'value') {\r\n        const value = cell.getValue();\r\n        if (u.matchString(value, pattern)) cells.push(cell);\r\n      }\r\n    });\r\n    return cells;\r\n  }\r\n\r\n  getStyleCell(mxcell, style) {\r\n    const state = this.graph.view.getState(mxcell);\r\n    return state.style[style];\r\n  }\r\n\r\n  setStyleCell(mxcell, style, color) {\r\n    this.graph.setCellStyles(style, color, [mxcell]);\r\n  }\r\n\r\n  // eslint-disable-next-line class-methods-use-this\r\n  getValueCell(mxcell) {\r\n    const view = this.graph.view;\r\n    if (view.getState(mxcell).text != null) return view.getState(mxcell).text.lastValue;\r\n    return mxcell.getValue();\r\n  }\r\n\r\n  // eslint-disable-next-line class-methods-use-this\r\n  setValueCell(mxcell, text) {\r\n    return mxcell.setValue(text);\r\n  }\r\n\r\n  setMap(onMappingObj) {\r\n    u.log(1, 'XGraph.setMapping()');\r\n    u.log(0, 'XGraph.setMapping() onMappingObject : ', onMappingObj);\r\n    this.onMapping = onMappingObj;\r\n    if (this.onMapping.active === true) {\r\n      this.graph.click = this.eventGraph.bind(this);\r\n    }\r\n  }\r\n\r\n  unsetMap() {\r\n    u.log(1, 'XGraph.unsetMapping()');\r\n    u.log(0, 'XGraph.unsetMapping() onMapping', this.onMapping);\r\n    this.onMapping.active = false;\r\n    this.graph.click = this.clickBackup;\r\n    this.onMapping.$scope.$apply();\r\n  }\r\n\r\n  //\r\n  // GRAPH HANDLER\r\n  //\r\n\r\n  eventGraph(me) {\r\n    u.log(1, 'XGraph.eventGraph()');\r\n    u.log(0, 'XGraph.eventGraph() me : ', me);\r\n    u.log(0, 'XGraph.eventGraph() onMapping : ', this.onMapping);\r\n    const self = this;\r\n\r\n    if (this.onMapping.active) {\r\n      const state = me.getState();\r\n      if (state) {\r\n        const id = state.cell.id;\r\n        this.onMapping.object.data.pattern = id;\r\n        const elt = document.getElementById(this.onMapping.id);\r\n        if (elt) {\r\n          setTimeout(() => {\r\n            elt.focus();\r\n          }, 100);\r\n        }\r\n        this.unsetMap();\r\n      }\r\n    }\r\n  }\r\n}\r\n"],"file":"graph_class.js"}