{"version":3,"sources":["../src/rule_class.js"],"names":["Rule","pattern","data","shapeMaps","textMaps","linkMaps","valueMaps","rangeMaps","import","JSON","stringify","obj","unit","type","alias","aggregation","decimals","colors","style","colorMode","colorOn","link","undefined","linkOn","linkUrl","linkParams","textOn","textReplace","textPattern","dateFormat","thresholds","invert","overlayIcon","maps","shapeProp","shapeData","length","forEach","map","newData","sm","ShapeMap","push","textProp","textData","tm","TextMap","linkProp","linkData","lm","LinkMap","mappingType","valueData","vm","ValueMap","value","text","rangeData","rm","RangeMap","from","to","sanitize","ref","copy","getThresholdLevel","serie","u","matchString","m","index","splice","found","element","match","log","hide","show","i","_","first","thresholdLevel","matchSerie","get","stats","datapoints","formattedValue","getValueForSerie","getFormattedValue","window","location","search","isFinite","decimalPlaces","Math","min","formatValue","isArray","join","getFormattedText","toString","date","format","FormattedValue","regexVal","stringToJsRegex","replace","$sanitize","escape","num","max","id","uniqueID","hidden","rule","toColorize","Number","isString","kbn","valueFormats"],"mappings":";;;;;;;AAEA;;AAEA;;;;;;;;;;IAEqBA,I;;;AACnB;AACA,gBAAYC,OAAZ,EAAqBC,IAArB,EAA2B;AAAA;;AACzB,SAAKA,IAAL,GAAYA,IAAZ;AACA,SAAKA,IAAL,CAAUD,OAAV,GAAoBA,OAApB;AACA,SAAKE,SAAL,GAAiB,EAAjB;AACA,SAAKC,QAAL,GAAgB,EAAhB;AACA,SAAKC,QAAL,GAAgB,EAAhB;AACA,SAAKC,SAAL,GAAiB,EAAjB;AACA,SAAKC,SAAL,GAAiB,EAAjB;AACA,SAAKC,MAAL,CAAYN,IAAZ;AACD;;;;8BAES;AACR,aAAO,KAAKA,IAAZ;AACD;;;8BAEQ;AACP,aAAOO,IAAI,CAACC,SAAL,CAAe,IAAf,CAAP;AACD;;;4BAEMC,G,EAAK;AAAA;;AACV,WAAKT,IAAL,CAAUU,IAAV,GAAiBD,GAAG,CAACC,IAAJ,IAAY,OAA7B;AACA,WAAKV,IAAL,CAAUW,IAAV,GAAiBF,GAAG,CAACE,IAAJ,IAAY,QAA7B;AACA,WAAKX,IAAL,CAAUY,KAAV,GAAkBH,GAAG,CAACG,KAAJ,IAAa,SAA/B;AACA,WAAKZ,IAAL,CAAUa,WAAV,GAAwBJ,GAAG,CAACI,WAAJ,IAAmB,SAA3C;AACA,WAAKb,IAAL,CAAUc,QAAV,GAAqBL,GAAG,CAACK,QAAJ,IAAgB,CAArC;AACA,WAAKd,IAAL,CAAUe,MAAV,GAAmBN,GAAG,CAACM,MAAJ,IAAc,CAC/B,wBAD+B,EAE/B,0BAF+B,EAG/B,yBAH+B,CAAjC;AAKA,WAAKf,IAAL,CAAUgB,KAAV,GAAkBP,GAAG,CAACO,KAAJ,IAAaP,GAAG,CAACQ,SAAjB,IAA8B,WAAhD;AACA,WAAKjB,IAAL,CAAUkB,OAAV,GAAoBT,GAAG,CAACS,OAAJ,IAAe,GAAnC;AACA,WAAKlB,IAAL,CAAUmB,IAAV,GAAkBV,GAAG,CAACU,IAAJ,KAAaC,SAAb,GAAyBX,GAAG,CAACU,IAA7B,GAAoC,KAAtD;AACA,WAAKnB,IAAL,CAAUqB,MAAV,GAAmBZ,GAAG,CAACS,OAAJ,IAAe,GAAlC;AACA,WAAKlB,IAAL,CAAUsB,OAAV,GAAoBb,GAAG,CAACa,OAAJ,IAAe,EAAnC;AACA,WAAKtB,IAAL,CAAUuB,UAAV,GAAwBd,GAAG,CAACc,UAAJ,KAAmBH,SAAnB,GAA+BX,GAAG,CAACc,UAAnC,GAAgD,KAAxE;AACA,WAAKvB,IAAL,CAAUwB,MAAV,GAAmBf,GAAG,CAACe,MAAJ,IAAc,KAAjC;AACA,WAAKxB,IAAL,CAAUyB,WAAV,GAAwBhB,GAAG,CAACgB,WAAJ,IAAmB,SAA3C;AACA,WAAKzB,IAAL,CAAU0B,WAAV,GAAwBjB,GAAG,CAACiB,WAAJ,IAAmB,MAA3C;AACA,WAAK1B,IAAL,CAAUD,OAAV,GAAoBU,GAAG,CAACV,OAAJ,IAAe,KAAKC,IAAL,CAAUD,OAA7C;AACA,WAAKC,IAAL,CAAU2B,UAAV,GAAuBlB,GAAG,CAACkB,UAAJ,IAAkB,qBAAzC;AACA,WAAK3B,IAAL,CAAU4B,UAAV,GAAuBnB,GAAG,CAACmB,UAAJ,IAAkB,EAAzC;AACA,WAAK5B,IAAL,CAAU6B,MAAV,GAAoBpB,GAAG,CAACoB,MAAJ,KAAeT,SAAf,GAA2BX,GAAG,CAACoB,MAA/B,GAAwC,KAA5D;AACA,WAAK7B,IAAL,CAAU8B,WAAV,GAAyBrB,GAAG,CAACqB,WAAJ,KAAoBV,SAApB,GAAgCX,GAAG,CAACqB,WAApC,GAAkD,KAA3E;AACA,UAAIC,IAAI,GAAG,EAAX,CAzBU,CA2BV;;AACA,WAAK/B,IAAL,CAAUgC,SAAV,GAAsBvB,GAAG,CAACuB,SAAJ,IAAiB,IAAvC;AACA,WAAKhC,IAAL,CAAUiC,SAAV,GAAsB,EAAtB,CA7BU,CA8BV;;AACAF,MAAAA,IAAI,GAAG,EAAP;AACA,UAAItB,GAAG,CAACR,SAAJ,KAAkBmB,SAAlB,IAA+BX,GAAG,CAACR,SAAJ,KAAkB,IAAjD,IAAyDQ,GAAG,CAACR,SAAJ,CAAciC,MAAd,GAAuB,CAApF,EAAuFH,IAAI,GAAGtB,GAAG,CAACR,SAAX,CAAvF,KACK8B,IAAI,GAAGtB,GAAG,CAACwB,SAAX;;AAEL,UAAIF,IAAI,KAAKX,SAAT,IAAsBW,IAAI,KAAK,IAA/B,IAAuCA,IAAI,CAACG,MAAL,GAAc,CAAzD,EAA4D;AAC1DH,QAAAA,IAAI,CAACI,OAAL,CAAa,UAACC,GAAD,EAAS;AACpB,cAAMC,OAAO,GAAG,EAAhB;AACA,cAAMC,EAAE,GAAG,IAAIC,QAAJ,CAAaH,GAAG,CAACrC,OAAjB,EAA0BsC,OAA1B,CAAX;AACAC,UAAAA,EAAE,CAAChC,MAAH,CAAU8B,GAAV;;AACA,UAAA,KAAI,CAACnC,SAAL,CAAeuC,IAAf,CAAoBF,EAApB;;AACA,UAAA,KAAI,CAACtC,IAAL,CAAUiC,SAAV,CAAoBO,IAApB,CAAyBH,OAAzB;AACD,SAND;AAOD,OA3CS,CA6CV;;;AACA,WAAKrC,IAAL,CAAUyC,QAAV,GAAqBhC,GAAG,CAACgC,QAAJ,IAAgB,IAArC;AACA,WAAKzC,IAAL,CAAU0C,QAAV,GAAqB,EAArB,CA/CU,CAgDV;;AACAX,MAAAA,IAAI,GAAG,EAAP;AACA,UAAItB,GAAG,CAACR,SAAJ,KAAkBmB,SAAlB,IAA+BX,GAAG,CAACR,SAAJ,KAAkB,IAAjD,IAAyDQ,GAAG,CAACR,SAAJ,CAAciC,MAAd,GAAuB,CAApF,EAAuFH,IAAI,GAAGtB,GAAG,CAACP,QAAX,CAAvF,KACK6B,IAAI,GAAGtB,GAAG,CAACiC,QAAX;;AACL,UAAIX,IAAI,KAAKX,SAAT,IAAsBW,IAAI,IAAI,IAA9B,IAAsCA,IAAI,CAACG,MAAL,GAAc,CAAxD,EAA2D;AACzDH,QAAAA,IAAI,CAACI,OAAL,CAAa,UAACC,GAAD,EAAS;AACpB,cAAMC,OAAO,GAAG,EAAhB;AACA,cAAMM,EAAE,GAAG,IAAIC,OAAJ,CAAYR,GAAG,CAACrC,OAAhB,EAAyBsC,OAAzB,CAAX;AACAM,UAAAA,EAAE,CAACrC,MAAH,CAAU8B,GAAV;;AACA,UAAA,KAAI,CAAClC,QAAL,CAAcsC,IAAd,CAAmBG,EAAnB;;AACA,UAAA,KAAI,CAAC3C,IAAL,CAAU0C,QAAV,CAAmBF,IAAnB,CAAwBH,OAAxB;AACD,SAND;AAOD,OA5DS,CA8DV;;;AACA,WAAKrC,IAAL,CAAU6C,QAAV,GAAqBpC,GAAG,CAACoC,QAAJ,IAAgB,IAArC;AACA,WAAK7C,IAAL,CAAU8C,QAAV,GAAqB,EAArB;;AACA,UAAIrC,GAAG,CAACqC,QAAJ,KAAiB1B,SAAjB,IAA8BX,GAAG,CAACqC,QAAJ,IAAgB,IAA9C,IAAsDrC,GAAG,CAACqC,QAAJ,CAAaZ,MAAb,GAAsB,CAAhF,EAAmF;AACjFzB,QAAAA,GAAG,CAACqC,QAAJ,CAAaX,OAAb,CAAqB,UAACC,GAAD,EAAS;AAC5B,cAAMC,OAAO,GAAG,EAAhB;AACA,cAAMU,EAAE,GAAG,IAAIC,OAAJ,CAAYZ,GAAG,CAACrC,OAAhB,EAAyBsC,OAAzB,CAAX;AACAU,UAAAA,EAAE,CAACzC,MAAH,CAAU8B,GAAV;;AACA,UAAA,KAAI,CAACjC,QAAL,CAAcqC,IAAd,CAAmBO,EAAnB;;AACA,UAAA,KAAI,CAAC/C,IAAL,CAAU8C,QAAV,CAAmBN,IAAnB,CAAwBH,OAAxB;AACD,SAND;AAOD;;AAED,WAAKrC,IAAL,CAAUiD,WAAV,GAAwBxC,GAAG,CAACwC,WAAJ,IAAmB,CAA3C,CA3EU,CA6EV;;AACA,WAAKjD,IAAL,CAAUkD,SAAV,GAAsB,EAAtB;;AACA,UAAIzC,GAAG,CAACyC,SAAJ,KAAkB9B,SAAlB,IAA+BX,GAAG,CAACyC,SAAJ,IAAiB,IAAhD,IAAwDzC,GAAG,CAACyC,SAAJ,CAAchB,MAAd,GAAuB,CAAnF,EAAsF;AACpFzB,QAAAA,GAAG,CAACyC,SAAJ,CAAcf,OAAd,CAAsB,UAACC,GAAD,EAAS;AAC7B,cAAMC,OAAO,GAAG,EAAhB;AACA,cAAMc,EAAE,GAAG,IAAIC,QAAJ,CAAahB,GAAG,CAACiB,KAAjB,EAAwBjB,GAAG,CAACkB,IAA5B,EAAkCjB,OAAlC,CAAX;AACAc,UAAAA,EAAE,CAAC7C,MAAH,CAAU8B,GAAV;;AACA,UAAA,KAAI,CAAChC,SAAL,CAAeoC,IAAf,CAAoBW,EAApB;;AACA,UAAA,KAAI,CAACnD,IAAL,CAAUkD,SAAV,CAAoBV,IAApB,CAAyBH,OAAzB;AACD,SAND;AAOD,OAvFS,CAyFV;;;AACA,WAAKrC,IAAL,CAAUuD,SAAV,GAAsB,EAAtB;;AACA,UAAI9C,GAAG,CAAC8C,SAAJ,KAAkBnC,SAAlB,IAA+BX,GAAG,CAAC8C,SAAJ,IAAiB,IAAhD,IAAwD9C,GAAG,CAAC8C,SAAJ,CAAcrB,MAAd,GAAuB,CAAnF,EAAsF;AACpFzB,QAAAA,GAAG,CAAC8C,SAAJ,CAAcpB,OAAd,CAAsB,UAACC,GAAD,EAAS;AAC7B,cAAMC,OAAO,GAAG,EAAhB;AACA,cAAMmB,EAAE,GAAG,IAAIC,QAAJ,CAAarB,GAAG,CAACsB,IAAjB,EAAuBtB,GAAG,CAACuB,EAA3B,EAA+BvB,GAAG,CAACkB,IAAnC,EAAyCjB,OAAzC,CAAX;;AACA,UAAA,KAAI,CAAChC,SAAL,CAAemC,IAAf,CAAoBgB,EAApB;;AACA,UAAA,KAAI,CAACxD,IAAL,CAAUuD,SAAV,CAAoBf,IAApB,CAAyBH,OAAzB;AACD,SALD;AAMD;;AAED,WAAKrC,IAAL,CAAU4D,QAAV,GAAqBnD,GAAG,CAACmD,QAAJ,IAAgB,KAArC;AACD;;;uCAEkB;AACjB,UAAMC,GAAG,GAAG,KAAK7D,IAAL,CAAUe,MAAtB;AACA,UAAM+C,IAAI,GAAGD,GAAG,CAAC,CAAD,CAAhB;AACAA,MAAAA,GAAG,CAAC,CAAD,CAAH,GAASA,GAAG,CAAC,CAAD,CAAZ;AACAA,MAAAA,GAAG,CAAC,CAAD,CAAH,GAASC,IAAT;AACA,UAAI,KAAK9D,IAAL,CAAU6B,MAAd,EAAsB,KAAK7B,IAAL,CAAU6B,MAAV,GAAmB,KAAnB,CAAtB,KACK,KAAK7B,IAAL,CAAU6B,MAAV,GAAmB,IAAnB;AACN,K,CAED;AACA;AACA;;;;+BACWwB,K,EAAO;AAChB,UAAI,KAAKrD,IAAL,CAAUkB,OAAV,KAAsB,GAA1B,EAA+B,OAAO,IAAP;AAC/B,UAAI,KAAKlB,IAAL,CAAUkB,OAAV,KAAsB,IAAtB,IAA8B,KAAK6C,iBAAL,CAAuBV,KAAvB,KAAiC,CAAnE,EAAsE,OAAO,IAAP;AACtE,aAAO,KAAP;AACD;;;+BAEUA,K,EAAO;AAChB,UAAI,KAAKrD,IAAL,CAAUwB,MAAV,KAAqB,KAArB,IAA8B6B,KAAK,KAAKjC,SAA5C,EAAuD,OAAO,IAAP;AACvD,UAAI,KAAKpB,IAAL,CAAUwB,MAAV,KAAqB,KAArB,IAA8B6B,KAAK,KAAKjC,SAA5C,EAAuD,OAAO,KAAP;AACvD,UAAI,KAAKpB,IAAL,CAAUwB,MAAV,KAAqB,GAAzB,EAA8B,OAAO,KAAP;AAC9B,UAAI,KAAKxB,IAAL,CAAUwB,MAAV,KAAqB,IAArB,IAA6B,KAAKuC,iBAAL,CAAuBV,KAAvB,KAAiC,CAAlE,EAAqE,OAAO,IAAP;AACrE,UAAI,KAAKrD,IAAL,CAAUwB,MAAV,KAAqB,IAArB,IAA6B,KAAKuC,iBAAL,CAAuBV,KAAvB,KAAiC,CAAlE,EAAqE,OAAO,IAAP;AACrE,aAAO,KAAP;AACD;;;8BAESA,K,EAAO;AACf,UAAI,KAAKrD,IAAL,CAAU8B,WAAV,KAA0B,KAA9B,EAAqC,OAAO,KAAP;AACrC,UAAI,KAAK9B,IAAL,CAAU8B,WAAV,KAA0B,IAA1B,IAAkC,KAAKiC,iBAAL,CAAuBV,KAAvB,KAAiC,CAAvE,EAA0E,OAAO,IAAP;AAC1E,aAAO,KAAP;AACD;;;+BAEUA,K,EAAO;AAChB,UAAI,KAAKrD,IAAL,CAAUmB,IAAV,KAAmB,KAAvB,EAA8B,OAAO,KAAP;AAC9B,UAAI,KAAKnB,IAAL,CAAUqB,MAAV,KAAqB,GAAzB,EAA8B,OAAO,IAAP;AAC9B,UAAI,KAAKrB,IAAL,CAAUqB,MAAV,KAAqB,IAArB,IAA6B,KAAK0C,iBAAL,CAAuBV,KAAvB,KAAiC,CAAlE,EAAqE,OAAO,IAAP;AACrE,aAAO,KAAP;AACD,K,CAGD;AACA;AACA;;;;+BACWW,K,EAAO;AAChB,UAAI,KAAKhE,IAAL,CAAUD,OAAV,KAAsB,IAAtB,IAA8B,KAAKC,IAAL,CAAUD,OAAV,KAAsBqB,SAAxD,EAAmE,OAAO,KAAP;AACnE,aAAO6C,CAAC,CAACC,WAAF,CAAcF,KAAK,CAACpD,KAApB,EAA2B,KAAKZ,IAAL,CAAUD,OAArC,CAAP;AACD,K,CAED;AACA;AACA;;;;gCACYA,O,EAAS;AACnB,UAAMC,IAAI,GAAG,EAAb;AACA,UAAMmE,CAAC,GAAG,IAAI5B,QAAJ,CAAaxC,OAAb,EAAsBC,IAAtB,CAAV;AACAmE,MAAAA,CAAC,CAAC7D,MAAF,CAASN,IAAT;AACA,WAAKC,SAAL,CAAeuC,IAAf,CAAoB2B,CAApB;AACA,WAAKnE,IAAL,CAAUiC,SAAV,CAAoBO,IAApB,CAAyBxC,IAAzB;AACD;;;mCAEcoE,K,EAAO;AACpB,WAAKpE,IAAL,CAAUiC,SAAV,CAAoBoC,MAApB,CAA2BD,KAA3B,EAAkC,CAAlC;AACA,WAAKnE,SAAL,CAAeoE,MAAf,CAAsBD,KAAtB,EAA6B,CAA7B;AACD;;;gCAEWA,K,EAAO;AACjB,aAAO,KAAKnE,SAAL,CAAemE,KAAf,CAAP;AACD;;;mCAEc;AACb,aAAO,KAAKnE,SAAZ;AACD;;;+BAEUF,O,EAAS;AAClB,UAAIuE,KAAK,GAAG,KAAZ;AACA,WAAKrE,SAAL,CAAekC,OAAf,CAAuB,UAACoC,OAAD,EAAa;AAClC,YAAIA,OAAO,CAACC,KAAR,CAAczE,OAAd,CAAJ,EAA4BuE,KAAK,GAAG,IAAR;AAC7B,OAFD;AAGA,aAAOA,KAAP;AACD,K,CAED;AACA;AACA;;;;+BACWvE,O,EAAS;AAClB,UAAMC,IAAI,GAAG,EAAb;AACA,UAAMmE,CAAC,GAAG,IAAIvB,OAAJ,CAAY7C,OAAZ,EAAqBC,IAArB,CAAV;AACAmE,MAAAA,CAAC,CAAC7D,MAAF,CAASN,IAAT;AACA,WAAKE,QAAL,CAAcsC,IAAd,CAAmB2B,CAAnB;AACA,WAAKnE,IAAL,CAAU0C,QAAV,CAAmBF,IAAnB,CAAwBxC,IAAxB;AACD;;;kCAEaoE,K,EAAO;AACnB,WAAKpE,IAAL,CAAU0C,QAAV,CAAmB2B,MAAnB,CAA0BD,KAA1B,EAAiC,CAAjC;AACA,WAAKlE,QAAL,CAAcmE,MAAd,CAAqBD,KAArB,EAA4B,CAA5B;AACD;;;+BAEUA,K,EAAO;AAChB,aAAO,KAAKlE,QAAL,CAAckE,KAAd,CAAP;AACD;;;kCAEa;AACZ,aAAO,KAAKlE,QAAZ;AACD;;;8BAESH,O,EAAS;AACjB,UAAIuE,KAAK,GAAG,KAAZ;AACA,WAAKpE,QAAL,CAAciC,OAAd,CAAsB,UAACoC,OAAD,EAAa;AACjC,YAAIA,OAAO,CAACC,KAAR,CAAczE,OAAd,CAAJ,EAA4BuE,KAAK,GAAG,IAAR;AAC7B,OAFD;AAGA,aAAOA,KAAP;AACD,K,CAED;AACA;AACA;;;;+BACWvE,O,EAAS;AAClBkE,MAAAA,CAAC,CAACQ,GAAF,CAAM,CAAN,EAAS,mBAAT;AACA,UAAMzE,IAAI,GAAG,EAAb;AACA,UAAMmE,CAAC,GAAG,IAAInB,OAAJ,CAAYjD,OAAZ,EAAqBC,IAArB,CAAV;AACAmE,MAAAA,CAAC,CAAC7D,MAAF,CAASN,IAAT;AACA,WAAKG,QAAL,CAAcqC,IAAd,CAAmB2B,CAAnB;AACA,WAAKnE,IAAL,CAAU8C,QAAV,CAAmBN,IAAnB,CAAwBxC,IAAxB;AACD;;;kCAEaoE,K,EAAO;AACnB,WAAKpE,IAAL,CAAU8C,QAAV,CAAmBuB,MAAnB,CAA0BD,KAA1B,EAAiC,CAAjC;AACA,WAAKjE,QAAL,CAAckE,MAAd,CAAqBD,KAArB,EAA4B,CAA5B;AACD;;;+BAEUA,K,EAAO;AAChB,aAAO,KAAKjE,QAAL,CAAciE,KAAd,CAAP;AACD;;;kCAEa;AACZ,aAAO,KAAKjE,QAAZ;AACD;;;8BAESJ,O,EAAS;AACjB,UAAIuE,KAAK,GAAG,KAAZ;AACA,WAAKnE,QAAL,CAAcgC,OAAd,CAAsB,UAACoC,OAAD,EAAa;AACjC,YAAIA,OAAO,CAACC,KAAR,CAAczE,OAAd,CAAJ,EAA4BuE,KAAK,GAAG,IAAR;AAC7B,OAFD;AAGA,aAAOA,KAAP;AACD,K,CAED;AACA;AACA;;;;gCACYjB,K,EAAOC,I,EAAM;AACvB,UAAMtD,IAAI,GAAG,EAAb;AACA,UAAMmE,CAAC,GAAG,IAAIf,QAAJ,CAAaC,KAAb,EAAoBC,IAApB,EAA0BtD,IAA1B,CAAV;AACAmE,MAAAA,CAAC,CAAC7D,MAAF,CAASN,IAAT;AACA,WAAKI,SAAL,CAAeoC,IAAf,CAAoB2B,CAApB;AACA,WAAKnE,IAAL,CAAUkD,SAAV,CAAoBV,IAApB,CAAyBxC,IAAzB;AACD;;;mCAEcoE,K,EAAO;AACpB,WAAKpE,IAAL,CAAUkD,SAAV,CAAoBmB,MAApB,CAA2BD,KAA3B,EAAkC,CAAlC;AACA,WAAKhE,SAAL,CAAeiE,MAAf,CAAsBD,KAAtB,EAA6B,CAA7B;AACD;;;gCAEWA,K,EAAO;AACjB,aAAO,KAAKhE,SAAL,CAAegE,KAAf,CAAP;AACD;;;mCAEc;AACb,aAAO,KAAKhE,SAAZ;AACD,K,CAED;AACA;AACA;;;;gCACYsD,I,EAAMC,E,EAAIL,I,EAAM;AAC1B,UAAMtD,IAAI,GAAG,EAAb;AACA,UAAMmE,CAAC,GAAG,IAAIV,QAAJ,CAAaC,IAAb,EAAmBC,EAAnB,EAAuBL,IAAvB,EAA6BtD,IAA7B,CAAV;AACA,WAAKK,SAAL,CAAemC,IAAf,CAAoB2B,CAApB;AACA,WAAKnE,IAAL,CAAUuD,SAAV,CAAoBf,IAApB,CAAyBxC,IAAzB;AACD;;;mCAEcoE,K,EAAO;AACpB,WAAKpE,IAAL,CAAUuD,SAAV,CAAoBc,MAApB,CAA2BD,KAA3B,EAAkC,CAAlC;AACA,WAAK/D,SAAL,CAAegE,MAAf,CAAsBD,KAAtB,EAA6B,CAA7B;AACD;;;gCAEWA,K,EAAO;AACjB,aAAO,KAAK/D,SAAL,CAAe+D,KAAf,CAAP;AACD;;;mCAEc;AACb,aAAO,KAAK/D,SAAZ;AACD;;;iCAEY+D,K,EAAO;AAClB,WAAK/D,SAAL,CAAe+D,KAAf,EAAsBM,IAAtB;AACD;;;iCAEYN,K,EAAO;AAClB,WAAK/D,SAAL,CAAe+D,KAAf,EAAsBO,IAAtB;AACD,K,CAED;AACA;AACA;;;;qCACiBtB,K,EAAO;AACtB,UAAI,CAAC,KAAKrD,IAAL,CAAU4B,UAAX,IAAyB,KAAK5B,IAAL,CAAU4B,UAAV,CAAqBM,MAArB,KAAgC,CAA7D,EAAgE;AAC9D,eAAO,IAAP;AACD;;AAED,WAAK,IAAI0C,CAAC,GAAG,KAAK5E,IAAL,CAAU4B,UAAV,CAAqBM,MAAlC,EAA0C0C,CAAC,GAAG,CAA9C,EAAiDA,CAAC,IAAI,CAAtD,EAAyD;AACvD,YAAIvB,KAAK,IAAI,KAAKrD,IAAL,CAAU4B,UAAV,CAAqBgD,CAAC,GAAG,CAAzB,CAAb,EAA0C;AACxC,iBAAO,KAAK5E,IAAL,CAAUe,MAAV,CAAiB6D,CAAjB,CAAP;AACD;AACF;;AACD,aAAOC,CAAC,CAACC,KAAF,CAAQ,KAAK9E,IAAL,CAAUe,MAAlB,CAAP;AACD;;;sCAEiBsC,K,EAAO;AACvB,UAAI0B,cAAc,GAAG,CAArB;AACA,UAAMnD,UAAU,GAAG,KAAK5B,IAAL,CAAU4B,UAA7B;AAEA,UAAIA,UAAU,KAAKR,SAAf,IAA4BQ,UAAU,CAACM,MAAX,KAAsB,CAAtD,EAAyD,OAAO,CAAC,CAAR;AACzD,UAAIN,UAAU,CAACM,MAAX,KAAsB,CAA1B,EAA6B,OAAO,CAAC,CAAR,CALN,CAOvB;;AACA,UAAI,CAAC,KAAKlC,IAAL,CAAU6B,MAAf,EAAuB;AACrBkD,QAAAA,cAAc,GAAG,CAAjB;AACA,YAAI1B,KAAK,IAAIzB,UAAU,CAAC,CAAD,CAAvB,EAA4BmD,cAAc,GAAG,CAAjB;AAC5B,YAAI1B,KAAK,IAAIzB,UAAU,CAAC,CAAD,CAAvB,EAA4BmD,cAAc,GAAG,CAAjB;AAC7B,OAJD,MAIO;AACLA,QAAAA,cAAc,GAAG,CAAjB;AACA,YAAI1B,KAAK,IAAIzB,UAAU,CAAC,CAAD,CAAvB,EAA4BmD,cAAc,GAAG,CAAjB;AAC5B,YAAI1B,KAAK,IAAIzB,UAAU,CAAC,CAAD,CAAvB,EAA4BmD,cAAc,GAAG,CAAjB;AAC7B;;AACD,aAAOA,cAAP;AACD;;;qCAEgBf,K,EAAO;AACtB,UAAI,KAAKgB,UAAL,CAAgBhB,KAAhB,CAAJ,EAA4B;AAC1B,YAAIX,KAAK,GAAGwB,CAAC,CAACI,GAAF,CAAMjB,KAAK,CAACkB,KAAZ,EAAmB,KAAKlF,IAAL,CAAUa,WAA7B,CAAZ;;AACA,YAAIwC,KAAK,KAAKjC,SAAV,IAAuBiC,KAAK,KAAK,IAArC,EAA2C;AACzCA,UAAAA,KAAK,GAAGW,KAAK,CAACmB,UAAN,CAAiBnB,KAAK,CAACmB,UAAN,CAAiBjD,MAAjB,GAA0B,CAA3C,EAA8C,CAA9C,CAAR;AACD;;AACD,eAAOmB,KAAP;AACD;;AACD,aAAO,GAAP;AACD;;;8CAEyBW,K,EAAO;AAC/B,UAAMoB,cAAc,GAAG,KAAKC,gBAAL,CAAsBrB,KAAtB,CAAvB;AACA,aAAO,KAAKsB,iBAAL,CAAuBF,cAAvB,CAAP;AACD;;;8BAES;AACR,UAAI,KAAKpF,IAAL,CAAUuB,UAAd,EAA0B,OAAO,KAAKvB,IAAL,CAAUsB,OAAV,GAAoBiE,MAAM,CAACC,QAAP,CAAgBC,MAA3C;AAC1B,aAAO,KAAKzF,IAAL,CAAUsB,OAAjB;AACD;;;sCAEiB+B,K,EAAO;AACvB;AACA,UAAI,KAAKrD,IAAL,CAAUW,IAAV,KAAmB,QAAvB,EAAiC;AAC/B,YAAI,CAACkE,CAAC,CAACa,QAAF,CAAWrC,KAAX,CAAL,EAAwB,OAAO,gBAAP;;AACxB,YAAIA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK,KAAK,CAArC,EAAwC;AACtC,iBAAO,GAAP;AACD;;AACD,YAAIvC,QAAQ,GAAG,KAAK6E,aAAL,CAAmBtC,KAAnB,CAAf;AACAvC,QAAAA,QAAQ,GACN,OAAO,KAAKd,IAAL,CAAUc,QAAjB,KAA8B,QAA9B,GAAyC8E,IAAI,CAACC,GAAL,CAAS,KAAK7F,IAAL,CAAUc,QAAnB,EAA6BA,QAA7B,CAAzC,GAAkFA,QADpF;AAEA,eAAOgF,WAAW,CAACzC,KAAD,EAAQ,KAAKrD,IAAL,CAAUU,IAAlB,EAAwB,KAAKV,IAAL,CAAUc,QAAlC,CAAlB;AACD;;AAED,UAAI,KAAKd,IAAL,CAAUW,IAAV,KAAmB,QAAvB,EAAiC;AAC/B,YAAIkE,CAAC,CAACkB,OAAF,CAAU1C,KAAV,CAAJ,EAAsB;AACpBA,UAAAA,KAAK,GAAGA,KAAK,CAAC2C,IAAN,CAAW,IAAX,CAAR;AACD;;AACD,YAAM/C,WAAW,GAAG,KAAKjD,IAAL,CAAUiD,WAAV,IAAyB,CAA7C;;AACA,YAAIA,WAAW,KAAK,CAAhB,IAAqB,KAAK7C,SAA9B,EAAyC;AACvC,eAAK,IAAIwE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKxE,SAAL,CAAe8B,MAAnC,EAA2C0C,CAAC,IAAI,CAAhD,EAAmD;AACjD,gBAAMxC,GAAG,GAAG,KAAKhC,SAAL,CAAewE,CAAf,CAAZ;AACA,gBAAIxC,GAAG,CAACoC,KAAJ,CAAUnB,KAAV,CAAJ,EAAsB,OAAOjB,GAAG,CAAC6D,gBAAJ,CAAqB5C,KAArB,CAAP;AACvB;;AACD,iBAAOA,KAAK,CAAC6C,QAAN,EAAP;AACD;;AAED,YAAIjD,WAAW,KAAK,CAAhB,IAAqB,KAAK5C,SAA9B,EAAyC;AACvC,eAAK,IAAIuE,EAAC,GAAG,CAAb,EAAgBA,EAAC,GAAG,KAAKvE,SAAL,CAAe6B,MAAnC,EAA2C0C,EAAC,IAAI,CAAhD,EAAmD;AACjD,gBAAMxC,IAAG,GAAG,KAAK/B,SAAL,CAAeuE,EAAf,CAAZ;AACA,gBAAIxC,IAAG,CAACoC,KAAJ,CAAUnB,KAAV,CAAJ,EAAsB,OAAOjB,IAAG,CAAC6D,gBAAJ,CAAqB5C,KAArB,CAAP;AACvB;;AACD,iBAAOA,KAAK,CAAC6C,QAAN,EAAP;AACD;;AAED,YAAI7C,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK,KAAK,CAArC,EAAwC;AACtC,iBAAO,GAAP;AACD;AACF;;AAED,UAAI,KAAKrD,IAAL,CAAUW,IAAV,KAAmB,MAAvB,EAA+B;AAC7B,YAAI0C,KAAK,KAAKjC,SAAV,IAAuBiC,KAAK,KAAK,IAArC,EAA2C;AACzC,iBAAO,GAAP;AACD;;AAED,YAAIwB,CAAC,CAACkB,OAAF,CAAU1C,KAAV,CAAJ,EAAsB;AACpBA,UAAAA,KAAK,GAAGA,KAAK,CAAC,CAAD,CAAb;AACD;;AACD,YAAM8C,IAAI,GAAG,qBAAO9C,KAAP,CAAb,CAR6B,CAS7B;AACA;AACA;;AACA,eAAO8C,IAAI,CAACC,MAAL,CAAY,KAAKpG,IAAL,CAAU2B,UAAtB,CAAP;AACD;;AAED,aAAO0B,KAAP;AACD;;;mCAEcC,I,EAAM+C,c,EAAgB;AACnC,UAAI,KAAKrG,IAAL,CAAUyB,WAAV,KAA0B,SAA9B,EAAyC,OAAO4E,cAAP;AACzC,UAAMC,QAAQ,GAAGrC,CAAC,CAACsC,eAAF,CAAkB,KAAKvG,IAAL,CAAU0B,WAA5B,CAAjB;AACA,UAAI4B,IAAI,CAAC4C,QAAL,GAAgB1B,KAAhB,CAAsB8B,QAAtB,CAAJ,EAAqC,OAAOhD,IAAI,CAAC4C,QAAL,GAAgBM,OAAhB,CAAwBF,QAAxB,EAAkCD,cAAlC,CAAP;AACrC,aAAO/C,IAAP;AACD;;;0CAEqBD,K,EAAO;AAC3B,UAAIA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK,KAAK,CAAjC,IAAsCA,KAAK,KAAKjC,SAApD,EAA+D;AAC7D,eAAO,EAAP;AACD;;AAED,UAAIyD,CAAC,CAACkB,OAAF,CAAU1C,KAAV,CAAJ,EAAsB;AACpBA,QAAAA,KAAK,GAAGA,KAAK,CAAC2C,IAAN,CAAW,IAAX,CAAR;AACD;;AAED,UAAI,KAAKpC,QAAT,EAAmB;AACjB,eAAO,KAAK6C,SAAL,CAAepD,KAAf,CAAP;AACD;;AACD,aAAOwB,CAAC,CAAC6B,MAAF,CAASrD,KAAT,CAAP;AACD;;;kCAEasD,G,EAAK;AACjB,UAAInC,KAAK,GAAG,CAAC,KAAKmC,GAAN,EAAWnC,KAAX,CAAiB,kCAAjB,CAAZ;;AACA,UAAI,CAACA,KAAL,EAAY;AACV,eAAO,CAAP;AACD;;AACD,aAAOoB,IAAI,CAACgB,GAAL,CACL,CADK,EAEL;AACA,OAACpC,KAAK,CAAC,CAAD,CAAL,GAAWA,KAAK,CAAC,CAAD,CAAL,CAAStC,MAApB,GAA6B,CAA9B,MACE;AACCsC,MAAAA,KAAK,CAAC,CAAD,CAAL,GAAW,CAACA,KAAK,CAAC,CAAD,CAAjB,GAAuB,CAF1B,CAHK,CAAP;AAOD;;;;KAIH;AACA;AACA;;;;;IACMjC,Q;;;AACJ,oBAAYxC,OAAZ,EAAqBC,IAArB,EAA2B;AAAA;;AACzB,SAAKA,IAAL,GAAYA,IAAZ;AACA,SAAK6G,EAAL,GAAU5C,CAAC,CAAC6C,QAAF,EAAV;AACA,SAAK9G,IAAL,CAAUD,OAAV,GAAoBqB,SAApB;AACA,SAAKpB,IAAL,CAAUD,OAAV,GAAoBA,OAApB;AACA,SAAKO,MAAL,CAAYN,IAAZ;AACD;;;;4BAEMS,G,EAAK;AACV,WAAKT,IAAL,CAAUD,OAAV,GAAoBU,GAAG,CAACV,OAAJ,IAAe,EAAnC;AACA,WAAKC,IAAL,CAAU+G,MAAV,GAAmBtG,GAAG,CAACsG,MAAJ,IAAc,KAAjC;AACD;;;0BAEKzD,I,EAAM;AACV,UAAIA,IAAI,KAAKlC,SAAT,IAAsBkC,IAAI,KAAK,IAA/B,IAAuCA,IAAI,CAACpB,MAAL,KAAgB,CAA3D,EAA8D,OAAO,KAAP;AAC9D,aAAO+B,CAAC,CAACC,WAAF,CAAcZ,IAAd,EAAoB,KAAKtD,IAAL,CAAUD,OAA9B,CAAP;AACD;;;4BAEO;AACN,aAAO,KAAK8G,EAAZ;AACD;;;2BAEM;AACL,WAAK7G,IAAL,CAAU+G,MAAV,GAAmB,KAAnB;AACD;;;2BAEM;AACL,WAAK/G,IAAL,CAAU+G,MAAV,GAAmB,IAAnB;AACD;;;+BAEU;AACT,aAAO,KAAK/G,IAAL,CAAU+G,MAAjB;AACD;;;8BAEQ;AACP,aAAO;AACLhH,QAAAA,OAAO,EAAE,KAAKC,IAAL,CAAUD,OADd;AAELgH,QAAAA,MAAM,EAAE,KAAK/G,IAAL,CAAU+G;AAFb,OAAP;AAID;;;+BAEU1D,K,EAAO;AAChB,UAAI,KAAKrD,IAAL,CAAU+G,MAAd,EAAsB,OAAO,KAAP;AACtB,aAAO,KAAKC,IAAL,CAAUC,UAAV,CAAqB5D,KAArB,CAAP;AACD;;;gCAEW;AACV,UAAI,KAAKrD,IAAL,CAAU+G,MAAd,EAAsB,OAAO,KAAP;AACtB,aAAO,IAAP;AACD;;;;KAGH;AACA;AACA;;;IACMnE,O;;;AACJ,mBAAY7C,OAAZ,EAAqBC,IAArB,EAA2B;AAAA;;AACzB,SAAKA,IAAL,GAAYA,IAAZ;AACA,SAAK6G,EAAL,GAAU5C,CAAC,CAAC6C,QAAF,EAAV;AACA,SAAK9G,IAAL,CAAUD,OAAV,GAAoBA,OAApB;AACA,SAAKO,MAAL,CAAYN,IAAZ;AACD;;;;4BAEMS,G,EAAK;AACV,WAAKT,IAAL,CAAUD,OAAV,GAAoBU,GAAG,CAACV,OAAJ,IAAe,KAAKC,IAAL,CAAUD,OAA7C;AACA,WAAKC,IAAL,CAAU+G,MAAV,GAAmBtG,GAAG,CAACsG,MAAJ,IAAc,KAAjC;AACD;;;0BAEKzD,I,EAAM;AACV,UAAIA,IAAI,KAAKlC,SAAT,IAAsBkC,IAAI,KAAK,IAA/B,IAAuCA,IAAI,CAACpB,MAAL,KAAgB,CAA3D,EAA8D,OAAO,KAAP;AAC9D,aAAO+B,CAAC,CAACC,WAAF,CAAcZ,IAAd,EAAoB,KAAKtD,IAAL,CAAUD,OAA9B,CAAP;AACD;;;4BAEO;AACN,aAAO,KAAK8G,EAAZ;AACD;;;2BAEM;AACL,WAAK7G,IAAL,CAAU+G,MAAV,GAAmB,KAAnB;AACD;;;2BAEM;AACL,WAAK/G,IAAL,CAAU+G,MAAV,GAAmB,IAAnB;AACD;;;+BAEU;AACT,aAAO,KAAK/G,IAAL,CAAU+G,MAAjB;AACD;;;8BAEQ;AACP,aAAO;AACLhH,QAAAA,OAAO,EAAE,KAAKC,IAAL,CAAUD,OADd;AAELgH,QAAAA,MAAM,EAAE,KAAK/G,IAAL,CAAU+G;AAFb,OAAP;AAID;;;;KAGH;AACA;AACA;;;IACM/D,O;;;AACJ,mBAAYjD,OAAZ,EAAqBC,IAArB,EAA2B;AAAA;;AACzB,SAAKA,IAAL,GAAYA,IAAZ;AACA,SAAK6G,EAAL,GAAU5C,CAAC,CAAC6C,QAAF,EAAV;AACA,SAAK9G,IAAL,CAAUD,OAAV,GAAoBA,OAApB;AACA,SAAKO,MAAL,CAAYN,IAAZ;AACD;;;;4BAEMS,G,EAAK;AACV,WAAKT,IAAL,CAAUD,OAAV,GAAoBU,GAAG,CAACV,OAAJ,IAAe,KAAKC,IAAL,CAAUD,OAAzB,IAAoC,EAAxD;AACA,WAAKC,IAAL,CAAU+G,MAAV,GAAmBtG,GAAG,CAACsG,MAAJ,IAAc,KAAjC;AACD;;;0BAEKzD,I,EAAM;AACV,UAAIA,IAAI,KAAKlC,SAAT,IAAsBkC,IAAI,KAAK,IAA/B,IAAuCA,IAAI,CAACpB,MAAL,KAAgB,CAA3D,EAA8D,OAAO,KAAP;AAC9D,aAAO+B,CAAC,CAACC,WAAF,CAAcZ,IAAd,EAAoB,KAAKtD,IAAL,CAAUD,OAA9B,CAAP;AACD;;;4BAEO;AACN,aAAO,KAAK8G,EAAZ;AACD;;;2BAEM;AACL,WAAK7G,IAAL,CAAU+G,MAAV,GAAmB,KAAnB;AACD;;;2BAEM;AACL,WAAK/G,IAAL,CAAU+G,MAAV,GAAmB,IAAnB;AACD;;;+BAEU;AACT,aAAO,KAAK/G,IAAL,CAAU+G,MAAjB;AACD;;;8BAEQ;AACP,aAAO;AACLhH,QAAAA,OAAO,EAAE,KAAKC,IAAL,CAAUD,OADd;AAELgH,QAAAA,MAAM,EAAE,KAAK/G,IAAL,CAAU+G;AAFb,OAAP;AAID;;;;KAGH;AACA;AACA;;;IACMtD,Q;;;AACJ,oBAAYC,IAAZ,EAAkBC,EAAlB,EAAsBL,IAAtB,EAA4BtD,IAA5B,EAAkC;AAAA;;AAChC,SAAKA,IAAL,GAAYA,IAAZ;AACA,SAAK6G,EAAL,GAAU5C,CAAC,CAAC6C,QAAF,EAAV;AACA,SAAK9G,IAAL,CAAU0D,IAAV,GAAiBA,IAAjB;AACA,SAAK1D,IAAL,CAAU2D,EAAV,GAAeA,EAAf;AACA,SAAK3D,IAAL,CAAUsD,IAAV,GAAiBA,IAAjB;AACA,SAAKtD,IAAL,CAAU+G,MAAV,GAAmB,KAAnB;AACA,SAAKzG,MAAL,CAAYN,IAAZ;AACD;;;;4BAEMS,G,EAAK;AACV,WAAKT,IAAL,CAAU0D,IAAV,GAAiBjD,GAAG,CAACiD,IAAJ,IAAY,KAAK1D,IAAL,CAAU0D,IAAtB,IAA8B,EAA/C;AACA,WAAK1D,IAAL,CAAU2D,EAAV,GAAelD,GAAG,CAACkD,EAAJ,IAAU,KAAK3D,IAAL,CAAU2D,EAApB,IAA0B,EAAzC;AACA,WAAK3D,IAAL,CAAUsD,IAAV,GAAiB7C,GAAG,CAAC6C,IAAJ,IAAY,KAAKtD,IAAL,CAAUsD,IAAtB,IAA8B,EAA/C;AACA,WAAKtD,IAAL,CAAU+G,MAAV,GAAmBtG,GAAG,CAACsG,MAAJ,IAAc,KAAK/G,IAAL,CAAU+G,MAAxB,IAAkC,KAArD;AACD;;;0BAEK1D,K,EAAO;AACX,UAAI,KAAKrD,IAAL,CAAU0D,IAAV,KAAmB,MAAnB,IAA6B,KAAK1D,IAAL,CAAU2D,EAAV,KAAiB,MAAlD,EAA0D;AACxD,eAAO,IAAP;AACD;;AACD,UAAIN,KAAK,KAAK,IAAd,EAAoB;AAClB,YAAI,KAAKrD,IAAL,CAAU0D,IAAV,KAAmB,MAAnB,IAA6B,KAAK1D,IAAL,CAAU2D,EAAV,KAAiB,MAAlD,EAA0D;AACxD,iBAAO,IAAP;AACD;AACF;;AACD,UAAIuD,MAAM,CAAC,KAAKlH,IAAL,CAAU0D,IAAX,CAAN,IAA0BwD,MAAM,CAAC7D,KAAD,CAAhC,IAA2C6D,MAAM,CAAC,KAAKlH,IAAL,CAAU2D,EAAX,CAAN,IAAwBuD,MAAM,CAAC7D,KAAD,CAA7E,EAAsF;AACpF,eAAO,IAAP;AACD;;AACD,aAAO,KAAP;AACD;;;4BAEO;AACN,aAAO,KAAKwD,EAAZ;AACD;;;qCAEgBxD,K,EAAO;AACtB,UAAIA,KAAK,KAAK,IAAd,EAAoB;AAClB,YAAI,KAAKrD,IAAL,CAAU0D,IAAV,KAAmB,MAAnB,IAA6B,KAAK1D,IAAL,CAAU2D,EAAV,KAAiB,MAAlD,EAA0D;AACxD,iBAAO,KAAK3D,IAAL,CAAUsD,IAAjB;AACD;AACF;;AACD,UAAI,KAAKkB,KAAL,CAAWnB,KAAX,CAAJ,EAAuB;AACrB,eAAO,KAAKrD,IAAL,CAAUsD,IAAjB;AACD;;AACD,aAAOD,KAAP;AACD;;;2BAEM;AACL,WAAKrD,IAAL,CAAU+G,MAAV,GAAmB,KAAnB;AACD;;;2BAEM;AACL,WAAK/G,IAAL,CAAU+G,MAAV,GAAmB,IAAnB;AACD;;;+BAEU;AACT,aAAO,KAAK/G,IAAL,CAAU+G,MAAjB;AACD;;;8BAEQ;AACP,aAAO;AACLrD,QAAAA,IAAI,EAAE,KAAK1D,IAAL,CAAU0D,IADX;AAELC,QAAAA,EAAE,EAAE,KAAK3D,IAAL,CAAU2D,EAFT;AAGLL,QAAAA,IAAI,EAAE,KAAKtD,IAAL,CAAUsD,IAHX;AAILyD,QAAAA,MAAM,EAAE,KAAK/G,IAAL,CAAU+G;AAJb,OAAP;AAMD;;;;KAGH;AACA;AACA;;;IACM3D,Q;;;AACJ,oBAAYC,KAAZ,EAAmBC,IAAnB,EAAyBtD,IAAzB,EAA+B;AAAA;;AAC7B,SAAKA,IAAL,GAAYA,IAAZ;AACA,SAAK6G,EAAL,GAAU5C,CAAC,CAAC6C,QAAF,EAAV;AACA,SAAK9G,IAAL,CAAUqD,KAAV,GAAkBA,KAAlB;AACA,SAAKrD,IAAL,CAAUsD,IAAV,GAAiBA,IAAjB;AACA,SAAKtD,IAAL,CAAU+G,MAAV,GAAmB,KAAnB;AACA,SAAKzG,MAAL,CAAYN,IAAZ;AACD;;;;4BAEMS,G,EAAK;AACV,WAAKT,IAAL,CAAUqD,KAAV,GAAkB5C,GAAG,CAAC4C,KAAJ,IAAa,KAAKrD,IAAL,CAAUqD,KAAvB,IAAgC,EAAlD;AACA,WAAKrD,IAAL,CAAUsD,IAAV,GAAiB7C,GAAG,CAAC6C,IAAJ,IAAY,KAAKtD,IAAL,CAAUsD,IAAtB,IAA8B,EAA/C;AACA,WAAKtD,IAAL,CAAU+G,MAAV,GAAmBtG,GAAG,CAACsG,MAAJ,IAAc,KAAK/G,IAAL,CAAU+G,MAAxB,IAAkC,KAArD;AACD;;;0BAEK1D,K,EAAO;AACX,UAAIA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAKjC,SAAhC,EAA2C;AACzC,YAAI,KAAKpB,IAAL,CAAUqD,KAAV,KAAoB,MAAxB,EAAgC;AAC9B,iBAAO,IAAP;AACD;;AACD,eAAO,KAAP;AACD;;AAED,UAAI,CAACwB,CAAC,CAACsC,QAAF,CAAW9D,KAAX,CAAD,IAAsB6D,MAAM,CAAC,KAAKlH,IAAL,CAAUqD,KAAX,CAAN,KAA4B6D,MAAM,CAAC7D,KAAD,CAA5D,EAAqE;AACnE,eAAO,IAAP;AACD;;AAED,aAAOY,CAAC,CAACC,WAAF,CAAcb,KAAK,CAAC6C,QAAN,EAAd,EAAgC,KAAKlG,IAAL,CAAUqD,KAA1C,CAAP;AACD;;;4BAEO;AACN,aAAO,KAAKwD,EAAZ;AACD;;;qCAEgBxD,K,EAAO;AACtB,UAAIA,KAAK,KAAK,IAAd,EAAoB;AAClB,YAAI,KAAKrD,IAAL,CAAUqD,KAAV,KAAoB,MAAxB,EAAgC;AAC9B,iBAAO,KAAKrD,IAAL,CAAUsD,IAAjB;AACD;AACF;;AACD,UAAI,KAAKkB,KAAL,CAAWnB,KAAX,CAAJ,EAAuB;AACrB,eAAO,KAAKrD,IAAL,CAAUsD,IAAjB;AACD;;AACD,aAAOD,KAAP;AACD;;;2BAEM;AACL,WAAKrD,IAAL,CAAU+G,MAAV,GAAmB,KAAnB;AACD;;;2BAEM;AACL,WAAK/G,IAAL,CAAU+G,MAAV,GAAmB,IAAnB;AACD;;;+BAEU;AACT,aAAO,KAAK/G,IAAL,CAAU+G,MAAjB;AACD;;;8BAEQ;AACP,aAAO;AACL1D,QAAAA,KAAK,EAAE,KAAKrD,IAAL,CAAUqD,KADZ;AAELC,QAAAA,IAAI,EAAE,KAAKtD,IAAL,CAAUsD,IAFX;AAGLyD,QAAAA,MAAM,EAAE,KAAK/G,IAAL,CAAU+G;AAHb,OAAP;AAKD;;;;;;AAGH,SAASjB,WAAT,CAAqBzC,KAArB,EAA4B3C,IAA5B,EAAkCI,QAAlC,EAA4C;AAC1C,SAAOsG,aAAIC,YAAJ,CAAiB3G,IAAjB,EAAuB2C,KAAvB,EAA8BvC,QAA9B,EAAwC,IAAxC,EAA8CoF,QAA9C,EAAP;AACD","sourcesContent":["/* eslint-disable no-use-before-define */\n// eslint-disable-next-line import/no-unresolved\nimport kbn from 'app/core/utils/kbn';\n// eslint-disable-next-line import/no-extraneous-dependencies\nimport moment from 'moment';\n\nexport default class Rule {\n  /** @ngInject */\n  constructor(pattern, data) {\n    this.data = data;\n    this.data.pattern = pattern;\n    this.shapeMaps = [];\n    this.textMaps = [];\n    this.linkMaps = [];\n    this.valueMaps = [];\n    this.rangeMaps = [];\n    this.import(data);\n  }\n\n  getData() {\n    return this.data;\n  }\n\n  export() {\n    return JSON.stringify(this);\n  }\n\n  import(obj) {\n    this.data.unit = obj.unit || 'short';\n    this.data.type = obj.type || 'number';\n    this.data.alias = obj.alias || 'No name';\n    this.data.aggregation = obj.aggregation || 'current';\n    this.data.decimals = obj.decimals || 2;\n    this.data.colors = obj.colors || [\n      'rgba(245, 54, 54, 0.9)',\n      'rgba(237, 129, 40, 0.89)',\n      'rgba(50, 172, 45, 0.97)',\n    ];\n    this.data.style = obj.style || obj.colorMode || 'fillColor';\n    this.data.colorOn = obj.colorOn || 'a';\n    this.data.link = (obj.link !== undefined ? obj.link : false);\n    this.data.linkOn = obj.colorOn || 'a';\n    this.data.linkUrl = obj.linkUrl || '';\n    this.data.linkParams = (obj.linkParams !== undefined ? obj.linkParams : false);\n    this.data.textOn = obj.textOn || 'wmd';\n    this.data.textReplace = obj.textReplace || 'content';\n    this.data.textPattern = obj.textPattern || '/.*/';\n    this.data.pattern = obj.pattern || this.data.pattern;\n    this.data.dateFormat = obj.dateFormat || 'YYYY-MM-DD HH:mm:ss';\n    this.data.thresholds = obj.thresholds || [];\n    this.data.invert = (obj.invert !== undefined ? obj.invert : false);\n    this.data.overlayIcon = (obj.overlayIcon !== undefined ? obj.overlayIcon : false);\n    let maps = [];\n\n    // SHAPES\n    this.data.shapeProp = obj.shapeProp || 'id';\n    this.data.shapeData = [];\n    // For 0.2.0\n    maps = [];\n    if (obj.shapeMaps !== undefined && obj.shapeMaps !== null && obj.shapeMaps.length > 0) maps = obj.shapeMaps;\n    else maps = obj.shapeData;\n\n    if (maps !== undefined && maps !== null && maps.length > 0) {\n      maps.forEach((map) => {\n        const newData = {};\n        const sm = new ShapeMap(map.pattern, newData);\n        sm.import(map);\n        this.shapeMaps.push(sm);\n        this.data.shapeData.push(newData);\n      });\n    }\n\n    // TEXT\n    this.data.textProp = obj.textProp || 'id';\n    this.data.textData = [];\n    // For 0.2.0\n    maps = [];\n    if (obj.shapeMaps !== undefined && obj.shapeMaps !== null && obj.shapeMaps.length > 0) maps = obj.textMaps;\n    else maps = obj.textData;\n    if (maps !== undefined && maps != null && maps.length > 0) {\n      maps.forEach((map) => {\n        const newData = {};\n        const tm = new TextMap(map.pattern, newData);\n        tm.import(map);\n        this.textMaps.push(tm);\n        this.data.textData.push(newData);\n      });\n    }\n\n    // LINK\n    this.data.linkProp = obj.linkProp || 'id';\n    this.data.linkData = [];\n    if (obj.linkData !== undefined && obj.linkData != null && obj.linkData.length > 0) {\n      obj.linkData.forEach((map) => {\n        const newData = {};\n        const lm = new LinkMap(map.pattern, newData);\n        lm.import(map);\n        this.linkMaps.push(lm);\n        this.data.linkData.push(newData);\n      });\n    }\n\n    this.data.mappingType = obj.mappingType || 1;\n\n    // VALUES\n    this.data.valueData = [];\n    if (obj.valueData !== undefined && obj.valueData != null && obj.valueData.length > 0) {\n      obj.valueData.forEach((map) => {\n        const newData = {};\n        const vm = new ValueMap(map.value, map.text, newData);\n        vm.import(map);\n        this.valueMaps.push(vm);\n        this.data.valueData.push(newData);\n      });\n    }\n\n    // RANGE\n    this.data.rangeData = [];\n    if (obj.rangeData !== undefined && obj.rangeData != null && obj.rangeData.length > 0) {\n      obj.rangeData.forEach((map) => {\n        const newData = {};\n        const rm = new RangeMap(map.from, map.to, map.text, newData);\n        this.rangeMaps.push(rm);\n        this.data.rangeData.push(newData);\n      });\n    }\n\n    this.data.sanitize = obj.sanitize || false;\n  }\n\n  invertColorOrder() {\n    const ref = this.data.colors;\n    const copy = ref[0];\n    ref[0] = ref[2];\n    ref[2] = copy;\n    if (this.data.invert) this.data.invert = false;\n    else this.data.invert = true;\n  }\n\n  //\n  // Conditions\n  //\n  toColorize(value) {\n    if (this.data.colorOn === 'a') return true;\n    if (this.data.colorOn === 'wc' && this.getThresholdLevel(value) >= 1) return true;\n    return false;\n  }\n\n  toValorize(value) {\n    if (this.data.textOn === 'wmd' && value !== undefined) return true;\n    if (this.data.textOn === 'wmd' && value === undefined) return false;\n    if (this.data.textOn === 'n') return false;\n    if (this.data.textOn === 'wc' && this.getThresholdLevel(value) >= 1) return true;\n    if (this.data.textOn === 'co' && this.getThresholdLevel(value) >= 2) return true;\n    return false;\n  }\n\n  toIconize(value) {\n    if (this.data.overlayIcon === false) return false;\n    if (this.data.overlayIcon === true && this.getThresholdLevel(value) >= 1) return true;\n    return false;\n  }\n\n  toLinkable(value) {\n    if (this.data.link === false) return false;\n    if (this.data.linkOn === 'a') return true;\n    if (this.data.linkOn === 'wc' && this.getThresholdLevel(value) >= 1) return true;\n    return false;\n  }\n\n\n  //\n  // Series\n  //\n  matchSerie(serie) {\n    if (this.data.pattern === null || this.data.pattern === undefined) return false;\n    return u.matchString(serie.alias, this.data.pattern);\n  }\n\n  //\n  // SHAPE MAPS\n  //\n  addShapeMap(pattern) {\n    const data = {};\n    const m = new ShapeMap(pattern, data);\n    m.import(data);\n    this.shapeMaps.push(m);\n    this.data.shapeData.push(data);\n  }\n\n  removeShapeMap(index) {\n    this.data.shapeData.splice(index, 1);\n    this.shapeMaps.splice(index, 1);\n  }\n\n  getShapeMap(index) {\n    return this.shapeMaps[index];\n  }\n\n  getShapeMaps() {\n    return this.shapeMaps;\n  }\n\n  matchShape(pattern) {\n    let found = false;\n    this.shapeMaps.forEach((element) => {\n      if (element.match(pattern)) found = true;\n    });\n    return found;\n  }\n\n  //\n  // TEXT MAPS\n  //\n  addTextMap(pattern) {\n    const data = {};\n    const m = new TextMap(pattern, data);\n    m.import(data);\n    this.textMaps.push(m);\n    this.data.textData.push(data);\n  }\n\n  removeTextMap(index) {\n    this.data.textData.splice(index, 1);\n    this.textMaps.splice(index, 1);\n  }\n\n  getTextMap(index) {\n    return this.textMaps[index];\n  }\n\n  getTextMaps() {\n    return this.textMaps;\n  }\n\n  matchText(pattern) {\n    let found = false;\n    this.textMaps.forEach((element) => {\n      if (element.match(pattern)) found = true;\n    });\n    return found;\n  }\n\n  //\n  // LINK MAPS\n  //\n  addLinkMap(pattern) {\n    u.log(1, \"Rule.addLinkMap()\");\n    const data = {};\n    const m = new LinkMap(pattern, data);\n    m.import(data);\n    this.linkMaps.push(m);\n    this.data.linkData.push(data);\n  }\n\n  removeLinkMap(index) {\n    this.data.linkData.splice(index, 1);\n    this.linkMaps.splice(index, 1);\n  }\n\n  getLinkMap(index) {\n    return this.linkMaps[index];\n  }\n\n  getLinkMaps() {\n    return this.linkMaps;\n  }\n\n  matchLink(pattern) {\n    let found = false;\n    this.linkMaps.forEach((element) => {\n      if (element.match(pattern)) found = true;\n    });\n    return found;\n  }\n\n  //\n  // STRING VALUE MAPS\n  //\n  addValueMap(value, text) {\n    const data = {};\n    const m = new ValueMap(value, text, data);\n    m.import(data);\n    this.valueMaps.push(m);\n    this.data.valueData.push(data);\n  }\n\n  removeValueMap(index) {\n    this.data.valueData.splice(index, 1);\n    this.valueMaps.splice(index, 1);\n  }\n\n  getValueMap(index) {\n    return this.valueMaps[index];\n  }\n\n  getValueMaps() {\n    return this.valueMaps;\n  }\n\n  //\n  // STRING RANGE VALUE MAPS\n  //\n  addRangeMap(from, to, text) {\n    const data = {};\n    const m = new RangeMap(from, to, text, data);\n    this.rangeMaps.push(m);\n    this.data.rangeData.push(data);\n  }\n\n  removeRangeMap(index) {\n    this.data.rangeData.splice(index, 1);\n    this.rangeMaps.splice(index, 1);\n  }\n\n  getRangeMap(index) {\n    return this.rangeMaps[index];\n  }\n\n  getRangeMaps() {\n    return this.rangeMaps;\n  }\n\n  hideRangeMap(index) {\n    this.rangeMaps[index].hide();\n  }\n\n  showRangeMap(index) {\n    this.rangeMaps[index].show();\n  }\n\n  //\n  // Format value\n  //\n  getColorForValue(value) {\n    if (!this.data.thresholds || this.data.thresholds.length === 0) {\n      return null;\n    }\n\n    for (let i = this.data.thresholds.length; i > 0; i -= 1) {\n      if (value >= this.data.thresholds[i - 1]) {\n        return this.data.colors[i];\n      }\n    }\n    return _.first(this.data.colors);\n  }\n\n  getThresholdLevel(value) {\n    let thresholdLevel = 0;\n    const thresholds = this.data.thresholds;\n\n    if (thresholds === undefined || thresholds.length === 0) return -1;\n    if (thresholds.length !== 2) return -1;\n\n    // non invert\n    if (!this.data.invert) {\n      thresholdLevel = 2;\n      if (value >= thresholds[0]) thresholdLevel = 1;\n      if (value >= thresholds[1]) thresholdLevel = 0;\n    } else {\n      thresholdLevel = 0;\n      if (value >= thresholds[0]) thresholdLevel = 1;\n      if (value >= thresholds[1]) thresholdLevel = 2;\n    }\n    return thresholdLevel;\n  }\n\n  getValueForSerie(serie) {\n    if (this.matchSerie(serie)) {\n      let value = _.get(serie.stats, this.data.aggregation);\n      if (value === undefined || value === null) {\n        value = serie.datapoints[serie.datapoints.length - 1][0];\n      }\n      return value;\n    }\n    return '-';\n  }\n\n  getFormattedValueForSerie(serie) {\n    const formattedValue = this.getValueForSerie(serie);\n    return this.getFormattedValue(formattedValue);\n  }\n\n  getLink() {\n    if (this.data.linkParams) return this.data.linkUrl + window.location.search;\n    return this.data.linkUrl;\n  }\n\n  getFormattedValue(value) {\n    // Number\n    if (this.data.type === 'number') {\n      if (!_.isFinite(value)) return 'Invalid Number';\n      if (value === null || value === void 0) {\n        return '-';\n      }\n      let decimals = this.decimalPlaces(value);\n      decimals =\n        typeof this.data.decimals === 'number' ? Math.min(this.data.decimals, decimals) : decimals;\n      return formatValue(value, this.data.unit, this.data.decimals);\n    }\n\n    if (this.data.type === 'string') {\n      if (_.isArray(value)) {\n        value = value.join(', ');\n      }\n      const mappingType = this.data.mappingType || 0;\n      if (mappingType === 1 && this.valueMaps) {\n        for (let i = 0; i < this.valueMaps.length; i += 1) {\n          const map = this.valueMaps[i];\n          if (map.match(value)) return map.getFormattedText(value);\n        }\n        return value.toString();\n      }\n\n      if (mappingType === 2 && this.rangeMaps) {\n        for (let i = 0; i < this.rangeMaps.length; i += 1) {\n          const map = this.rangeMaps[i];\n          if (map.match(value)) return map.getFormattedText(value);\n        }\n        return value.toString();\n      }\n\n      if (value === null || value === void 0) {\n        return '-';\n      }\n    }\n\n    if (this.data.type === 'date') {\n      if (value === undefined || value === null) {\n        return '-';\n      }\n\n      if (_.isArray(value)) {\n        value = value[0];\n      }\n      const date = moment(value);\n      // if (this.dashboard.isTimezoneUtc()) {\n      //     date = date.utc();\n      // }\n      return date.format(this.data.dateFormat);\n    }\n\n    return value;\n  }\n\n  getReplaceText(text, FormattedValue) {\n    if (this.data.textReplace === 'content') return FormattedValue;\n    const regexVal = u.stringToJsRegex(this.data.textPattern);\n    if (text.toString().match(regexVal)) return text.toString().replace(regexVal, FormattedValue);\n    return text;\n  }\n\n  defaultValueFormatter(value) {\n    if (value === null || value === void 0 || value === undefined) {\n      return '';\n    }\n\n    if (_.isArray(value)) {\n      value = value.join(', ');\n    }\n\n    if (this.sanitize) {\n      return this.$sanitize(value);\n    }\n    return _.escape(value);\n  }\n\n  decimalPlaces(num) {\n    let match = ('' + num).match(/(?:\\.(\\d+))?(?:[eE]([+-]?\\d+))?$/);\n    if (!match) {\n      return 0;\n    }\n    return Math.max(\n      0,\n      // Number of digits right of decimal point.\n      (match[1] ? match[1].length : 0) -\n        // Adjust for scientific notation.\n        (match[2] ? +match[2] : 0)\n    );\n  }\n\n}\n\n//\n// ShapeMap Class\n//\nclass ShapeMap {\n  constructor(pattern, data) {\n    this.data = data;\n    this.id = u.uniqueID();\n    this.data.pattern = undefined;\n    this.data.pattern = pattern;\n    this.import(data);\n  }\n\n  import(obj) {\n    this.data.pattern = obj.pattern || '';\n    this.data.hidden = obj.hidden || false;\n  }\n\n  match(text) {\n    if (text === undefined || text === null || text.length === 0) return false;\n    return u.matchString(text, this.data.pattern);\n  }\n\n  getId() {\n    return this.id;\n  }\n\n  show() {\n    this.data.hidden = false;\n  }\n\n  hide() {\n    this.data.hidden = true;\n  }\n\n  isHidden() {\n    return this.data.hidden;\n  }\n\n  export() {\n    return {\n      pattern: this.data.pattern,\n      hidden: this.data.hidden,\n    };\n  }\n\n  toColorize(value) {\n    if (this.data.hidden) return false;\n    return this.rule.toColorize(value);\n  }\n\n  toVisible() {\n    if (this.data.hidden) return false;\n    return true;\n  }\n}\n\n//\n// TextMap Class\n//\nclass TextMap {\n  constructor(pattern, data) {\n    this.data = data;\n    this.id = u.uniqueID();\n    this.data.pattern = pattern;\n    this.import(data);\n  }\n\n  import(obj) {\n    this.data.pattern = obj.pattern || this.data.pattern;\n    this.data.hidden = obj.hidden || false;\n  }\n\n  match(text) {\n    if (text === undefined || text === null || text.length === 0) return false;\n    return u.matchString(text, this.data.pattern);\n  }\n\n  getId() {\n    return this.id;\n  }\n\n  show() {\n    this.data.hidden = false;\n  }\n\n  hide() {\n    this.data.hidden = true;\n  }\n\n  isHidden() {\n    return this.data.hidden;\n  }\n\n  export() {\n    return {\n      pattern: this.data.pattern,\n      hidden: this.data.hidden,\n    };\n  }\n}\n\n//\n// LinkMap Class\n//\nclass LinkMap {\n  constructor(pattern, data) {\n    this.data = data;\n    this.id = u.uniqueID();\n    this.data.pattern = pattern;\n    this.import(data);\n  }\n\n  import(obj) {\n    this.data.pattern = obj.pattern || this.data.pattern || '';\n    this.data.hidden = obj.hidden || false;\n  }\n\n  match(text) {\n    if (text === undefined || text === null || text.length === 0) return false;\n    return u.matchString(text, this.data.pattern);\n  }\n\n  getId() {\n    return this.id;\n  }\n\n  show() {\n    this.data.hidden = false;\n  }\n\n  hide() {\n    this.data.hidden = true;\n  }\n\n  isHidden() {\n    return this.data.hidden;\n  }\n\n  export() {\n    return {\n      pattern: this.data.pattern,\n      hidden: this.data.hidden,\n    };\n  }\n}\n\n//\n// RangeMap Class\n//\nclass RangeMap {\n  constructor(from, to, text, data) {\n    this.data = data;\n    this.id = u.uniqueID();\n    this.data.from = from;\n    this.data.to = to;\n    this.data.text = text;\n    this.data.hidden = false;\n    this.import(data);\n  }\n\n  import(obj) {\n    this.data.from = obj.from || this.data.from || '';\n    this.data.to = obj.to || this.data.to || '';\n    this.data.text = obj.text || this.data.text || '';\n    this.data.hidden = obj.hidden || this.data.hidden || false;\n  }\n\n  match(value) {\n    if (this.data.from === 'null' && this.data.to === 'null') {\n      return true;\n    }\n    if (value === null) {\n      if (this.data.from === 'null' && this.data.to === 'null') {\n        return true;\n      }\n    }\n    if (Number(this.data.from) <= Number(value) && Number(this.data.to) >= Number(value)) {\n      return true;\n    }\n    return false;\n  }\n\n  getId() {\n    return this.id;\n  }\n\n  getFormattedText(value) {\n    if (value === null) {\n      if (this.data.from === 'null' && this.data.to === 'null') {\n        return this.data.text;\n      }\n    }\n    if (this.match(value)) {\n      return this.data.text;\n    }\n    return value;\n  }\n\n  show() {\n    this.data.hidden = false;\n  }\n\n  hide() {\n    this.data.hidden = true;\n  }\n\n  isHidden() {\n    return this.data.hidden;\n  }\n\n  export() {\n    return {\n      from: this.data.from,\n      to: this.data.to,\n      text: this.data.text,\n      hidden: this.data.hidden,\n    };\n  }\n}\n\n//\n// ValueMap Class\n//\nclass ValueMap {\n  constructor(value, text, data) {\n    this.data = data;\n    this.id = u.uniqueID();\n    this.data.value = value;\n    this.data.text = text;\n    this.data.hidden = false;\n    this.import(data);\n  }\n\n  import(obj) {\n    this.data.value = obj.value || this.data.value || '';\n    this.data.text = obj.text || this.data.text || '';\n    this.data.hidden = obj.hidden || this.data.hidden || false;\n  }\n\n  match(value) {\n    if (value === null || value === undefined) {\n      if (this.data.value === 'null') {\n        return true;\n      }\n      return false;\n    }\n\n    if (!_.isString(value) && Number(this.data.value) === Number(value)) {\n      return true;\n    }\n\n    return u.matchString(value.toString(), this.data.value);\n  }\n\n  getId() {\n    return this.id;\n  }\n\n  getFormattedText(value) {\n    if (value === null) {\n      if (this.data.value === 'null') {\n        return this.data.text;\n      }\n    }\n    if (this.match(value)) {\n      return this.data.text;\n    }\n    return value;\n  }\n\n  show() {\n    this.data.hidden = false;\n  }\n\n  hide() {\n    this.data.hidden = true;\n  }\n\n  isHidden() {\n    return this.data.hidden;\n  }\n\n  export() {\n    return {\n      value: this.data.value,\n      text: this.data.text,\n      hidden: this.data.hidden,\n    };\n  }\n}\n\nfunction formatValue(value, unit, decimals) {\n  return kbn.valueFormats[unit](value, decimals, null).toString();\n}\n"],"file":"rule_class.js"}